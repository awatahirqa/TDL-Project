!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=141)}([function(e,t,r){"use strict";r.r(t);var n,i,o=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker"}(i||(i={}));var a,l=function(){function e(){}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,r,n){return"tag_"+e.tagIntToString(t)+" ["+i[r]+"] "+n},e.prototype.sendTraceTag=function(t,r,i,o){var a=this.logMessage;switch(i){case n.Error:a=this.logError;break;case n.Warning:a=this.logWarning;break;case n.Info:a=this.logInfo;break;case n.Verbose:a=this.logVerbose;break;case n.Spam:default:a=this.logMessage}try{a(e.getLogMessage(t,r,o))}catch(e){var l="undefined"!=typeof navigator?navigator:void 0;if(l&&!/rv:11.0/i.test(l.userAgent))throw e}},e.prototype.shipAssertTag=function(t,r,n,i){console.assert(n,e.getLogMessage(t,r,i))},e.prototype.debugAssertTag=function(e,t,r,n){this.shipAssertTag(e,t,r,n)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}(),s=function(){function e(){this.externalLogger=new o}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,r,n){this.externalLogger.sendTraceTag(e,t,r,n)},e.prototype.debugAssertTag=function(e,t,r,n){this.externalLogger.debugAssertTag(e,t,r,n)},e.prototype.shipAssertTag=function(e,t,r,n){this.externalLogger.shipAssertTag(e,t,r,n)},e}(),u=new s;function d(e){if(!e)throw new Error("The 'logger' argument is missing");u.setLogger(e)}function c(e,t,r){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}}function g(e,t,r,n){var i=e.map((function(e){return function(e,t){var r={};r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category;var n=1e3*e.type+e.level;return r.D=n,r}(e,n)})),o=function(e,t,r,n){var i={};return i.T=e,i.L=t,i.S=r,i.I=n,i.V=1,i}(n,i,t,r);return JSON.stringify(o)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(a||(a={}));var f=function(){function e(t,r){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,r){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,c(g(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,r),n.logCache=[],n.timestampBase=Date.now());t&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=r+"?usid="+t,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===n.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}();function p(e,t){var r=new f(e,t);return{sendTraceTag:function(e,t,n,i){return m(r,e,t,n,i)},shipAssertTag:function(e,t,i,o){i&&m(r,e,t,n.Error,o)},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose}}var h=n.Info;function m(e,t,r,n,i){if(!(n>h)){var o={timestamp:Date.now(),category:r,tag:t,level:n,type:a.Trace,message:i};e.handleTrace(o)}}var C=r(4),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(C.__extends)(t,e),t}(o);r.d(t,"UlsLoggerWrapper",(function(){return s})),r.d(t,"ULS",(function(){return u})),r.d(t,"initializeLogger",(function(){return d})),r.d(t,"getUlsLogger",(function(){return p})),r.d(t,"formatForUpload",(function(){return g})),r.d(t,"uploadLogs",(function(){return c})),r.d(t,"LogCategory",(function(){return i})),r.d(t,"LogType",(function(){return a})),r.d(t,"TraceLevel",(function(){return n})),r.d(t,"UnitTestLogger",(function(){return v})),r.d(t,"ConsoleLogger",(function(){return l}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(17),o=r(5),a=r(6),l=r(12),s=r(52),u=r(83),d=r(26),c=r(10),g=r(25);function f(e,t,r){if(null==e)throw Error(r+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function p(e,t){return e-t}function h(e,t,r,n,i){for(var o=t,a=t+r-1;o<=a;){var l=o+(a-o>>1),s=i(e instanceof Array?e[l]:e.item(l),n);if(0===s)return l;s<0?o=l+1:a=l-1}return~o}function m(e,t){return e.Row===t.Row&&e.Col===t.Col?0:e.Row>t.Row||e.Row===t.Row&&e.Col>t.Col?1:-1}function C(e,t,r){var o,a=v(e.Bold||!1,e.Italic||!1),l=null!==(o=null!=t?t:e.Size)&&void 0!==o?o:i.DefaultFontSizePt;D(e)&&(l=u.getVerticalAlignmentFontSizeAdjusted(l));var s=d.canonizeFontName(e.FontName);return n.isRenderFlagEnabled(n.RenderFlags.FontFallback,r)&&r.ClientOnlyCache.FallbackFonts&&r.ClientOnlyCache.FallbackFonts[y(s,l)]&&(s=g.DefaultFallbackFontName),a+" "+l+'pt "'+s+'"'}function v(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function y(e,t){return t+"pt "+d.canonizeFontName(e)}function T(e){return e.ClientOnlyCache||S(e),e.ClientOnlyCache}function S(e){e.ClientOnlyCache={},n.isRenderFlagEnabled(n.RenderFlagsArray.CanvasHitTest,e,!0)&&(e.ClientOnlyCache.CellHitRegions={},e.ClientOnlyCache.CellCursorHitRegions={}),n.isRenderFlagEnabled(n.RenderFlags.FontFallback,e)&&(e.ClientOnlyCache.FallbackFonts={})}function F(e){f(e,"model","initCellLookup"),f(e.Cells,"model.Cells","initCellLookup");for(var t={},r=0;r<e.Cells.length;r++){var i=e.Cells[r];if(i)if(t[n.cellLookupKey(i.Row,i.Col)]=i,i.Merge)for(var o=0;o<=i.Merge.Rows;o++)for(var a=0;a<=i.Merge.Columns;a++)t[n.cellLookupKey(i.Row+o,i.Col+a)]=i;else t[n.cellLookupKey(i.Row,i.Col)]=i}return t}function w(e,t,r){f(r,"model","initCellLookup");var i=T(r);return i.CellLookup||(i.CellLookup=F(r)),i.CellLookup[n.cellLookupKey(e,t)]}function x(e,t){return f(e,"cell","getCellStyle"),f(t.Styles,"Styles","getCellStyle"),e.CachedStyle||(e.CachedStyle=n.getReferencedObjectById(e.StyleID,t.Styles)),e.CachedStyle}function b(e){return!e.DisplayFormula&&e.CachedStyle.ShrinkToFit&&!e.WrapText}function I(e){if(b(e))return e.ShrunkSize}function R(e,t,r){var n,i,o=b(e),a=o?e.ShrunkSize:t.Size;return D(t)&&!r&&(a=u.getVerticalAlignmentFontSizeAdjusted(a)),a<0&&l.setRenderingResultWarning("\n      actual font size < 0.\n      doesCellHaveShrinkToFit: "+o+",\n      cell.ShrunkSize: "+e.ShrunkSize+",\n      Font:\n        size: "+t.Size+";\n        fontName: "+d.getFontNameForLogging(t.FontName)+";\n        refCount: "+t.RefCount+";\n      cell.CachedStyle:\n        isHidden: "+(null===(n=e.CachedStyle)||void 0===n?void 0:n.IsHidden)+";\n        shrinkToFit: "+(null===(i=e.CachedStyle)||void 0===i?void 0:i.ShrinkToFit)+";\n      cell.Ifmt: "+e.Ifmt+";\n      cell.WrapText: "+e.WrapText+";\n    "),a}function O(e){return!a.isNullOrUndefined(e)}function A(e,t,r){var n;if(t.TextRuns&&r.Fonts){return{Text:e,TextRuns:null!==(n=t.CachedDisplayTextRuns)&&void 0!==n?n:t.TextRuns,Fonts:r.Fonts}}}function P(e,t){if(e.DisplayFormula)return e.FormulaInfo.Formula;if(c.isVerticalTextPresent(t,e)&&e.Text&&e.OriginalText&&(r=e.Text,/^(#)+$/.test(r)))return e.OriginalText;var r;if(!B(e))return e.Text;if(a.isNullOrUndefined(e.CachedDisplayText))if(!a.isNullOrUndefined(e.Text)&&a.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0){var n=A(e.Text,e,t);!a.isNullOrUndefined(n)&&n.Text.indexOf(o.HardBreak)>=0&&(e.CachedDisplayTextRuns=function(e){var t=e.TextRuns,r=[],n=e.Text;M(t,n);for(var i=0,a=0;a<t.length;a++){var l=t[a];f(l.EndIndex,"EndIndex","getAdjustedTextRuns"),f(l.StartIndex,"StartIndex ","getAdjustedTextRuns");var s=l.StartIndex,u=l.EndIndex;i!==s&&(u+=i-s,s=i);for(var d=l.StartIndex;d<l.EndIndex;d++)n.charAt(d)!==o.HardBreak||e.WrapText||u--;r.push({StartIndex:s,EndIndex:u,FontID:l.FontID,CachedFont:l.CachedFont}),i=u}return r}(e)),e.CachedDisplayText=L(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function L(e){return-1!==e.indexOf(o.HardBreakCRLF)||-1!==e.indexOf(o.HardBreak)?e.replace(/\r\n|\n/g,""):e}function M(e,t){var r;if(void 0===(null===(r=e[0])||void 0===r?void 0:r.EndIndex))for(var n=0;n<e.length;n++){var i=e[n],o=n<e.length-1?e[n+1].StartIndex:t.length;i.EndIndex=o}}function k(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t}function D(e){return!a.isNullOrUndefined(e.VerticalAlign)&&e.VerticalAlign!==n.FontVerticalAlignment.None}function N(e,t,r,n){return!(t<r||n<e)}function B(e){var t,r=e.ValueType===n.CellValueType.Number,i=!a.isNullOrUndefined(e.Text)&&a.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0&&e.Text!==e.CachedDisplayText,l=(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===n.HorizontalAlignment.Fill;return r||i||l}t.verifyArgumentNotNull=f,t.numbersComparer=p,t.binarySearch=h,t.cellsPositionComparer=m,t.getFontCssStringFromCell=function(e,t){return C(e.CachedFont,I(e),t)},t.getFontCssStringFromFont=C,t.getCellFontWeightStyle=v,t.getFontLookupKey=y,t.throwError=function(e,t){throw Error(t+": "+e)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,r){f(r,"model","isCellAdjacentToMergedCell");for(var n=function(e,t,r){return[w(e-1,t,r),w(e+1,t,r),w(e,t-1,r),w(e,t+1,r)]}(e,t,r),i=0;i<n.length;i++)if(n[i]&&n[i].Merge)return!0;return!1},t.getModelClientCache=T,t.initModelClientCache=S,t.initCellLookup=F,t.getCell=w,t.getColumnWidth=function(e,t){if(f(t,"model","getColumnWidth"),f(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: "+e+", columnWidths.length: "+t.ColumnWidths.length);return t.ColumnWidths[e]},t.getCellStyle=x,t.getCellFont=function(e,t){if(f(e,"cell","getCellFont"),f(t.Styles,"Styles","getCellFont"),f(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var r=x(e,t);e.CachedFont=n.getReferencedObjectById(r.FontID,t.Fonts)}return e.CachedFont},t.getCellPositionInArray=function(e,t){var r=h(t,0,t.length,e,m);return r<0&&(r=~r),r},t.cellHasShrinkToFit=b,t.getShrunkFontSize=I,t.getTextRunText=function(e,t,r){var n=t[e].StartIndex,i=r.length;return e<t.length-1&&(i=t[e+1].StartIndex),r.substring(n,i)},t.getActualFontSize=function(e){return R(e,e.CachedFont,!0)},t.getActualFontSizeFromFont=R,t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t){return a.isNullOrUndefined(e)?O(t)?t:o.DefaultBackgroundColor:k(e.BackgroundColor)},t.hasWorkbookBackgroundColor=O,t.isHighContrastMode=function(e){return!a.isNullOrUndefined(e.highContrastScheme)},t.getFormattedText=A,t.getDisplayText=P,t.updateCellText=function(e,t,r){t.Text=r,B(t)&&(t.CachedDisplayText=P(t,e)),n.isAccAndCustomNumFmtApplicable(t)?s.updateNumFmtFromCell(t):t.NumFmt=void 0},t.shouldRenderFormulaOnCell=function(e,t){var r;return!(!t||!(null===(r=e.FormulaInfo)||void 0===r?void 0:r.Formula))&&(e.FormulaInfo.FormulaType===n.CellFormulaType.Formula||e.FormulaInfo.FormulaType===n.CellFormulaType.ArrayFormula&&e.FormulaInfo.IsArrayRoot)},t.removeHardBreaks=L,t.prepareTextRunRanges=M,t.isDefined=function(e){return void 0!==e},t.getModelRowIndex=function(e,t){return f(e,"model","getRowIndex"),f(e.RowNumbers,"RowNumbers","getRowIndex"),h(e.RowNumbers,0,e.RowNumbers.length,t,p)},t.rgbToColorHex=k,t.isFontContainsVerticalAlignment=D,t.intersects1D=N,t.doRangesIntersect=function(e,t){var r=N(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),n=N(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return r&&n},t.isPointInRect=function(e,t){return N(t.x,t.x,e.x,e.x+e.width)&&N(t.y,t.y,e.y,e.y+e.height)},t.extendRenderingContext=function(e,t){var r=e;return r.scaleFactor=e.devicePixelRatio,n.isRenderFlagEnabled(n.RenderFlagsArray.ScaleFactorRefactor,t,!0)&&r.zoom&&(r.scaleFactor*=r.zoom),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(4).__exportStar(r(28),t);var n=r(23);t.cellLookupKey=n.cellLookupKey,t.getReferencedObjectToCache=n.getReferencedObjectToCache,t.isRenderFlagEnabled=n.isRenderFlagEnabled,t.doesNumFmtOverrideText=n.doesNumFmtOverrideText,t.isAccAndCustomNumFmtApplicable=n.isAccAndCustomNumFmtApplicable,t.verifyArgumentNotNull=n.verifyArgumentNotNull,t.getDefaultCell=n.getDefaultCell;var i=r(77);t.CalcBlockModel=i.CalcBlockModel;var o=r(78);t.cleanModelBeforeSerialization=o.cleanModelBeforeSerialization,t.restoreModelAfterSerialization=o.restoreModelAfterSerialization,t.cleanModelJsonReplacer=o.cleanModelJsonReplacer;var a=r(51);t.serializeCell=a.serializeCell;var l=r(80);t.RenderFeaturesZIndex=l.RenderFeaturesZIndex,t.HitTestEvents=l.HitTestEvents;var s=r(51);t.annonymize=s.annonymize;var u=r(81);t.areArraysEqual=u.areArraysEqual,t.areCellsEqual=u.areCellsEqual,t.areGridBlockModelsEqual=u.areGridBlockModelsEqual,t.areFormattedTextsEqual=u.areFormattedTextsEqual;var d=r(50);t.getReferencedObjectById=d.getReferencedObjectById;var c=r(82);t.getRangeTopLeftCell=c.getRangeTopLeftCell,t.isCellContainedInRange=c.isCellContainedInRange,t.getRangeLog=c.getRangeLog,t.getCellLog=c.getCellLog},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(25),a=r(1),l={},s={},u={};function d(e){return e-n.GridLineWidthPx}function c(e,t,r,n,i){e.beginPath(),e.rect(t,r,n,i),e.stroke(),e.clip()}t.getDefaultBorderLineWidth=function(e){return i.isNullOrUndefined(l[e])?(l[e]=Math.max(Math.round(e),1),l[e]):l[e]},t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=function(e,t){return Math.round(e*t)},t.isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.getTextDrawingMaxWidth=function(e,t,r,i){var a=0;return r&&(a=r+o.IconTextMinimalPadding),Math.max(0,e-n.GridLineWidthPx-t-a-i)},t.getTextDrawingMaxHeight=function(e,t){return Math.max(0,e-n.GridLineWidthPx-t)},t.getContainerClipMaskWidth=d,t.drawClipRect=c,t.applyClipping=function(e,t){t&&(e.save(),e.strokeStyle="transparent",c(e,t.x,t.y,t.width,t.height))},t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,r,n,i){e.moveTo(t,r),e.lineTo(n,i)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,r=parseInt(t,16);return{Red:r>>16&255,Green:r>>8&255,Blue:255&r}},t.cellIntersectsRenderingRegion=function(e,t){var r=e.Row,n=e.Row,i=e.Col,o=e.Col;e.Merge?(n+=e.Merge.Rows,o+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(i=0),e.Merge.OriginDeltaY&&(r=0))):e.Spill&&(i-=e.Spill.SpanToStart,o+=e.Spill.SpanToEnd);var l=a.intersects1D(i,o,t.startColumn,t.endColumn),s=a.intersects1D(r,n,t.startRow,t.endRow);return l&&s},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetsAdjustedForDrawing=function(e,t){var r=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,n=r[r.length-1];return t.IsRtl?n-r[e+1]:r[e]},t.isRtlChar=function(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647},t.getHighContrastTextColor=function(e,t){return i.isNullOrUndefined(e.Hyperlink)?function(e){u[e]||(u[e]=a.rgbToColorHex(e));return u[e]}(t.TextColor):function(e){s[e]||(s[e]=a.rgbToColorHex(e));return s[e]}(t.LinkColor)},t.isCellShrunk=function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size},t.getReOrderDiv=function(e,t){var r=document.createElement("div");return r.style.visibility="hidden",r.style.direction=e.BaseDir,r.style.position="absolute",r.style.width=Math.max(2e3,1.1*t)+"px",r},t.getClipMaskWidth=function(e,t,r){return d(e)-t-r}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return o})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return l})),r.d(t,"__param",(function(){return s})),r.d(t,"__metadata",(function(){return u})),r.d(t,"__awaiter",(function(){return d})),r.d(t,"__generator",(function(){return c})),r.d(t,"__createBinding",(function(){return g})),r.d(t,"__exportStar",(function(){return f})),r.d(t,"__values",(function(){return p})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return C})),r.d(t,"__await",(function(){return v})),r.d(t,"__asyncGenerator",(function(){return y})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return S})),r.d(t,"__makeTemplateObject",(function(){return F})),r.d(t,"__importStar",(function(){return w})),r.d(t,"__importDefault",(function(){return x})),r.d(t,"__classPrivateFieldGet",(function(){return b})),r.d(t,"__classPrivateFieldSet",(function(){return I}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function l(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function s(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function l(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function g(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function f(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,i++)n[i]=o[a];return n}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function y(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||l(e,t)}))})}function l(e,t){try{(r=i[e](t)).value instanceof v?Promise.resolve(r.value.v).then(s,u):d(o[0][2],r)}catch(e){d(o[0][3],e)}var r}function s(e){l("next",e)}function u(e){l("throw",e)}function d(e,t){e(t),o.shift(),o.length&&l(o[0][0],o[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:v(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function F(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function I(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.DefaultGridlineColor="#d4d4d4",t.PageLayoutLineColor="#9e9e9e",t.MinimalScaleFactorForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.HighContrastPageLayoutWidthPx=2,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},t.RightHorizontalAlignmentItalicExtraPadding=3,t.Whitespace=" ",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.FontHeightToBaselineGapRatio=.22;var i={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Top,Color:i,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Bottom,Color:i,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Left,Color:i,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Right,Color:i,Weight:2}],ID:n.UniqueStyleID.FormulaError,RefCount:0},t.MinUnicodeThaiRange=3584,t.MaxUnicodeThaiRange=3711},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=function(e){return null==e}},function(e,t,r){"use strict";function n(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function i(){var e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function o(){var e=window.performance;return e&&e.now?e.now():(new Date).getDate()-i()}function a(){var e=window.performance;return e&&e.now?i()+e.now():(new Date).getDate()}r(0);r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(2),o=r(5),a=r(17),l=r(6),s=r(1),u=r(38),d=r(57),c=r(58),g=r(20),f=r(11),p=r(15),h=r(9),m=r(59),C=r(3),v=r(10),y=r(33),T=r(21),S=r(12),F=!0,w={},x={},b={};function I(e,t,r,n){if(!t)return 0;if(r&&F){try{var i=n?t.replace(/^\s+|\s+$/g,""):t.replace(/ +$/,""),o=e.measureText(i);if(!l.isNullOrUndefined(o.actualBoundingBoxLeft)&&!l.isNullOrUndefined(o.actualBoundingBoxRight)){var a=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),s=t.length-i.length,u=0;if(s>0)u=s*e.measureText(" ").width;return a+u}}catch(e){}F=!1}return Y(e,t)}function R(e,t){var r=J(e,t),n=!i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||f.isIconAlignedToTheLeft(e,t)?r:0,a=i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,e,!0)?f.getExpandCollapseButtonPadding(e,t):0,l=f.shouldExpandCollapseButtonShiftText(e,t)?a:0,s=e.IsRtl?o.GridLineWidthPx:0;return h.getCellLeft(e,t,e.BlockWidth)+n+l+(h.getCellWidth(e,t,!1)-r-a)/2-s}function O(e,t){if(t.Spill){var r=J(e,t),n=i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,e,!0)?f.getExpandCollapseButtonPadding(e,t):0,a=e.IsRtl?o.GridLineWidthPx:0,l=h.getSpillCellWidth(t,e)-r-n,s=h.getSpillCellStartOffset(t,e,r,n);return(s+=i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)?0:r)+l/2-a}return R(e,t)}function A(e){return e*o.InCellIndentPaddingPx}function P(e,t){return X(t,e,function(e,t){if(!i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||function(e,t){var r;if(T.isCFIconAlignedToTheLeft(e,t)||(null===(r=t.LinkedEntity)||void 0===r?void 0:r.IconWidth)){var n=f.isIconAlignedToTheLeft(e,t),o=p.getEffectiveHorizontalAlignment(e,t);switch(o){case i.HorizontalAlignment.Right:return!n;case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return n;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error("unexpected context alignment "+o)}}return!1}(e,t))return J(e,t);return 0}(t,e),f.shouldExpandCollapseButtonShiftText(t,e)?f.getExpandCollapseButtonPadding(t,e):0)}function L(e,t,r,n,o,a,l,s){var u=q(e,t,o),g=p.getEffectiveHorizontalAlignment(e,t),f=c.CalibriRegularPadding;switch(g){case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return u+d.approximateValue(r,f)+l+s;case i.HorizontalAlignment.Right:n&&(f=c.CalibriItalicPadding);var h=i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)?l:0;return u+d.approximateValue(r,f)+h+s;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return a?d.approximateValue(r,f):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+g)}}function M(e,t,r){return u.getCachedFontMetrics(r,t,e).height}function k(e,t,r){var n=M(e,t,r);return Math.ceil(n*a.LineHeightUsingDivFontFactor)}function D(e,t,r,n){switch(e){case i.FontVerticalAlignment.Subscript:var o=N(n);return r+t.baseline/2-o;case i.FontVerticalAlignment.Superscript:return r-2*(t.middle-t.baseline);default:return r}}function N(e){return e?a.SubscriptVerticalPaddingForUnderlinePx:0}function B(e,t,r,n){return W(e-(t+o.GridLineWidthPx-r)/2,n)}function E(e,t,r){return W(e+t,r)}function W(e,t){return e-a.LineHeightBottomConstantPx-t}function H(e,t,r){r.CachedDrawingLayout||(r.CachedDrawingLayout={CellTextLayout:{}}),r.CachedDisplayText||s.updateCellText(t,r,r.Text);var n=!r.DisplayFormula&&r.TextRuns;if(r.CachedDrawingLayout.CellTextLayout.Width){if(n&&!r.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:r.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:r.CachedDrawingLayout.TextRunDrawingInformation}}var o=i.isRenderFlagEnabled(i.RenderFlags.AdvancedTextMetrics,t),a=s.getDisplayText(r,t);if(n){var l=j(r),u=_(e,r.TextRuns,r.Text,t,l);return{width:u.totalSize,textRunsDrawingInformation:u.textRunsDrawingInformation}}return{width:I(e,a,o,i.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t))}}function _(e,t,r,n,i){var o=e.textAlign;e.textAlign="left";var a=z(e,n,r,!1,i,t);return e.textAlign=o,a}function z(e,t,r,o,a,l){for(var u=[],d=function(e,t,r){if(void 0!==e&&e.HasBidi)return g.prepareTextRunsForBidiLayout(t,r);return t}(a,l,r),c=0,f=0;f<d.length;f++){var p=d[f],h={FontID:p.FontID,StartIndex:p.StartIndex},m=s.getTextRunText(f,d,r),C=p.CachedFont,v=s.getFontCssStringFromFont(C,void 0,t);if(o){var y=k(t,C.Size,C.FontName),T=U(y,m);h.HeightPx=T,h.WidthPx=y,c+=T}else{e.font=v;var S=I(e,m,f===d.length-1,i.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t));h.Underline=C.Underline,h.WidthPx=S,c+=S}h.Strikethrough=C.StrikeThrough,h.Text=m,h.FontCss=v,u[f]=n.__assign(n.__assign({},h),p)}return{textRunsDrawingInformation:u,totalSize:c}}function U(e,t){return e*y.breakToGraphemes(t).length}function j(e){s.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var r=g.analyzeBidiText(e.Text,e.CachedStyle.ReadingOrder);return e.CachedDrawingLayout.BidiContext=r,r}function V(e,t){s.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),s.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),s.verifyArgumentNotNull(e.CachedFont,"CachedFont","getTextLineHeight");var r,n=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;n&&(r=G(t,e.TextRuns));var i=n?r.Size:s.getActualFontSizeFromFont(e,e.CachedFont,!0),o=n?r.FontName:e.CachedFont.FontName;l.isNullOrUndefined(o)&&S.setRenderingResultWarning("\n    isRichText: "+n+",\n    fontSize: "+i+"\n    ");var a=k(t,i,o);return e.CachedDrawingLayout.CellTextLayout.LineHeight=a,a}function G(e,t){for(var r,n=0;n<t.length;n++){var o=t[n],a=i.getReferencedObjectById(o.FontID,e.Fonts);(!r||r.Size<a.Size)&&(r=a)}if(!r)throw"getLargestFont: Largest fonts is supposed to be defined";return r}function J(e,t){var r=s.getActualFontSize(t);return f.getIconSizeAndPadding(e,t,r)}function q(e,t,r){return v.isVerticalTextPresentSlice2(e,t)?0:A(r)}function X(e,t,r,n){var i=t.CachedStyle.Indentation||0,o=s.getActualFontSize(t),a=!l.isNullOrUndefined(t.WrapText)||s.cellHasShrinkToFit(t),u=v.isVerticalTextPresent(e,t)?V(t,e)/2:0;return L(e,t,o,t.CachedFont.Italic,i,a,r,n)+u}function Y(e,t){return e.measureText(t).width}function Q(e,t,r,n){var o=x[n];if((o||(x[n]=Y(e,"#"),o=x[n]),i.isRenderFlagEnabled(i.RenderFlagsArray.FixingNumFmtHashesString,t,!0)&&r.CachedFont.Italic)&&!b[n]){var a=I(e,"#",!0,!1);b[n]=a-o}}t.measureTextWidth=I,t.calculateSubSuperOffsetY=function(e,t,r,n,i,o){var a;return o?D(t,i,n,f.isBottomPaddingNeededForSubscriptUnderline(r,null===(a=e.CachedStyle)||void 0===a?void 0:a.VerticalAlignment)):0},t.getCellTextCenterX=R,t.getTextCenterForCenterAcrossSelection=O,t.getIndentationPaddingPx=A,t.getCellTextHorizontalPadding=P,t.getCellTextHorizontalPaddingWithoutVisualElements=function(e,t){return X(e,t,0,0)},t.getCellTextClipMask=function(e,t,r,n,o,a,l){var s=t,u=C.getContainerClipMaskWidth(n);return i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)&&(s+=e.IsRtl&&!l?0:a,u-=a),{x:s,y:r,width:u,height:o}},t.getWrapTextAdditionalPadding=function(e,t){var r=s.getActualFontSize(t),n=!l.isNullOrUndefined(t.WrapText)||s.cellHasShrinkToFit(t);return L(e,t,r,t.CachedFont.Italic,0,n,0,0)},t.getHorizontalPadding=L,t.getFontLineHeight=k,t.getTextVerticalPosition=function(e,t,r,n,a,l){var d,c=e.TextRuns,g=c?G(t,e.TextRuns):e.CachedFont,p=c?g.Size:s.getActualFontSize(e),v=h.getCellTop(t,e),y=h.getCellBottom(t,e),T=function(e,t){return m.cellHasBottomDoubleBorder(t,e)||C.isCellShrunk(t)}(t,e)?o.InCellVerticalPaddingPx:0;if(s.isFontContainsVerticalAlignment(g))if(l)d=l;else{var S=u.getCachedFontMetrics(g.FontName,p,t),F=f.isBottomPaddingNeededForSubscriptUnderline(g,a);d=function(e,t,r){switch(t){case i.FontVerticalAlignment.Subscript:return e.baseline/2+N(r);case i.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(S,c?i.FontVerticalAlignment.None:g.VerticalAlign,F)}else d=l||u.getCachedFontMetrics(g.FontName,p,t).baseline;switch(a){case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return T+W(y,d);case i.VerticalAlignment.Top:return E(v,r,d);case i.VerticalAlignment.Center:return B(y,n,r,d);default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+a)}},t.getTextOffsetYAlphabeticBaseline=function(e,t,r,n,o,a){var l=k(e,n,o),s=u.getCachedFontMetrics(o,n,e).baseline;switch(a){case i.VerticalAlignment.Center:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return B(t,r,l,s);case i.VerticalAlignment.Bottom:return W(t,s);case i.VerticalAlignment.Top:return E(t-r,l,s)}},t.getTextAlphabeticBaseline=function(e,t){var r=t.CachedFont,n=t.TextRuns;n&&(r=G(e,t.TextRuns));var i=n?r.Size:s.getActualFontSize(t);return u.getCachedFontMetrics(r.FontName,i,e).baseline},t.getLastRowYTopAlignmentBottomBaseline=function(e,t,r,n){return e+r-Math.round(t*a.LineLeading)+n},t.getLastRowYBottomAlignmentBottomBaseline=function(e,t,r){var n=Math.round(t*a.LineLeading*1.5)-o.InCellBottomAndCenterVerticalPaddingPx-r;return e-Math.max(n,1)},t.getMiddleBaseline=function(e,t,r,n){var i=u.getCachedFontMetrics(r.FontName,n,e);return t-(i.middle-i.baseline)},t.getYPositionForFontVerticalAlignmentRtf=D,t.getTextDecorationLineWidth=function(e){return d.approximateValue(e,c.CalibriTextDecorationLineWidth)},t.getTextHeight=function(e,t,r,n){if(s.verifyArgumentNotNull(t.CachedDrawingLayout,"CachedDrawingLayout","getOrMeasureCellPaddingPx"),s.verifyArgumentNotNull(t.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getOrMeasureCellPaddingPx"),void 0!==t.CachedDrawingLayout.CellTextLayout.Height)return t.CachedDrawingLayout.CellTextLayout.Height;var i=M(e,r,n);return t.CachedDrawingLayout.CellTextLayout.Height=i,i},t.getTextHorizontalPosition=function(e,t){var r=p.getEffectiveHorizontalAlignment(e,t),n=P(t,e);switch(r){case i.HorizontalAlignment.Right:return h.getCellRight(e,t,e.BlockWidth)-n;case i.HorizontalAlignment.Center:return R(e,t);case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return h.getCellLeft(e,t,e.BlockWidth)+n;case i.HorizontalAlignment.CenterAcrossSelection:return O(e,t);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+r)}},t.getTextWidth=function(e,t,r){var n=H(e,t,r),i=n.width,o=n.textRunsDrawingInformation;return r.CachedDrawingLayout.CellTextLayout.Width=i,r.CachedDrawingLayout.TextRunDrawingInformation=o,i},t.getTextWidthNoCaching=function(e,t,r){return H(e,t,r).width},t.cacheLegacyTextWidthOnCell=function(e,t,r){var n=I(e,r.CachedDisplayText,!1,i.isRenderFlagEnabled(i.RenderFlags.MeasureTextWidthUseNewRegex,t));r.CachedDrawingLayout.CellTextLayout.Width=n},t.measureTextRunsWidth=_,t.measureTextRunsHeightForVerticalText=function(e,t,r,n,i,o,a){return i?{textRunsDrawingInformation:[],totalSize:o*r.length}:z(e,n,r,!0,a,t)},t.measureTextHeightForVerticalText=U,t.getBidiContext=j,t.getTextLineHeight=V,t.getFormattedTextLineHeight=function(e,t){var r=G(e,t.TextRuns);return k(e,r.Size,r.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){var r=G(e,t.TextRuns);return u.getCachedFontMetrics(r.FontName,r.Size,e)},t.getNumFmtSeparatorWidth=function(e,t,r){var n,i;s.verifyArgumentNotNull(null===(n=r.NumFmt)||void 0===n?void 0:n.Separator,"separator","getNumFmtSeparatorWidth");var o=null===(i=r.NumFmt)||void 0===i?void 0:i.Separator,a=s.getFontCssStringFromCell(r,t)+o,u=w[a];if(l.isNullOrUndefined(u)||0===u){var d=Y(e,o);return w[a]=d,d}return w[a]},t.getNumFmtHashWidth=function(e,t,r){s.verifyArgumentNotNull(r,"cell","getNumFmtSeparatorWidth");var n=s.getFontCssStringFromCell(r,t);return Q(e,t,r,n),x[n]},t.getOverhangHashWidth=function(e,t,r){s.verifyArgumentNotNull(r,"cell","getOverhangHashWidth");var n=s.getFontCssStringFromCell(r,t);return Q(e,t,r,n),b[n]},t.getDistanceFromCellStartToIconEnd=J,t.doesExpandCollapseButtonShiftText=function(e,t){if(!i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,e,!0))return!1;var r=p.getEffectiveHorizontalAlignment(e,t);switch(r){case i.HorizontalAlignment.Left:case i.HorizontalAlignment.CenterAcrossSelection:case i.HorizontalAlignment.Center:return!e.IsRtl;case i.HorizontalAlignment.Right:return e.IsRtl;case i.HorizontalAlignment.Automatic:default:throw Error("doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+r)}},t.getCellHorizontalIndentationPaddingPx=q},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(2),o=r(3),a=r(5),l=r(6),s=r(11);function u(e,t,r){return n.verifyArgumentNotNull(t,"cell","getCellWidth"),n.verifyArgumentNotNull(e,"model","getCellWidth"),n.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&n.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),w(e,t,r,!1)}function d(e,t,r){return n.verifyArgumentNotNull(t,"cell","getCellHeight"),n.verifyArgumentNotNull(e,"model","getCellHeight"),n.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&n.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","getCellHeight"),F(e,t,r,!1)}function c(e,t){return S(e,t,!1)}function g(e,t){return n.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),w(e,t,!1,!0)}function f(e,t){return n.verifyArgumentNotNull(e,"model","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellHeightAdjustedForDrawing"),F(e,t,!1,!0)}function p(e,t,r){return n.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),x(e,t,void 0,r,!0)}function h(e,t){var r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,n=r.length-1,i=t.Col;if(!e.IsRtl)return p(e,t,!1)+g(e,t)-a.GridLineWidthPx;var o=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return r[n]+o-r[i]}function m(e,t){return S(e,t,!0)}function C(e,t){var r=t.ColumnOffsets[y(e)],n=T(e,t),i=t.ColumnOffsets[n];return t.ColumnWidths[n]+Math.abs(i-r)}function v(e,t){var r=I(t,y(e),!0),n=T(e,t),i=I(t,n,!0);return o.getColWidthFromOffsets(n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(i-r)}function y(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function T(e,t){return n.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function S(e,t,r){var n=b(e,t.Row,r);return t.Merge&&t.Merge.SpansBlocks&&(n-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,r)),n}function F(e,t,r,n){if(t.Merge){if(t.Merge.SpansBlocks&&!r)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,n);var i=b(e,t.Row,n);return function(e,t,r){var n=t.Row+t.Merge.Rows;return r?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n+1]:e.RowOffsets[n]+e.RowHeights[n]}(e,t,n)-i}return function(e,t,r){if(r)return o.getRowHeightFromOffsets(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing);return e.RowHeights[t.Row]}(e,t,n)}function w(e,t,r,i){if(t.Merge){if(t.Merge.SpansBlocks&&!r)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,i);var a=I(e,t.Col,i);return function(e,t,r){var n=t.Col+t.Merge.Columns;return r?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n+1]:e.ColumnOffsets[n]+e.ColumnWidths[n]}(e,t,i)-a}return function(e,t,r){return r?o.getColWidthFromOffsets(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):n.getColumnWidth(t.Col,e)}(e,t,i)}function x(e,t,r,n,i){var o=I(e,t.Col,i);return t.Merge&&t.Merge.SpansBlocks&&(o-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,i)),!e.IsRtl||n?o:(i?h(e,t):r-o)-w(e,t,!1,i)+a.GridLineWidthPx}function b(e,t,r){return r?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function I(e,t,r){return r?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}t.getCellWidth=u,t.getCellHeight=d,t.getCellLeft=function(e,t,r){return n.verifyArgumentNotNull(t,"cell","getCellWidth"),n.verifyArgumentNotNull(e,"model","getCellWidth"),n.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&n.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),x(e,t,r,!1,!1)},t.getCellRight=function(e,t,r){var n=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(n-=t.Merge.OriginDeltaX),e.IsRtl?r-n:n+u(e,t,!1)-a.GridLineWidthPx},t.getCellBottom=function(e,t){return c(e,t)+d(e,t,!1)},t.getCellTop=c,t.getCellCenterY=function(e,t){return c(e,t)+d(e,t,!1)/2-a.GridLineWidthPx/2},t.getCellWidthAdjustedForDrawing=g,t.getCellHeightAdjustedForDrawing=f,t.getCellLeftAdjustedForDrawing=p,t.getSpillCellLeftAdjustedForDrawing=function(e,t){return e.IsRtl?h(e,t)-v(t,e)+a.GridLineWidthPx:p(e,t,!1)},t.getCellRightAdjustedForDrawing=h,t.getSpillCellRightAdjustedForDrawing=function(e,t){return!t.Spill||e.IsRtl?h(e,t):p(e,t,!1)+v(t,e)-a.GridLineWidthPx},t.getCellBottomAdjustedForDrawing=function(e,t){return m(e,t)+f(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return m(e,t)+f(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t){return(h(e,t)+p(e,t,!1))/2},t.getCellTopAdjustedForDrawing=m,t.isCellSpansMultipleRowsOrBlocks=function(e){return!l.isNullOrUndefined(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=C,t.getSpillCellWidthAdjustedForDrawing=v,t.getSpillCellStartOffset=function(e,t,r,n){var o=s.getSpillCellVisualElementsPadding(t,e,r,n),l=t.ColumnOffsets[y(e)]+o;if(t.IsRtl){if(i.isRenderFlagEnabled(i.RenderFlagsArray.CFIconsWithCAS,t,!0)){var u=T(e,t),d=t.ColumnOffsets[u],c=t.ColumnWidths[u];return t.BlockWidth-d-c+o+a.GridLineWidthPx}return t.BlockWidth-C(e,t)-l+a.GridLineWidthPx}return l},t.getCellDimensionsAdjustedForDrawing=function(e,t,r){return{x:p(e,t,r)-a.GridLineWidthPx,y:m(e,t)-a.GridLineWidthPx,width:g(e,t)+a.GridLineWidthPx,height:f(e,t)+a.GridLineWidthPx}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);function i(e,t){var r;return n.isRenderFlagEnabled(n.RenderFlags.VerticalTextSlice1,e)&&!0===(null===(r=t.CachedStyle)||void 0===r?void 0:r.VerticalText)&&!t.DisplayFormula}function o(e,t){return i(e,t)&&n.isRenderFlagEnabled(n.RenderFlags.VerticalTextSlice2,e)}function a(e,t){var r;return o(e,t)&&n.isRenderFlagEnabled(n.RenderFlags.VerticalTextSlice3,e)&&!0===(null===(r=t.CachedStyle)||void 0===r?void 0:r.VerticalText)}t.isVerticalTextPresent=i,t.isVerticalTextPresentSlice2=o,t.isVerticalTextPresentSlice3=a,t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=function(e,t){if(a(e,t))switch(t.CachedStyle.VerticalAlignment){case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=function(e,t){var r;if(a(e,t))switch(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment){case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Distributed:return!0}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(57),i=r(58),o=r(17),a=r(2),l=r(39),s=r(5),u=r(21),d=r(6),c=r(15);function g(e,t){return Math.floor(n.approximateValue(e,i.FontSizeToIconSize)*t)}function f(e,t){return Math.floor(n.approximateValue(e,i.IconHorizontalPadding)*t)}function p(e,t){var r;return!!u.isCFIconAlignedToTheLeft(e,t)||a.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&!d.isNullOrUndefined(null===(r=t.LinkedEntity)||void 0===r?void 0:r.IconWidth)&&!e.IsRtl}function h(e,t){var r;return a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0)&&(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator)&&!C(e,t)?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0}function m(e){var t,r;return e.CachedIsTextWidthExceedsCellWidth||(null===(t=e.Text)||void 0===t?void 0:t.startsWith("#"))&&!(null===(r=e.Value)||void 0===r?void 0:r.startsWith("#"))}function C(e,t){var r,n;return a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0)&&(null===(r=t.CondFormat)||void 0===r?void 0:r.Icon)&&(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)&&m(t)}t.getIconSize=g,t.getIconHorizontalPadding=f,t.pointsToPixels=function(e){return Math.round(e*o.PointToPixelRatio)},t.isBottomPaddingNeededForSubscriptUnderline=function(e,t){return t===a.VerticalAlignment.Bottom&&(e.Underline===a.FontUnderline.Single||e.Underline===a.FontUnderline.Double)},t.adjustNumberToRange=function(e,t,r){return e<t?t:e>r?r:e},t.isIconAlignedToTheLeft=p,t.getIconSizeAndPadding=function(e,t,r){var n,i,o;return(null===(n=t.CondFormat)||void 0===n?void 0:n.Icon)?g(r,1)+f(r,1)+s.GridLineWidthPx:a.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&(null===(i=t.LinkedEntity)||void 0===i?void 0:i.IconWidth)?null===(o=t.LinkedEntity)||void 0===o?void 0:o.IconWidth:0},t.getExpandCollapseButtonPadding=h,t.getExpandCollapseButtonWidth=function(e,t){var r;return a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0)&&(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator)?l.ExpandCollapseButtonSizePx+l.PaddingBetweenExpandCollapseButtonAndTextPx:0},t.shouldExpandCollapseButtonShiftText=function(e,t){if(!a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0))return!1;var r=c.getEffectiveHorizontalAlignment(e,t);switch(r){case a.HorizontalAlignment.Left:case a.HorizontalAlignment.CenterAcrossSelection:case a.HorizontalAlignment.Center:return!e.IsRtl;case a.HorizontalAlignment.Right:return e.IsRtl;case a.HorizontalAlignment.Automatic:default:throw Error("shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+r)}},t.getSpillCellVisualElementsPadding=function(e,t,r,n){return(a.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,e)&&p(e,t)?r:0)+(a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0)&&e.IsRtl?0:n)},t.getCellRightVisualElementsPadding=function(e,t){var r;return a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,e,!0)&&e.IsRtl&&(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator)?h(e,t):0},t.cellTextReplacedWithHashes=m,t.doesCellContainsHashesCFIconsAndExpandCollapse=C},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="",i=[];t.perf=a()?window.performance:void 0;var o=void 0;function a(){if(o)return o;o=!1,window.performance&&"function"==typeof window.performance.now&&(o=!0);try{window.performance.now()}catch(e){o=!1}return o}t.verifyPerformanceNowSupported=a,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:i}},t.clearPerformanceMetrics=function(){i=[]},t.trackDuration=function(e,r,n){var o=t.perf?t.perf.now():-1;if(r(),t.perf){var a=t.perf.now()-o;n?i[e]+=a:i[e]=a}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderBlockInternalDurationMs=3]="RenderBlockInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs"}(t.RenderPerformanceMetric||(t.RenderPerformanceMetric={})),t.getRenderingMessage=function(){var e=n;return n="",e},t.setRenderingResultWarning=function(e){e&&""!==e&&(n=(n+"; "+e).substring(0,2500))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(n=t.CFIconImage||(t.CFIconImage={})),t.IconImageLookup=[[n.ColoredArrowDown,n.ColoredArrowRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowRight,n.GrayArrowUp],[n.FlagLow,n.FlagMedium,n.FlagHigh],[n.CircleLow,n.CircleMedium,n.CircleHigh],[n.TrafficLow,n.TrafficMedium,n.TrafficHigh],[n.SignLow,n.SignMedium,n.CircleHigh],[n.CircleSymbolLow,n.CircleSymbolMedium,n.CircleSymbolHigh],[n.SymbolLow,n.SymbolMedium,n.SymbolHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.FourCircleLow,n.FourCircleMedium1,n.FourCircleMedium2,n.FourCircleHigh],[n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.FourCircleLow,n.CircleLow,n.CircleMedium,n.CircleHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.SignalBarEmpty,n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.CircleEmpty,n.Circle25,n.CircleHalf,n.Circle75,n.CircleFilled],[n.StarLow,n.StarMedium,n.StarHigh],[n.TriangleLow,n.TriangleMedium,n.TriangleHigh],[n.QuadrantEmpty,n.Quadrant25,n.QuadrantHalf,n.Quadrant75,n.QuadrantFull]],t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3;var i=Math.PI/5;t.StarRotationSin=Math.sin(i),t.StarRotation2Sin=Math.sin(2*i),t.StarRotationCos=Math.cos(i),t.StarRotation2Cos=Math.cos(2*i),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.4,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkPaddingFromCircle=2,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125,t.QuarterPiTan=Math.tan(Math.PI/4),t.CircleHighContrastSmallRadiusPortion=.4,t.CircleHighContrastMediumRadiusPortion=.55,t.CircleHighContrastLargeRadiusPortion=.7,t.StripedCircleUpperLineAngle=.05*Math.PI,t.StripedCircleMiddleLineAngle=.25*Math.PI,t.StripedCircleLowerLineAngle=.45*Math.PI},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.ShapeOutlineWidthPx=1,t.ShapeLinesAdjustment=n.getLinePixelTranslation(t.ShapeOutlineWidthPx)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(6),o=r(3),a=r(10);function l(e,t){var r,l;if(t.DisplayFormula)return n.HorizontalAlignment.Left;var s=null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment;if(n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)&&(null===(l=t.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator)&&!i.isNullOrUndefined(t.Spill)&&s!==n.HorizontalAlignment.CenterAcrossSelection)return e.IsRtl?n.HorizontalAlignment.Right:n.HorizontalAlignment.Left;if(s===n.HorizontalAlignment.Fill&&n.isRenderFlagEnabled(n.RenderFlagsArray.AdvHAFillSpillCellBugFix,e,!0))return e.IsRtl?n.HorizontalAlignment.Right:n.HorizontalAlignment.Left;switch(s){case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.Distributed:case n.HorizontalAlignment.Fill:case n.HorizontalAlignment.Automatic:return a.isVerticalTextPresent(e,t)?n.HorizontalAlignment.Left:function(e,t){var r,a,l,s=null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment;if(n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)&&(null===(a=t.PivotTable)||void 0===a?void 0:a.HasExpandCollapseIndicator)&&(s===n.HorizontalAlignment.Distributed||s===n.HorizontalAlignment.Fill))return e.IsRtl?n.HorizontalAlignment.Right:n.HorizontalAlignment.Left;switch(null===(l=t.CachedStyle)||void 0===l?void 0:l.ReadingOrder){case n.ReadingOrderType.LeftToRight:return n.HorizontalAlignment.Left;case n.ReadingOrderType.RightToLeft:return n.HorizontalAlignment.Right;case n.ReadingOrderType.Context:var u=t.Text;if(!i.isNullOrUndefined(u)&&""!==u)return o.isRtlChar(u[0])?n.HorizontalAlignment.Right:n.HorizontalAlignment.Left}return n.HorizontalAlignment.Left}(e,t)}return s}t.isHorizontalAlignmentCenteredAcrossSelection=function(e){var t;return(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===n.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Distributed:return!0}return!1},t.getTextAlignment=function(e,t){if(a.isVerticalTextPresent(e,t))return"center";var r=l(e,t);switch(r){case n.HorizontalAlignment.Right:return"right";case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:return"center";case n.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: "+r)}},t.getEffectiveHorizontalAlignment=l,t.adjustXForHorizontalAlignment=function(e,t,r,i){var o=0,a=l(e,t);switch(a){case n.HorizontalAlignment.Left:o=r;break;case n.HorizontalAlignment.Right:o=r-i;break;case n.HorizontalAlignment.Center:case n.HorizontalAlignment.CenterAcrossSelection:o=r-i/2;break;default:throw Error("unexpected context alignment "+a)}return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagPoleColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.PointToPixelRatio=4/3,t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.KnownFontNamesLowerCase=["angsananew","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho"],t.SubscriptVerticalPaddingForUnderlinePx=2},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(14);t.drawRectangle=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawRectangle"),n.verifyArgumentNotNull(t,"drawingContext","drawRectangle");var r=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,u=t.width;(function(e,t,r,n,i,o){e.strokeStyle=o,e.beginPath(),e.rect(t,r,n,i),e.stroke()})(e,a+i.ShapeLinesAdjustment,l-s-i.ShapeLinesAdjustment,u,s,o),r&&function(e,t,r,n,i,o){e.fillStyle=o,e.beginPath(),e.fillRect(t,r,n,i),e.fill()}(e,a+i.ShapeOutlineWidthPx,l-s,u-i.ShapeOutlineWidthPx,s-i.ShapeOutlineWidthPx,r)},t.drawRoundRectangle=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawRoundRectangle"),n.verifyArgumentNotNull(t,"drawingContext","drawRoundRectangle");var r=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,u=t.width,d=t.radius,c=a+i.ShapeLinesAdjustment,g=l-s-i.ShapeLinesAdjustment,f=c+u,p=g+s;e.beginPath(),e.moveTo(c+d,g),e.lineTo(f-d,g),e.quadraticCurveTo(f,g,f,g+d),e.lineTo(f,p-d),e.quadraticCurveTo(f,p,f-d,p),e.lineTo(c+d,p),e.quadraticCurveTo(c,p,c,p-d),e.lineTo(c,g+d),e.quadraticCurveTo(c,g,c+d,g),e.closePath(),r&&(e.fillStyle=r,e.fill()),e.strokeStyle=o,e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=r(8),a=r(20),l=r(22),s=r(3),u=r(9),d=r(12),c=r(5),g=r(15),f=r(27),p=r(6),h=r(40),m=r(38),C=r(41),v=r(10),y=r(11),T=r(33),S=r(17);function F(e,t){return e>=t.StartIndex&&e<t.EndIndex}function w(e,t,r){for(var n=[],i=0;i<t.length;i++){var o=t[i];if(F(e,o))return i;o&&n.push({index:i,startIndex:o.StartIndex,endIndex:o.EndIndex})}var a=r.text,l=r.formattedTextLength,s=r.isCarriageReturnExists,u=T.breakToGraphemes(a);throw Error("Failed to find text run index for textOffsetIndex: "+e+", runs.length: "+t.length+", runsIndices: "+JSON.stringify(n)+", formattedTextLength: "+l+", isCarriageReturnExists:"+s+", isGraphemeExists: "+((null==a?void 0:a.length)!==u.length)+" ")}function x(e,t,r){var n=e.CachedFont;e.ShrunkSize=n.Size*t,e.FontCss=i.getFontCssStringFromFont(n,e.ShrunkSize,r),e.WidthPx=e.WidthPx*t}function b(e,t,r){var n=t.CachedFont;t.ShrunkSize=r;var a=o.getFontLineHeight(e,t.ShrunkSize,null==n?void 0:n.FontName),l=o.measureTextHeightForVerticalText(a,t.Text);t.FontCss=i.getFontCssStringFromFont(n,t.ShrunkSize,e),t.MaxGlyphHeightPx=a,t.HeightPx=l}function I(e,t){for(var r=0,i=t,o=!1,a=!1,l=t;l<e.length;l++){var s=e[l];if(s.Underline===n.FontUnderline.None)break;s.Underline===n.FontUnderline.Single?o=!0:s.Underline===n.FontUnderline.Double&&(a=!0);var u=s.CachedFont;r=Math.max(r,s.ShrunkSize||u.Size),i=l}return{maxFontSize:r,sequenceEndRunIndex:i,hasMixedUnderlineTypes:o&&a}}function R(e,t,r,n,i){return n?r:i?t:e}function O(e,t,r,i,a,l){var s,u=l,d=0;return(s=t===n.FontVerticalAlignment.Subscript||t===n.FontVerticalAlignment.Superscript)&&(d=o.calculateSubSuperOffsetY(e,t,r,i,a,s),u=!0),{subSuperOffsetY:d,hasVerticalAlignedFont:u,isFontVerticalAlignment:s}}function A(e,t,r,i,o,a,s,u,d,c,g,f,p,m){var C,v=a,y=o;if(p)!function(e,t,r,i,o,a,s,u,d,c,g){var f,p;if(!r.JustifyDistributedLine)return;var h=t+(d?0:r.JustifyDistributedLine.Start.Offset),m=h,C=!0===r.Strikethrough;P(e,o,a,r.JustifyDistributedLine.Start,t,i,d,r.MaxGlyphHeightPx,s,C,u,c,g),h=t+(d?0:r.JustifyDistributedLine.Start.Offset+r.JustifyDistributedLine.Start.Width),(null===(f=r.JustifyDistributedLine)||void 0===f?void 0:f.Middle)&&(P(e,o,a,r.JustifyDistributedLine.Middle,t,i,d,r.MaxGlyphHeightPx,s,C,u,c,g),h=t+(d?0:r.JustifyDistributedLine.Middle.Offset+r.JustifyDistributedLine.Middle.Width));(null===(p=r.JustifyDistributedLine)||void 0===p?void 0:p.End)&&(P(e,o,a,r.JustifyDistributedLine.End,t,i,d,r.MaxGlyphHeightPx,s,C,u,c,g),h=t+(d?0:r.JustifyDistributedLine.End.Offset+r.JustifyDistributedLine.End.Width));if(!d&&(r.Underline!==n.FontUnderline.None||r.Strikethrough)){var v={scaleFactor:s,clipRect:c,textPositionX:m,textPositionY:i,textWidth:h-m,partOfMixedUnderlineSequence:r.HasMixedUnderline};l.cacheTextDecorationLayout(o,a,v,u,r.UnderlineWidth)}}(e,o,s,a,t,r,i,s.CachedFont,f,c,m);else{if(L(e,t,r,s.Text,o,a,f,s.MaxGlyphHeightPx,i,!0===s.Strikethrough,s.CachedFont,c),!f&&(s.Underline!==n.FontUnderline.None||s.Strikethrough)){var T={scaleFactor:i,clipRect:c,textPositionX:o,textPositionY:a,textWidth:s.WidthPx,containSubscript:g===n.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:s.HasMixedUnderline};l.cacheTextDecorationLayout(t,r,T,s.CachedFont,s.UnderlineWidth)}f?v=function(e,t,r,i,o){var a=o+1<i.length?h.getTextRun(!0,i,o+1).HeightPx:0;switch(e){case n.VerticalAlignment.Top:return t-a;case n.VerticalAlignment.Center:return t-(r.HeightPx+a)/2;case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:return t-r.HeightPx}}(null===(C=r.CachedStyle)||void 0===C?void 0:C.VerticalAlignment,a,s,u,d):y+=s.WidthPx}return{offsetX:y,offsetY:v}}function P(e,t,r,n,i,o,a,l,s,u,d,c,g){var f=i,p=o;a?p-=n.Offset:f+=n.Offset,L(e,t,r,n.Text,f,p,a,l,s,u,d,c,g)}function L(e,t,r,n,i,o,a,l,s,u,d,c,g){a?C.fillVerticalTextForRTF(e,t,r,n,i,o,l,s,u,d,c,g):e.fillText(n,i,o)}function M(e,t){for(var r=0,n=t[0],i=0;i<e.length;i++){var o=e[i].CachedFont;r=Math.max(r,o.Size),n.Size<r&&(n=o)}return n}t.fillRichTextFormat=function(e,t,r,c,C,T,F,w,P,L){if(i.verifyArgumentNotNull(c,"cell","fillRichTextFormat"),i.verifyArgumentNotNull(r,"model","fillRichTextFormat"),i.verifyArgumentNotNull(C,"formattedText","fillRichTextFormat"),i.verifyArgumentNotNull(C.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0!==C.Text.length){var k=C.TextRuns;i.verifyArgumentNotNull(k[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");var D=function(e,t,r){if(!r)return!1;if(v.isVerticalAlignmentJustifiedOrDistributedForVerticalText(e,t))return!(r.breakType===f.BreakType.Justify&&r.isProcessingLastLine);return g.isHorizontalAlignmentJustifiedAndDistributed(t)}(r,c,L),N=function(e,t,r,i,l,c,g,f){var m=o.getBidiContext(r),C=v.isVerticalTextPresentSlice3(t,r),T=function(e,t,r,n,i){var a,l,s=t.Fonts;if(r.WrapText){var u=o.measureTextRunsWidth(e,n,i,t,o.getBidiContext(r));l=u.totalSize,a=u.textRunsDrawingInformation}else l=o.getTextWidth(e,t,r),a=r.CachedDrawingLayout.TextRunDrawingInformation;if(!a||!n)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";var d=M(a,s);return{totalTextRunWidth:l,largestFont:d,preparedRuns:a}}(e,t,r,i,l),F=0,w=T.totalTextRunWidth,R=T.largestFont,O=T.preparedRuns;!C&&m.HasRtl&&d.trackDuration(d.RenderPerformanceMetric.ReorderBidiTextRuns,(function(){a.reorderTextRunsForBidiDrawing(O,l,m,w)}),!0);C&&(F=function(e,t){for(var r=0,n=0;n<t.length;n++){var i=t[n],a=i.CachedFont,l=o.getFontLineHeight(e,null==a?void 0:a.Size,null==a?void 0:a.FontName),s=o.measureTextHeightForVerticalText(l,i.Text);i.MaxGlyphHeightPx=l,i.HeightPx=s,r+=s}return r}(t,O));r.CachedStyle.ShrinkToFit&&(C?F=function(e,t,r,n){var i=u.getCellHeight(e,t,!1);if(n<i)return n;return function(e,t,r,n){for(var i=0,o=0;o<t.length;o++){var a=(u=t[o]).CachedFont,l=Math.floor(a.Size*n);b(e,u,l),i+=u.HeightPx}for(;i<r;){i=0;for(o=0;o<t.length;o++){if((u=t[o]).ShrunkSize<S.MaxAllowedFontSize){var s=u.ShrunkSize+1;b(e,u,s)}i+=u.HeightPx}}for(;i>r;){i=0;for(o=0;o<t.length;o++){var u;if((u=t[o]).ShrunkSize>S.MinAllowedFontSize){s=u.ShrunkSize-1;b(e,u,s)}i+=u.HeightPx}}return i}(e,r,i,i/n)}(t,r,O,F):w=function(e,t,r,i){var a=u.getCellWidth(e,t,!1),l=t.CachedStyle.Indentation||0,d=r[0].CachedFont,c=o.getHorizontalPadding(e,t,d.Size,t.CachedFont.Italic,l,!0,0,0),g=s.getTextDrawingMaxWidth(a,c,o.getDistanceFromCellStartToIconEnd(e,t),n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)?y.getExpandCollapseButtonPadding(e,t):0);if(i<g)return i;for(var f=g/(i+c),p=0,h=0;h<r.length;h++){var m=r[h];x(m,f,e),p+=m.WidthPx}return p}(t,r,O,w));(function(e){var t=0;for(;t<e.length;){if(e[t].Underline===n.FontUnderline.None)t++;else for(var r=I(e,t),i=r.maxFontSize,a=r.sequenceEndRunIndex,l=r.hasMixedUnderlineTypes,s=o.getTextDecorationLineWidth(i);t<=a;t++)e[t].UnderlineWidth=s,e[t].HasMixedUnderline=l}})(O),!c||p.isNullOrUndefined(g)||p.isNullOrUndefined(f)||h.prepareTextRunsForJustifyAndDistributed(e,t,f,g,O,C);return{totalTextRunHeight:F,totalTextRunWidth:w,largestFont:R,preparedRuns:O}}(e,r,c,k,C.Text,D,P,L),B=N.totalTextRunHeight,E=N.totalTextRunWidth,W=N.largestFont,H=N.preparedRuns,_=i.getCellStyle(c,r);i.verifyArgumentNotNull(_,"cellStyle","fillRichTextFormat"),function(e,t,r,a,d,c,f,C,y,T,F,w,x){var b,I,P,L=e.textAlign,k=e.textBaseline,D=e.font,N=e.fillStyle,B=t.scaleFactor,E=v.isVerticalTextPresentSlice3(r,a),W=C;E&&(W=function(e,t,r,i,o,a,l){var s;if(!a&&(null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment)===n.VerticalAlignment.Justify){var d=M(r,e.Fonts),c=m.getCachedFontMetrics(d.FontName,d.Size,e).baseline;return u.getCellBottom(e,t)-S.LineHeightBottomConstantPx-c-(l-i)}return o}(r,a,y,T,W,F,x));W=function(e,t,r,a,l,s,u){if(t)return function(e,t,r,i){var o,a=null===(o=e.CachedStyle)||void 0===o?void 0:o.VerticalAlignment,l=i.length-1,s=i[l].HeightPx||0;switch(a){case n.VerticalAlignment.Top:return t+r-s;case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:case n.VerticalAlignment.Bottom:return t;case n.VerticalAlignment.Center:return t+(r-s)/2}}(r,a,l,s);return function(e,t,r,a){var l=r.CachedStyle.VerticalAlignment,s=o.getFontLineHeight(e,t.Size,t.FontName),u=m.getCachedFontMetrics(t.FontName,t.Size,e).baseline;i.verifyArgumentNotNull(u,"textBaselineAdjustY","adjustYForVerticalAlignment");var d=a-u;if(l===n.VerticalAlignment.Center)return d+(s-u)/2;return d}(e,u,r,a)}(r,E,a,W,T,y,c);var H=E?f:function(e,t,r,n,i,o){var a=n&&!p.isNullOrUndefined(o)?o:i;return g.adjustXForHorizontalAlignment(e,t,r,a)}(r,a,f,F,d,x),_=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=s.getHighContrastTextColor(a,t.highContrastScheme));for(var z=0;z<y.length;z++){var U=h.getTextRun(E,y,z);i.verifyArgumentNotNull(U.CachedFont,"run.CachedFont","drawTextRuns");var j=U.CachedFont,V=j.VerticalAlign,G=0,J=!1;E||a.WrapText||(b=O(a,V,j,C,m.getCachedFontMetrics(j.FontName,j.Size,r),_),G=b.subSuperOffsetY,J=b.isFontVerticalAlignment,_=b.hasVerticalAlignedFont),e.font=U.FontCss,t.highContrastScheme||(e.fillStyle=U.CachedFont.Color),I=A(e,r,a,B,H,R(C,G,W,E,J),U,y,z,w,V,E,F,x),H=I.offsetX,W=I.offsetY}_&&!p.isNullOrUndefined(null===(P=a.CachedDrawingLayout)||void 0===P?void 0:P.UnderlineRuns)&&l.alignVerticalUnderlineRuns(r,a,a.CachedDrawingLayout.UnderlineRuns);e.textAlign=L,e.textBaseline=k,e.font=D,e.fillStyle=N}(e,t,r,c,E,W,T,F,H,B,D,w,null==L?void 0:L.maxWidth)}},t.substringFormattedText=function(e,t,r){if(i.verifyArgumentNotNull(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return c.EmptyFormattedText;var n=e.Text.substring(t,r);if(0===n.length)return{Text:n,Fonts:e.Fonts,TextRuns:[]};var o=e.TextRuns;if(i.verifyArgumentNotNull(o,"formattedText.runs","substringFormattedText"),0===o.length)throw Error("Invalid param: formattedText runs.length === 0");i.prepareTextRunRanges(o,e.Text);var a=e.Text.length,l={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:a,text:e.Text},s=w(t,o,l),u=r&&r<e.Text.length?w(r-1,o,l):o.length-1,d=[],g=o[s];d.push({StartIndex:0,FontID:g.FontID,CachedFont:g.CachedFont});for(var f=s+1;f<=u;f++){var p=o[f],h=p.StartIndex-t;d.push({StartIndex:h,FontID:p.FontID,CachedFont:p.CachedFont})}return{Text:n,Fonts:e.Fonts,TextRuns:d}},t.measureFormattedTextWidth=function(e,t,r){return o.measureTextRunsWidth(e,t.TextRuns,t.Text,r).totalSize}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=r(3);function a(e,t){var r=[u(e,0)];if(1===t.length)return r;for(var n=void 0,i=0;i<t.length;i++){if(c(t[i])){l(i,n)&&r.push(d(e,i));var o=i+1;s(o,t.length)&&r.push(u(e,o)),n=i}}return r}function l(e,t){return e>0&&!(e-1===t)}function s(e,t){return e<t}function u(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function d(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}function c(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}t.analyzeBidiText=function(e,t){for(var r=!1,i=!1,a=0;a<e.length;a++){var l=e[a];if(o.isRtlChar(l)?r=!0:i=!0,i&&r)break}return{HasLtr:i,HasRtl:r,HasBidi:i&&r,BaseDir:function(e,t){if(!e)return"ltr";switch(t){case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.Context:return o.isRtlChar(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var r=[],n=0;n<e.length;n++){var o=a(e[n],i.getTextRunText(n,e,t));r.push.apply(r,o)}return r},t.reorderTextRunsForBidiDrawing=function(e,t,r,n){if(!r.HasRtl||r.HasLtr){for(var a=o.getReOrderDiv(r,n),l=0;l<e.length;l++){var s=i.getTextRunText(l,e,t),u=document.createElement("span");u.innerText=s,u.setAttribute("rid",l.toString()),a.appendChild(u)}document.body.appendChild(a);for(var d=0;d<a.children.length;d++){var c=a.children[d],g=c.getAttribute("rid");if(!g)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var f=c.getBoundingClientRect().left;e[l=parseInt(g,10)].OffsetX=f}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(a)}else e.reverse()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(15);function o(e,t,r){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=r,e.stroke()}t.fillAndStroke=o,t.drawIconFromPoints=function(e,t,r,n){e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var i=1;i<n.length;i++)e.lineTo(n[i].x,n[i].y);o(e,t,r)},t.isCFIconAlignedToTheLeft=function(e,t){var r,o=null===(r=t.CondFormat)||void 0===r?void 0:r.Icon;if(o){if(o.IconOnly){var a=i.getEffectiveHorizontalAlignment(e,t);return a===n.HorizontalAlignment.Left||a===n.HorizontalAlignment.Automatic}return!0}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(5),o=r(1),a=r(3),l=r(8),s=r(9),u=r(15),d=r(6),c=r(10);function g(e,t,r,i,a){if(o.verifyArgumentNotNull(t,"cell","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),i.Underline!==n.FontUnderline.None&&!c.isVerticalTextPresentSlice2(e,t)){var l={underline:i.Underline},s=p(e,t,r,l,i,!1,a),u=t.CachedDrawingLayout.UnderlineRuns;if(s&&u.push(s),h(l)){var d=p(e,t,r,{underline:l.underline===n.FontUnderline.DoubleAccounting?n.FontUnderline.SingleAccounting:n.FontUnderline.Single},i,!0,a);d&&u.push(d)}}if(i.StrikeThrough){var g=p(e,t,r,{strikethrough:!0},i,!1,void 0);if(g)t.CachedDrawingLayout.StrikethroughRuns.push(g)}}function f(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function p(e,t,r,a,g,f,p){var m=r.scaleFactor,y=r.clipRect,T=f||r.partOfMixedUnderlineSequence&&a.underline===n.FontUnderline.Single,S=o.getActualFontSizeFromFont(t,g,!1),F=function(e,t,r,i,a,g,f){var p,h,m,C,v=r.scaleFactor,y=r.textPositionX,T=r.textWidth;if(i.underline===n.FontUnderline.SingleAccounting||i.underline===n.FontUnderline.DoubleAccounting){var S=l.getCellTextHorizontalPadding(t,e);h=s.getCellLeft(e,t,e.BlockWidth)+S,m=s.getCellRight(e,t,e.BlockWidth)-S}else{var F=!d.isNullOrUndefined(t.TextRuns)||u.isHorizontalAlignmentJustifiedAndDistributed(t);p=function(e,t,r,i,o){var a,l,s=o?n.HorizontalAlignment.Left:u.getEffectiveHorizontalAlignment(e,t);c.isVerticalTextPresentSlice2(e,t)&&(s=n.HorizontalAlignment.Center);switch(s){case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:a=r,l=r+i;break;case n.HorizontalAlignment.Right:a=r-i,l=r;break;case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:a=r-i/2,l=r+i/2;break;default:a=r,l=r+i}return{startX:a,endX:l}}(e,t,y,T,F),h=p.startX,m=p.endX}C=i.strikethrough?function(e,t,r,n,i){var a=r.textPositionY;o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");var s=l.getTextDecorationLineWidth(i.Size);return l.getMiddleBaseline(e,a,i,n)-s/2}(e,t,r,a,g):function(e,t,r,n){var i=t.textPositionY;o.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var a=null!=n?n:l.getTextDecorationLineWidth(r);return i+2*a}(t,r,a,f);return h=Math.round(h*v),m=Math.round(m*v),C=Math.round(C*v),{startX:h,endX:m,Y:C}}(e,t,r,a,S,g,p),w=F.startX,x=F.endX,b=F.Y,I=function(e,t,r){var n=(null!=r?r:l.getTextDecorationLineWidth(t))*e;return Math.max(Math.floor(n),1)}(m,S,p),R=Math.round(i.UnderlineMarginFromTextBaseline*I);(h(a)&&(b+=R),T)&&(b=b-2*I+R);if(!function(e,t,r,n,i,o,a){return function(e,t,r,n){var i=s.getCellTopAdjustedForDrawing(e,t),o=n+r;return n<=i&&o<=i}(e,t,n,i)||C(e,t,n,i)||function(e,t,r){var n=e.scaleFactor,i=e.clipRect,o=i?(i.x+i.width)*n:0,a=!1;i&&(a=t>=o&&r>=o);return a}(r,o,a)||function(e,t,r){var n=e.scaleFactor,i=e.clipRect,o=i?i.x*n:0,a=!1;i&&(a=t<=o&&r<=o);return a}(r,o,a)}(e,t,r,I,b,w,x)||r.containSubscript&&C(e,t,I,b)){if(y){var O=v(w,x,A=Math.round(y.x*m),Math.round(y.width*m)+A);w=O.start,x=O.end}if(function(e,t,r,n){var o=n+r,a=s.getCellTopAdjustedForDrawing(e,t)+i.GridLineWidthPx,l=s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx;return n<=a||o>=l}(e,t,I,b)&&(!r.containSubscript||!C(e,t,I,b))){var A,P=v(b,b+I,A=s.getCellTopAdjustedForDrawing(e,t),s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx);b=P.start,I=P.end-b}return{StartX:w,EndX:x,Y:b,LineWidth:I,Color:g.Color}}}function h(e){return e.underline===n.FontUnderline.Double||e.underline===n.FontUnderline.DoubleAccounting}function m(e,t){return e[t].StartX===e[t+1].StartX}function C(e,t,r,n){var i=s.getCellBottomAdjustedForDrawing(e,t);return n>=i&&n+r>=i}function v(e,t,r,n){var i=Math.min(e,t),o=Math.max(e,t),a=Math.min(r,n),l=Math.max(r,n);return{start:Math.max(i,a),end:Math.min(o,l)}}function y(e,t){if(0!==t.LineWidth){var r=t.Y+o.getLinePixelTranslation(t.LineWidth);!function(e,t,r,n){e.moveTo(t,n),e.lineTo(r,n)}(e,t.StartX,t.EndX,r)}}t.measureAndCacheTextDecorationLayout=function(e,t,r,n){var i=r.CachedFont.Underline,o=r.CachedFont.StrikeThrough;(i||o)&&""!==r.CachedDisplayText&&(n.textWidth=l.getTextWidth(e,t,r),g(t,r,n,r.CachedFont))},t.cacheTextDecorationLayout=g,t.drawTextDecoration=function(e,t,r){var n,i,l,s,u;o.verifyArgumentNotNull(t.Cells,"model.cells","drawTextDecoration"),e.beginPath();for(var d=0;d<t.Cells.length;d++){var c=t.Cells[d];if(a.cellIntersectsRenderingRegion(c,r.renderingRegion)&&(o.verifyArgumentNotNull(c.CachedFont,"cell.CachedFont","drawTextDecoration"),(c.CachedFont.StrikeThrough||c.CachedFont.Underline||c.TextRuns)&&!(c.CondFormat&&(null===(n=c.CondFormat)||void 0===n?void 0:n.Icon)&&(null===(l=null===(i=c.CondFormat)||void 0===i?void 0:i.Icon)||void 0===l?void 0:l.IconOnly)))){o.verifyArgumentNotNull(c.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");for(var g=c.CachedDrawingLayout.UnderlineRuns,f=c.CachedDrawingLayout.StrikethroughRuns,p=r.highContrastScheme?a.getHighContrastTextColor(c,r.highContrastScheme):void 0,h=0,m=[g,f];h<m.length;h++){var C=m[h];if(C&&C.length>0){if(!s||!u){var v=C[0];s=S=null!=p?p:v.Color,u=v.LineWidth,e.strokeStyle=S,e.lineWidth=v.LineWidth}for(var T=0;T<C.length;T++){var S,F=C[T],w=s!==(S=null!=p?p:F.Color),x=u!==F.LineWidth;(w||x)&&(s=S,u=F.LineWidth,e.stroke(),e.strokeStyle=S,e.lineWidth=F.LineWidth,e.beginPath()),y(e,F)}}}}}e.stroke()},t.alignVerticalUnderlineRuns=function(e,t,r){if(!(d.isNullOrUndefined(r)||r.length<=0))for(var n=function(e,t,r){for(var n=-1,i=-1,o=0,a=!1,l=0;l<r.length;l++)if(!(l>0&&m(r,l-1)))if(l<r.length-1&&m(r,l)){var u=f([r[l],r[l+1]]),d=u.top,c=u.bottom;d.Y>n&&(n=d.Y),c.Y>i&&(i=c.Y,o=Math.max(c.LineWidth,1),a=!0)}else r[l].Y>n&&(n=r[l].Y,a||(o=Math.max(r[l].LineWidth,1)));C(e,t,o,i)&&(i=s.getCellBottomAdjustedForDrawing(e,t)-o,n=i-2*o);n-i<2*o&&(n=i-2*o);return{closestToBottomUnderline:n,closestToBottomDoubleUnderline:i,closestToBottomUnderlineWidth:o}}(e,t,r),i=0;i<r.length;i++)if(!(i>0&&r[i].StartX===r[i-1].StartX)){if(i<r.length-1&&r[i].StartX===r[i+1].StartX){var o=f([r[i],r[i+1]]),a=o.top,l=o.bottom;a.Y=n.closestToBottomUnderline,l.Y=n.closestToBottomDoubleUnderline,r[i+1].LineWidth=n.closestToBottomUnderlineWidth}else r[i].Y=n.closestToBottomUnderline;r[i].LineWidth=n.closestToBottomUnderlineWidth}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(50),i=r(28),o=r(24),a=r(76);function l(e){return!!s(e)&&(e.Ifmt>=a.NumFmtAccountingStartIndex&&!o.isNullOrUndefined(e.NumFmt)&&""!==e.Text)}function s(e){return e.ValueType===i.CellValueType.Number}t.cellLookupKey=function(e,t){return t+"_"+e},t.getReferencedObjectToCache=function(e,t){if(!o.isNullOrUndefined(e)&&!o.isNullOrUndefined(t))return n.getReferencedObjectById(e,t)},t.isRenderFlagEnabled=function(e,t,r){if(void 0===r&&(r=!1),!r)return 0!=(e&t.RenderFlags);if(!o.isNullOrUndefined(t.RenderFlagsArray)){var n=Math.floor(e/a.MaxBitsPerRenderFlag);if(n<t.RenderFlagsArray.length){var i=e%a.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[n]&1<<i)}}return!1},t.doesNumFmtOverrideText=function(e){return!!s(e)&&(""!==e.WrapText&&""!==e.Text||l(e))},t.isAccAndCustomNumFmtApplicable=l,t.verifyArgumentNotNull=function(e,t,r){if(null==e)throw Error(r+".verifyArgumentNotNull: "+t+" cannot be null or undefined")},t.getDefaultCell=function(e,t,r,o){void 0===r&&(r=void 0),void 0===o&&(o=void 0);var a=r&&0!==r.length?n.getReferencedObjectById(i.UniqueStyleID.Default,r):void 0;return{Col:t,CachedStyle:a,CachedFont:o&&0!==o.length&&a?n.getReferencedObjectById(a.FontID,o):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:i.UniqueStyleID.Default,BorderStyleID:i.UniqueStyleID.DefaultBorder,Text:"",ValueType:i.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=function(e){return null==e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTextBaseline="alphabetic",t.IconTextMinimalPadding=1,t.DefaultFallbackFontName="calibri"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17);function i(e){return"Sanitized_"+e}function o(e){return n.KnownFontNamesLowerCase.indexOf(e.replace(/\s/g,"").toLowerCase())>-1}t.getFontNameForLogging=function(e){var t="Custom Font";return o(e)&&(t=i(e)),t},t.sanitizeFontName=i,t.isKnownFont=o,t.canonizeFontName=function(e){var t=e,r=e.indexOf("(Body)");return r>0&&(t=e.substring(0,r).trim()),t.replace(/[\""]/g,"").toLowerCase()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(t.BreakType||(t.BreakType={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.LineDirection||(t.LineDirection={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(t.MenuDisplayType||(t.MenuDisplayType={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.AggregationTypeMax=11]="AggregationTypeMax"}(t.PivotTableDataFieldAggregationType||(t.PivotTableDataFieldAggregationType={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(t.PivotTableDataFieldFormatType||(t.PivotTableDataFieldFormatType={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(t.RangeType||(t.RangeType={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(t.GradientShadingStyle||(t.GradientShadingStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(t.BackgroundFillType||(t.BackgroundFillType={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(t.ReadingOrderType||(t.ReadingOrderType={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(t.UniqueStyleID||(t.UniqueStyleID={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(t.CellValueType||(t.CellValueType={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(t.CellFormulaType||(t.CellFormulaType={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(t.AutoFilterType||(t.AutoFilterType={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(t.CellsEncoding||(t.CellsEncoding={})),function(e){e[e.None=0]="None",e[e.UpdateFontLoadStatus=1]="UpdateFontLoadStatus",e[e.VerticalTextSlice1=2]="VerticalTextSlice1",e[e.VerticalTextSlice2=4]="VerticalTextSlice2",e[e.VerticalTextSlice3=16]="VerticalTextSlice3",e[e.PivotTable=64]="PivotTable",e[e.MeasureTextWidthUseNewRegex=2048]="MeasureTextWidthUseNewRegex",e[e.AdvancedTextMetrics=8192]="AdvancedTextMetrics",e[e.AdvancedVerticalAlignment=16384]="AdvancedVerticalAlignment",e[e.FontFallback=65536]="FontFallback",e[e.MeasureTextAfterFontDownload=131072]="MeasureTextAfterFontDownload",e[e.RichValueIcon=1048576]="RichValueIcon",e[e.NumFmtNewFontAPI=2097152]="NumFmtNewFontAPI",e[e.PageBreaks=134217728]="PageBreaks",e[e.PrintArea=536870912]="PrintArea",e[e.RemoveBordersWithinASpillCell=2147483648]="RemoveBordersWithinASpillCell"}(t.RenderFlags||(t.RenderFlags={})),function(e){e[e.PivotTable=0]="PivotTable",e[e.ScaleFactorRefactor=1]="ScaleFactorRefactor",e[e.FixingNumFmtHashesString=2]="FixingNumFmtHashesString",e[e.FormulaView=3]="FormulaView",e[e.CanvasHitTest=4]="CanvasHitTest",e[e.AdvHAFillSpillCellBugFix=5]="AdvHAFillSpillCellBugFix",e[e.CFIconsWithCAS=6]="CFIconsWithCAS",e[e.GetFormattedTextFix=7]="GetFormattedTextFix",e[e.NumFmtIgnoreWidthZeroError=8]="NumFmtIgnoreWidthZeroError"}(t.RenderFlagsArray||(t.RenderFlagsArray={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(t.MenuItemType||(t.MenuItemType={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(t.BorderPositionType||(t.BorderPositionType={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(t.OutlineState||(t.OutlineState={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter"}(t.MenuEntryIdentifier||(t.MenuEntryIdentifier={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(t.RichValueCellType||(t.RichValueCellType={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(t.CFIconSet||(t.CFIconSet={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(t.SparklineType||(t.SparklineType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(3),o=r(1),a=r(6),l=r(1);function s(e,t,r){var o=Math.round(e*t)-n.GridLineWidthPx/2;if(r&&i.isSafari()){var a=window?window.devicePixelRatio:-1;2===a&&t===a/2&&(o-=1)}return o}function u(e,t,r,n){var i=e+t-r;return i=Math.min(i,n)}t.drawGridLines=function(e,t,r){if(!(t.RowOffsets&&t.ColumnOffsets&&t.RowHeights&&t.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: "+!t.RowOffsets+", ColumnOffsets: "+!t.ColumnOffsets+", RowHeights: "+!t.RowHeights+", ColumnWidths: "+!t.ColumnWidths;if(t.RowOffsets.length!==t.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(t.ColumnOffsets.length!==t.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";if(t.ShowGridLines&&!(r.scaleFactor<n.MinimalScaleFactorForGridlinesRendering)&&i.shouldRenderGridLines(o.isHighContrastMode(r),o.hasWorkbookBackgroundColor(t.BackgroundColor))){e.lineWidth=n.GridLineWidthPx,e.setLineDash(function(e){if(!a.isNullOrUndefined(e.GridLineColor))return n.ColoredGridLineDash;return n.DefaultDash}(t)),e.strokeStyle=function(e,t){if(!a.isNullOrUndefined(t.highContrastScheme))return""+l.rgbToColorHex(t.highContrastScheme.TextColor);if(!a.isNullOrUndefined(e.GridLineColor))return e.GridLineColor;return n.DefaultGridlineColor}(t,r);var d=o.getLinePixelTranslation(n.GridLineWidthPx),c=s(t.BlockWidth,r.scaleFactor,!1),g=s(t.BlockHeight,r.scaleFactor,!0);e.beginPath(),function(e,t,r,n,o,a){for(var l=a.startRow,s=a.endRow,d=l;d<=s;d++){var c=u(t[d],i.getRowHeightFromOffsets(d,t),n,o);i.drawLine(e,0,c,r,c)}}(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*r.scaleFactor,d,g,r.renderingRegion),function(e,t,r,n,o,a){for(var l=a.startColumn,s=a.endColumn,d=l;d<=s;d++){var c=u(t[d],i.getColWidthFromOffsets(d,t),n,o);i.drawLine(e,c,0,c,r)}}(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*r.scaleFactor,d,c,r.renderingRegion),e.stroke()}},t.getMaxLineOffset=s,t.getAdjustedDrawingOffset=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(6),o=r(1);t.registerExternalCallbacks=function(e){n=e},t.handleRibbonCommand=function(e,t,r,i){o.verifyArgumentNotNull(n,"externalCallbacks","handleRibbonCommand"),n.handleRibbonCommandCallback(e,t,r,i)},t.showFloatingCommentCallback=function(e,t,r){o.verifyArgumentNotNull(n,"externalCallbacks","showFloatingCommentCallback"),n.showFloatingCommentCallback(e,t,r)},t.invokeRibbonCommandWithCellReference=function(e,t,r,i){o.verifyArgumentNotNull(n,"externalCallbacks","invokeRibbonCommandWithCellReference"),n.invokeRibbonCommandWithCellReferenceCallback(e,t,r,i)},t.followHyperlink=function(e,t){o.verifyArgumentNotNull(n,"externalCallbacks","followHyperlink"),n.followHyperlinkCallback(e,t)},t.handleGoTo=function(e,t,r,i,a,l,s){o.verifyArgumentNotNull(n,"externalCallbacks","handleGoTo"),n.handleGoToCallback(e,t,r,i,a,l,s)},t.togglePivotDrillFromChildElement=function(e){o.verifyArgumentNotNull(n,"externalCallbacks","togglePivotDrillFromChildElement"),n.togglePivotDrillFromChildElementCallback(e)},t.setLastInputMethod=function(e){o.verifyArgumentNotNull(n,"externalCallbacks","setLastInputMethod"),n.setLastInputMethod(e)};var a={};t.getServiceSetting=function(e,t){if(!n)return t;if(!i.isNullOrUndefined(a[e]))return a[e];var r=n.getServiceSetting(e);return a[e]=r,i.isNullOrUndefined(r)?t:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1),o=r(12);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(n=t.FontLoadStatus||(t.FontLoadStatus={}));var a={};function l(){return void 0!==document.fonts}function s(e){try{return!!document.fonts.check(e)||window.parent.document.fonts.check(e)}catch(e){return o.setRenderingResultWarning("Error in documentFontsCheck"),!1}}function u(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function d(e,t){if("function"!=typeof document.fonts.values)return!1;for(var r=document.fonts.values(),i=r.next();!i.done;){if(i.value&&i.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case n.Loaded:if("loaded"===i.value.status)return!0;break;case n.Failed:if("error"===i.value.status)return!0}i=r.next()}return!1}function c(e,t){a[e]=t}function g(e){return null!==a[e]&&void 0!==a[e]}t.fontFaceSetSupported=l,t.getFontFaceSetReady=function(){return document.fonts.ready},t.documentFontsCheck=s,t.isFontValid=u,t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t},t.isValidCellFontLoaded=function(e,t){var r;return!!u(null===(r=t.CachedFont)||void 0===r?void 0:r.FontName)&&s(i.getFontCssStringFromCell(t,e))},t.isFontLoaded=function(e){return d(e,n.Loaded)},t.isFontLoadFailed=function(e){return d(e,n.Failed)},t.getFontLoadStatus=function(e){return a[e]},t.setFontLoadStatus=c,t.doesFontExist=g,t.updateFontLoadStatus=function(e){l()&&!g(e)&&u(e)&&function(e){return s("11pt "+e)}(e)&&c(e,n.Loaded)},t.isFontUsedInModel=function(e,t){return!(!e.Fonts||0===e.Fonts[t].RefCount)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(6),o=r(1),a=r(11);function l(e,t){return t?i.isNullOrUndefined(e.ColumnHeaderRange)?e.RowHeaderRange.FirstRow:e.ColumnHeaderRange.FirstRow:e.FirstRow}t.getPivotTableTopAdjustedForDrawing=function(e,t,r){n.verifyArgumentNotNull(e,"model","getPivotTableTopAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var i=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(n.verifyArgumentNotNull(i,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),n.verifyArgumentNotNull(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),r&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing){var a=l(t,r);return i[o.getModelRowIndex(e,a)]}return i[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,r){n.verifyArgumentNotNull(e,"model","getPivotTableLeftAdjustedForDrawing"),n.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var i=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return n.verifyArgumentNotNull(i,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),n.verifyArgumentNotNull(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),r||!e.IsRtl?i[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:i[i.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-i[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t,r,i){return n.verifyArgumentNotNull(e,"model","isPivotIntersectsRenderingRegion"),n.verifyArgumentNotNull(t,"pivotTable","isPivotIntersectsRenderingRegion"),n.verifyArgumentNotNull(r,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<r.startRow)&&(!((t.IsEmptyPivot?t.FirstRowIndex:o.getModelRowIndex(e,l(t,i)))>r.endRow)&&(!(t.FirstColIndex<r.startColumn)&&!(t.LastColIndex>r.endColumn)))},t.canCellContainExpandCollapseAndCFIcon=function(e,t,r,i){var o,l;if(!n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)||!(null===(l=null===(o=t.CondFormat)||void 0===o?void 0:o.Icon)||void 0===l?void 0:l.IconOnly))return!0;var s=t.CachedFont.Size,u=a.getIconHorizontalPadding(s,i),d=a.getIconSize(s,i),c=a.getExpandCollapseButtonPadding(e,t)*i;switch(t.CondFormat.Icon.CFIconHorizontalAlignment){case n.HorizontalAlignment.Left:case n.HorizontalAlignment.Right:return r-d-u-c>0;case n.HorizontalAlignment.Center:return r/2-d/2-c>0;default:return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(61),i=r(89);function o(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}t.breakToGraphemes=function(e){if(!e)return[];for(var t=[],r=0,a=e.charCodeAt(r),l=i.classifyChar(e.codePointAt(r)),s=n.CombiningClass.Other,u=1;u<e.length;u++){var d=e.charCodeAt(u);u>=1&&o(a,d)||(s=i.classifyChar(e.codePointAt(u)),n.shouldBreak(l,s)&&(t.push(e.substring(r,u)),r=u),l=s,a=d)}return r<=e.length-1&&t.push(e.substring(r)),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(16),a=r(103),l=r(14);function s(e,t,r,s){var c=t.image,g=t.highContrastScheme,f=function(e){var t=e.left,r=e.bottom,n=e.size/2,i=n-l.ShapeOutlineWidthPx,o=Math.round(t+n),a=Math.round(r-n);return{centerX:o,centerY:a,innerRadius:i,outlineRadius:n}}(t),p=f.outlineRadius;p<=0||(u(e,f.centerX,f.centerY,p,i.Circle0Deg,i.Circle360Deg,r),s&&f.innerRadius>0&&function(e,t,r,l,s){var c=t.centerX,g=t.centerY,f=t.innerRadius;if(s)!function(e,t,r,o){var l=t.centerX,s=t.centerY,c=t.innerRadius,g=a.getHighContrastFillingType(o),f=n.rgbToColorHex(r.BackgroundColor),p=n.rgbToColorHex(r.TextColor);switch(g){case a.FillType.Full:break;case a.FillType.FillPortion:var h=d(o);u(e,l,s,c,h,i.Circle270Deg,f);break;case a.FillType.Empty:u(e,l,s,c,i.Circle0Deg,i.Circle360Deg,f);break;case a.FillType.InnerCircle:u(e,l,s,c,i.Circle0Deg,i.Circle360Deg,f);var m=a.getInnerCircleRadius(o,c);u(e,l,s,m,i.Circle0Deg,i.Circle360Deg,p);break;case a.FillType.Stripes:u(e,l,s,c,i.Circle0Deg,i.Circle360Deg,f),a.drawStripes(e,l,s,c,p);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,s,l);else switch(l){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:var p=d(l);u(e,c,g,f,i.Circle270Deg,p,r),u(e,c,g,f,p,i.Circle270Deg,o.CircleEmptyInnerColor);break;default:u(e,c,g,f,i.Circle0Deg,i.Circle360Deg,r)}}(e,f,s,c,g))}function u(e,t,r,n,i,o,a){e.fillStyle=a,e.beginPath(),e.moveTo(t,r),e.arc(t,r,n,i,o),e.fill()}function d(e){switch(e){case i.CFIconImage.Circle25:return i.Circle0Deg;case i.CFIconImage.CircleHalf:return i.Circle90Deg;case i.CFIconImage.Circle75:return i.Circle180Deg;default:throw Error("getFillAngle: image: "+e+" not supported")}}t.drawCircleIcon=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawCircleIcon"),n.verifyArgumentNotNull(t,"drawingContext","drawCircleIcon");var r=t.image,a=t.highContrastScheme;s(e,t,function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighOuterColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumOuterColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowOuterColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyOuterColor;case i.CFIconImage.CircleFilled:case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledOuterColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighOuterColor;case i.CFIconImage.FourCircleLow:return o.FourCircleLowOuterColor;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1OuterColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2OuterColor;default:throw Error("getCircleOutlineColor: unsupported image type = "+e)}}(r,a),function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighInnerColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumInnerColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowInnerColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyInnerColor;case i.CFIconImage.CircleFilled:return o.CircleFilledInnerColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighInnerColor;case i.CFIconImage.FourCircleLow:return;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1InnerColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2InnerColor;case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledInnerColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(r,a))},t.drawCircle=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(2);!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(n=t.ImageLoadStatus||(t.ImageLoadStatus={})),function(e){e[e.Sparkline=0]="Sparkline"}(t.ImageType||(t.ImageType={}));var o={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function l(e,t,r,i){var o=g(e);if(o||(f(e,o={blockIdentifiers:[t],status:n.Initialized,version:r,url:i}),i))switch(o.status){case n.Loaded:return o.image;case n.LoadFailed:return;case n.Loading:return void d(t,o);case n.Initialized:return d(t,o),void(o.url&&c(o));default:throw Error("getOrLoadImageByKey: unexpected image statue: "+o.status)}}function s(e){return"STATIC"+e}function u(e,t){return e+t}function d(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function c(e){if(!e.url)throw Error("image url is not set, unexpected call");var t=new Image;t.onload=function(){e.status=n.Loaded,i.verifyArgumentNotNull(o.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),o.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=n.LoadFailed,i.verifyArgumentNotNull(o.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),o.onImageLoadFailureCallback("image failed to load, URL: "+e.url+", registeredModelsCount: "+e.blockIdentifiers.length+", registeredModelsCount: "+e.blockIdentifiers),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=n.Loading}function g(e){return a[e]}function f(e,t){a[e]=t}function p(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){o.onImageLoadSuccessCallback=e,o.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){i.verifyArgumentNotNull(t,"url","setStaticImageUrl");var r=s(e),o=g(r);if(o){if(o.url)throw Error("setStaticImageUrl: image url already defined. image: "+e+", old url: "+o.url+", new url: "+t);o.url=t,c(o)}else f(r,{blockIdentifiers:[],status:n.Initialized,url:t})},t.clearImageFromCache=function(e,t){var r=u(e,t);g(r)&&p(r)},t.getOrLoadVersionedImage=function(e,t,r,n,i){var o=u(e,n),a=g(o);return!a||a.version===t&&a.url===r||p(o),l(o,i,t,r)},t.getOrLoadStaticImage=function(e,t){return l(s(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:function(e){return g(e)},resetImageCache:function(){for(var e in a)delete a[e]},getImageKey:function(e,t){return u(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["RowOutlines","ColumnOutlines","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlags","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache"],t.comparisonIgnoreLists.Cell=["StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","ShrunkSize","AutoFilter","PivotFilter","CommentID","RichValueType","RichValueFieldsIndexes","FormulaInfo","ValueType","SrvDx","SrvDy","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","DisplayFormula","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount"],t.comparisonIgnoreLists.CellStyle=["NamedStyleId","FontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.comparisonIgnoreLists.MergeInformation=["WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.TextRun=["FontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","CanExpandCollapse"],t.propertyToClassMap={},t.propertyToClassMap.PermissionSet=["PermissionSet"],t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines"],t.propertyToClassMap.InCellImages=["InCellImages"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.RibbonCommands=["RibbonCommands"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation"],t.propertyToClassMap.InCellImage=["InCellImageInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.RenderingContext=["AutoFilterRenderingContext"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.Font=["FontName"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PermissionSet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlags"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.InCellImages"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["GridBlockModel.RibbonCommands"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Col"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Row"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Text"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Ifmt"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Spill"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Merge"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CommentID"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellImage"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.SrvDx"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.SrvDy"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.DisplayFormula"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Value"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.Borders"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Size"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontName"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Color"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Underline"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null}return e.prototype.dispose=function(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.canvas.width=0,this.canvas.height=0},e.prototype.appendToParent=function(e){e&&(e.appendChild(this.canvas),this.parentElement=e)},e.prototype.getContext2d=function(e){return this.canvas.getContext("2d",e)},e.prototype.getWidth=function(){return this.canvas.width},e.prototype.getHeight=function(){return this.canvas.height},e.prototype.getStyle=function(){return this.canvas.style},e.prototype.setClassName=function(e){this.canvas.className=null!=e?e:""},e.prototype.updatePosition=function(e,t,r,n){if(this.canvas){var i=e+"px",o=t+"px",a=this.canvas.style;if(r||(n?a.right!==i:a.left!==i)||a.top!==o)return n?a.right=i:a.left=i,a.top=o,!0}return!1},e.prototype.setDimensions=function(e,t,r){var n=Math.round(e*r),i=Math.round(t*r);this.canvas.style.width=n/r+"px",this.canvas.style.height=i/r+"px",this.canvas.width=n,this.canvas.height=i},e.prototype.setRenderingRegion=function(e){e&&(this.renderingRegion=e)},e.prototype.getRenderingRegion=function(){return this.renderingRegion},e}();t.RenderingCanvasElement=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),i=r(26),o=r(31),a=r(2),l=r(25),s=r(1),u=document.createElement("div"),d=document.createElement("img"),c=document.createElement("img");u.innerText=".",u.style.visibility="hidden",d.style.height="0px",c.style.height="0px",u.appendChild(d),u.appendChild(c),document.body.appendChild(u);var g={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function f(e){var t=-1,r=-1,i=-1,o=d,a=c;return u.style.font=e,o.style.verticalAlign="baseline",a.style.verticalAlign="middle",n.trackDuration(n.RenderPerformanceMetric.GetFontMetrics,(function(){t=u.clientHeight,r=p(o),i=p(a)}),!0),{height:t,baseline:r,middle:i}}function p(e){if(!u||!e)throw Error("getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: "+u+", baselineLocator: "+e);try{var t=u.getBoundingClientRect(),r=e.getBoundingClientRect();return t.bottom-r.bottom}catch(e){return n.setRenderingResultWarning("Error in getFontBaselineHeight: "+e),0}}function h(e,t){var r,n=s.getFontLookupKey(e,t);if(t>=0&&t<1)return g[n]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},g[n].fontMetrics;try{r=f(n)}catch(r){return C(t,e,n,"Exception in getFontMetrics, error:"+r)}return 0===r.height&&t>=1?C(t,e,n,"fontMetricsDivHeight == 0."):(g[n]={fontSize:t,fontMetrics:r},r)}function m(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function C(e,t,r,o){var a=null!==u.parentNode?"Has Parent":"Parent is null",l=window.getComputedStyle(u).getPropertyValue("display");u.style.display="block",document.body.appendChild(u);var s=f(r),d=window.getComputedStyle(u),c=d.getPropertyValue("display"),p=d.getPropertyValue("height"),h=u.getBoundingClientRect();if(0!==s.height)return g[r]={fontSize:e,fontMetrics:s},s;u.style.overflow="hidden";var m=f(r);if(0!==m.height)return g[r]={fontSize:e,fontMetrics:s},m;var C="\n       "+o+"\n       Font name: "+i.getFontNameForLogging(t)+" }, font size: "+e+".\n       fontMetricsDiv "+a+". fontMetricsDivDisplayMode: "+l+".\n       After another appendChild:\n       FontMetricsDivHeight2: "+s.height+" (getFontMetricsDivHeight), fontMetricsDivDisplayMode: "+c+" (getComputedStyle),\n       fontBoundingClientRect.height: "+h.height+" }, top:"+h.top+" }, bottom:"+h.bottom+".\n       css.height: "+d.height+" }, css.line-height: "+d.lineHeight+" }, computedHeight: "+p+".\n       FontMetricsDiv.scrollWidth: "+u.scrollWidth+" }, fontMetricsDiv.scrollHeight: "+u.scrollHeight;if(n.setRenderingResultWarning(C),!i.isKnownFont(t)){var v=Math.round(e)+"pt calibri";if(g[v])return g[v].fontMetrics}throw Error(C)}function v(e){var t=g[s.getFontLookupKey(l.DefaultFallbackFontName,e)];return m(t?t.fontMetrics:h(l.DefaultFallbackFontName,e))}t.getCachedFontMetrics=function(e,t,r){a.isRenderFlagEnabled(a.RenderFlags.UpdateFontLoadStatus,r)&&o.updateFontLoadStatus(i.canonizeFontName(e));var l=s.getFontLookupKey(e,t),u=g[l];if(u)return m(u.fontMetrics);try{return m(h(e,t))}catch(o){if(a.isRenderFlagEnabled(a.RenderFlags.FontFallback,r)){n.setRenderingResultWarning("FontName:"+i.getFontNameForLogging(e)+", FontSize:"+t+" is trying to fallback to calibri "+o),r.ClientOnlyCache.FallbackFonts[l]=!0;try{return v(t)}catch(e){return v(Math.max(Math.round(t),1))}}throw o}},t.recalculateFontMetrics=function(e,t){for(var r=Object.getOwnPropertyNames(g),n=e.toLowerCase(),i=0;i<r.length;i++){var o=r[i];if(o.indexOf(n)>=0){var s=g[o].fontSize;try{h(n,s)}catch(e){a.isRenderFlagEnabled(a.RenderFlags.FontFallback,t)&&h(l.DefaultFallbackFontName,s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164,t.ExpandCollapseButtonSizePx=9,t.ExpandCollapseButtonInnerColor="#FAFAFA",t.ExpandCollapseButtonOuterColor="#3A3A38",t.MinusPlusPaddingPx=1,t.MinusPlusWidthPx=1,t.PaddingBetweenExpandCollapseButtonAndTextPx=3,t.PlusMinusLineAdjustment=.5,t.ExpandCollapseButtonVerticalPaddingPx=4,t.NoIndent=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(27),o=r(5),a=r(2),l=r(8),s=r(20),u=r(90),d=r(12),c=r(10);function g(e,t,r,a){if(void 0===a&&(a=0),e.isProcessingLastLine&&e.breakType===i.BreakType.Justify){var l=function(e,t,r){void 0===r&&(r=0);for(var n="",i=0,a=0;a<e.length;a++)n+=e[a].text,i+=e[a].width,a!==e.length-1&&(n+=o.Whitespace,i+=t);return{Start:{Offset:r,Text:n,Width:i},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,a);return e.lineDirection===i.LineDirection.Vertical&&(l.Start.Offset=e.maxWidth-l.Start.Width),l}if(e.lineDirection===i.LineDirection.Vertical&&function(e){if(e.length>=2){var t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){var s=a,u=0,c=t[u],g=(l={Start:{Offset:s,Text:c.text,Width:c.width},SpaceWidthBetweenWords:r},Math.floor(r/e.singleSpaceWidth));g<1&&(g=1);var f=function(e,t,r,n){if(e.lineDirection===i.LineDirection.Vertical&&n>3)return r-t*e.singleSpaceWidth>=0?Math.floor((r-t*e.singleSpaceWidth)*(n-3)/2):0;return 0}(e,g,r,t.length);s+=c.width+r+f,u++,(void 0===g||isNaN(g)||g===1/0)&&(d.setRenderingResultWarning("getJustifyDistributedLine: Invalid count variable. numberOfSpaces: "+g+", spaceWidthBetweenTokens: "+r+", singleSpaceWidth: "+e.singleSpaceWidth+" "),g=1);for(var p="",h=s,m=0;u<t.length-1;u++)p+=(c=t[u]).text,m+=c.width,u!==t.length-2&&(p+=o.Whitespace.repeat(g),m+=e.singleSpaceWidth*g);if(""!==p&&(l.Middle={Offset:h,Text:p,Width:m}),t.length>1){var C=t[t.length-1],v=n.isNullOrUndefined(l.Middle)?s:h+m+r+f;l.End={Offset:v,Text:C.text,Width:C.width}}return l}}function f(e,t){var r=e;if(r.length<=1)return 0;if(t.breakType===i.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;for(var n=0,o=0;o<r.length;o++){n+=r[o].width}var a=(t.maxWidth-n)/(r.length-1);return a<t.singleSpaceWidth?t.singleSpaceWidth:a}function p(e,t,r){return e?t[t.length-1-r]:t[r]}function h(e,t){return e.isProcessingLastLine&&e.breakType===i.BreakType.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function m(e,t,r,n,i,o,a){for(var l=[],s=0,u=!1,d=0;d<r.length;d++){var c=r[d];if(v(c,n,i))if(y(c,n,i))l.push(c),s+=c.width;else{var g=T(e,t,c,n,i,o,a);u=o?u||!c.text.startsWith(g.text):S(c.text)?!c.text.startsWith(g.text):!c.text.endsWith(g.text),l.push(g),s+=g.width}}return{currentTextTokens:l,currentTokenWidthPx:s,combinePartialTokens:u}}function C(e){if(e.Start&&e.End){var t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords},r=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,r=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=r,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),r=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:r+t.SpaceWidthBetweenWords},t}return e}function v(e,t,r){return e.start<r&&e.start+e.text.length>t}function y(e,t,r){return t<=e.start&&e.start+e.text.length<=r}function T(e,t,r,n,i,o,s){var u=r.start<n?n-r.start:0,d=u+i-(n>r.start?n:r.start),c=r.text.substring(u,d);return{text:c,start:r.start>n?r.start:n,width:o?l.measureTextHeightForVerticalText(s,c):l.measureTextWidth(e,c,!0,a.isRenderFlagEnabled(a.RenderFlags.MeasureTextWidthUseNewRegex,t)),containsThaiCharacters:r.containsThaiCharacters}}function S(e){return!!e&&s.analyzeBidiText(e,a.ReadingOrderType.LeftToRight).HasRtl}function F(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function w(e,t,r){return e===i.LineDirection.Vertical?r:t.measureText(" ").width}t.getJustifyDistributedLine=g,t.getSpaceWidthBetweenWords=f,t.prepareTextRunsForJustifyAndDistributed=function(e,t,r,a,l,s){if(0===l.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0!==a.length){s&&(r.maxWidth=r.maxWidth-2*o.GridLineWidthPx);var u=h(r,a);if(1===l.length){var d=e.font,v=d,y=l[0],T=y.FontCss;v!==T&&(e.font=T,v=T);var x=F(r);x.singleSpaceWidth=w(r.lineDirection,e,y.MaxGlyphHeightPx);var b=g(x,a,f(a,r),u);s||!S(y.Text)||n.isNullOrUndefined(b)||(b=C(b)),y.JustifyDistributedLine=b,y.WidthPx=function(e,t){var r=0;if(t&&e.breakType===i.BreakType.Justify)return r+=null==t?void 0:t.Start.Width,(null==t?void 0:t.Middle)&&(r+=null==t?void 0:t.Middle.Width),(null==t?void 0:t.End)&&(r+=null==t?void 0:t.End.Width),r;return e.maxWidth}(r,b),v!==d&&(e.font=d)}else!function(e,t,r,o,a,l,s){void 0===s&&(s=0);for(var u=f(r,o),d=function(e){for(var t=e[0].start,r=1;r<e.length;r++)e[r].start<t&&(t=e[r].start);return t}(r),h=e.font,v=h,y=s,T=0;T<a.length;T++){var x=p(l,a,T),b=x.FontCss;v!==b&&(e.font=b,v=b);var I=F(o);I.singleSpaceWidth=w(o.lineDirection,e,x.MaxGlyphHeightPx);var R=x.StartIndex+d,O=R+(void 0!==x.Text?x.Text.length:0),A=m(e,t,r,R,O,l,x.MaxGlyphHeightPx),P=A.currentTextTokens,L=A.currentTokenWidthPx,M=A.combinePartialTokens;if(0!==P.length){var k=g(I,P,u,y);c.isVerticalTextPresentSlice3||n.isNullOrUndefined(k)||S(x.Text)&&(k=C(k)),x.JustifyDistributedLine=k,l&&o.lineDirection===i.LineDirection.Vertical?x.HeightPx=L+u*(P.length-1):x.WidthPx=L+u*(P.length-1),M||x.IsSpecialCharTextRun?y+=L+u*(P.length-1):y+=L+u*P.length}}v!==h&&(e.font=h)}(e,t,a,r,l,s,u)}},t.reorderTextTokens=function(e,t,r,n){if(!r.HasRtl||r.HasLtr)u.reorderTextTokensUsingDom(e,t,r,n);else for(var i=0;i<e.tokensPerLine.length;i++)e.tokensPerLine[i].tokens.reverse()},t.getTextRun=p,t.getStartOffset=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(8),o=r(33),a=r(22),l=r(10),s=r(62);function u(e,t,r,a,l,u,c,g,f,p,h,m){var C,v,y=e.textAlign;"center"!==y&&(e.textAlign="center");var T=o.breakToGraphemes(a),S=c||i.getTextLineHeight(r,t),F=function(e,t){return(e.length-1)*t}(T,S);!function(e,t,r,n,i,o,a,l,s,u,c){for(var g=o,f=n.length-1;f>=0;f--){var p=n[f];" "!==p&&(e.fillText(p,i,g),d(e,t,r,i,g,p,l,s,u,c)),g-=a}}(e,t,r,T,u,function(e,t,r,i,o){var a=function(e,t,r,i){var o=s.getVerticalTextPadding(t);switch(e){case n.VerticalAlignment.Top:return r+i+o;case n.VerticalAlignment.Center:return r+i/2;case n.VerticalAlignment.Bottom:default:return r-o}}(e,t,r,i);if(o&&e===n.VerticalAlignment.Distributed&&o<=0)return a-o;return a}(null===(C=r.CachedStyle)||void 0===C?void 0:C.VerticalAlignment,null===(v=r.CachedStyle)||void 0===v?void 0:v.Indentation,l,F,m),S,g,f,p,h),"center"!==y&&(e.textAlign=y)}function d(e,t,r,o,s,u,d,c,g,f){c&&l.isVerticalTextPresentSlice2(t,r)&&a.cacheTextDecorationLayout(t,r,{textPositionX:o,textPositionY:s,scaleFactor:d,textWidth:i.measureTextWidth(e,u,n.isRenderFlagEnabled(n.RenderFlags.AdvancedTextMetrics,t),n.isRenderFlagEnabled(n.RenderFlags.MeasureTextWidthUseNewRegex,t)),clipRect:f},g)}t.fillVerticalText=function(e,t,r,n,i,o,a,l,s){u(e,t,r,n,o,i,void 0,a,!0===r.CachedFont.StrikeThrough,r.CachedFont,l,s)},t.fillVerticalTextForRTF=function(e,t,r,n,i,o,a,l,s,d,c,g){u(e,t,r,n,o,i,a,l,s,d,c,g)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(2);!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(n=t.AdvVerticalAlignmentFormat||(t.AdvVerticalAlignmentFormat={})),t.isVerticalAlignmentJustifyOrDistributed=function(e){switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return!0}return!1},t.getEffectiveVerticalAlignment=function(e,t,r,o,a,l,s){if(s)return i.VerticalAlignment.Bottom;switch(e){case i.VerticalAlignment.Top:case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Center:return e;case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return function(e,t,r,o,a,l){switch(t){case n.WrapText:return function(e,t,r,n,o){if(1===o||t<n)switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Center}if(t<r&&t>=n)switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Top}return e}(e,r,o,a,l);case n.CFIcon:return function(e){switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Center}return i.VerticalAlignment.Center}(e)}}(e,t,r,o,a,l)}},t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=function(e,t,r){return(e-t)/(r-1)},t.getAdvancedVerticalAlignmentOffsetYForWrapText=function(e,t,r){return e-t*r}},function(e,t,r){"use strict";function n(){return Date.now()}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateExecutionsPerSecond=function(e,t){for(var r=n(),i=0;n()-r<t;)e(i),i++;return i*(1e3/t)},t.getCurrentTimeInMs=n},function(e,t,r){"use strict";r(45),r(71)},function(e,t){},function(e,t,r){"use strict";r.r(t);var n=r(47);for(var i in n)"default"!==i&&function(e){r.d(t,e,(function(){return n[e]}))}(i);var o=r(72);r.d(t,"UnavailabilityToast",(function(){return o.a})),r.d(t,"UnavailabilityToastFactory",(function(){return o.b}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);n.__exportStar(r(75),t),n.__exportStar(r(49),t),n.__exportStar(r(48),t),n.__exportStar(r(135),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(49),i=r(134),o=r(1),a=r(37),l=r(53),s=function(){function e(){}return e.prototype.getModelAccessor=function(e){return o.verifyArgumentNotNull(e,"model","GridBlockRendererFactory.getModelAccessor"),new i.GridBlockModelAccessor(e)},e.prototype.getGridBlockRenderer=function(){return new n.GridBlockRenderer},e.prototype.createRenderingCanvasElement=function(e){return e?new l.InteractableCanvasElement:new a.RenderingCanvasElement},e}();t.GridBlockRendererFactory=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(29),o=r(84),a=r(85),l=r(12),s=r(86),u=r(88),d=r(3),c=r(99),g=r(1),f=r(6),p=r(59),h=r(60),m=r(64),C=r(22),v=r(101),y=r(17),T=r(102),S=r(114),F=r(124),w=r(125),x=r(126),b=r(127),I=r(129),R=r(130),O=r(55),A=r(131),P=function(){function e(){}return e.prototype.renderBlock=function(t,r,i){var o=this;if(l.clearPerformanceMetrics(),S.loadPolyFills(),!t)return l.createRenderResult(!1,"renderBlock:: canvas is undefined");if(!r)return l.createRenderResult(!1,"renderBlock:: model is undefined");if(!i)return l.createRenderResult(!1,"renderBlock:: context is undefined");if(!s.isRenderingCanvasElement(t,n.isRenderFlagEnabled(n.RenderFlagsArray.CanvasHitTest,r,!0)))return l.createRenderResult(!1,"renderBlock:: canvas is not a rendering canvas");var a=null;if(l.trackDuration(l.RenderPerformanceMetric.GetContextDurationMs,(function(){a=t.getContext2d({alpha:!i.subPixelRenderingEnabled})})),!a)return l.createRenderResult(!1,"renderBlock:: ctx is undefined");var u,d=g.extendRenderingContext(i,r);return l.trackDuration(l.RenderPerformanceMetric.ModelPreparationsMs,(function(){o.initializeCachedObjects(r),o.createOffsetsForDrawing(r,d.scaleFactor),o.updateCellsBeforeDrawing(a,r,d),o.updatePivotTablesInformationBeforeDrawing(r.PivotTables,d.scaleFactor)})),l.trackDuration(l.RenderPerformanceMetric.RenderBlockInternalDurationMs,(function(){u=o.renderBlockInternal(t,a,r,d)})),n.isRenderFlagEnabled(n.RenderFlagsArray.CanvasHitTest,r,!0)&&l.trackDuration(l.RenderPerformanceMetric.RegisterHitRegionsMs,(function(){e.initializeCanvasHitTest(t,r,d.renderingRegion,d.zoom)})),r.ClientOnlyCache.IsDirty=!1,f.isNullOrUndefined(u)&&(u=l.createRenderResult(!0,"")),u.succeeded&&(u.message=f.isNullOrUndefined(u.message)?l.getRenderingMessage():u.message+"; "+l.getRenderingMessage()),u},e.prototype.renderBlockInternal=function(t,r,s,d){try{var g,f,m=d.scaleFactor,v=r.canvas.width;this.validateRenderingRegion(d.renderingRegion,s),v=Math.round(s.BlockWidth*m);var y=d.renderingRegion;return f=-1*y.startOffsetY*m,g=this.getDrawingOffsetXForRenderingRegion(s,y)*m,e.clearCanvas(r,s,t.getWidth(),t.getHeight(),d),e.setTransform(r,1,s.IsRtl,g,f,v),l.trackDuration(l.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return i.drawGridLines(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesMs,(function(){l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){h.clearGridLinesForSpannedCells(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForPivotTable,(function(){h.clearGridLinesForPivotTables(r,s,d)}))})),e.setTransform(r,1,!1,g,f,v),l.trackDuration(l.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return c.drawBackgroundFill(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,(function(){return x.drawEmptyPivotTableTitleContainers(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableImages,(function(){return x.drawEmptyPivotTableImages(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawDataBarsMs,(function(){return b.drawDataBars(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawCFIconsMs,(function(){return T.drawConditionalFormattingIcons(r,s,d)})),d.modelFromCache||l.trackDuration(l.RenderPerformanceMetric.DrawSparklines,(function(){return I.drawSparklines(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){p.clearGridLinesForBorder(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawBordersMs,(function(){return p.drawBorders(r,s,d)})),d.debugMode&&a.addWatermark(r,d),e.setTransform(r,d.scaleFactor,!1,g,f,v),l.trackDuration(l.RenderPerformanceMetric.DrawTextDurationMs,(function(){return u.drawCellsText(r,s,d)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,(function(){return x.drawEmptyPivotTableTitleText(r,s,d)})),e.setTransform(r,1,!1,g,f,v),l.trackDuration(l.RenderPerformanceMetric.DrawTextDecoration,(function(){return C.drawTextDecoration(r,s,d)})),n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,s,!0)&&l.trackDuration(l.RenderPerformanceMetric.DrawExpandCollapseButtonsMs,(function(){return R.drawExpandCollapseButtons(r,s,d)})),n.isRenderFlagEnabled(n.RenderFlagsArray.CanvasHitTest,s,!0)&&l.trackDuration(l.RenderPerformanceMetric.DrawAutoFiltersMs,(function(){return A.drawAutoFilters(r,s,d)})),d.skeletonMode&&l.trackDuration(l.RenderPerformanceMetric.DrawSkeletonMs,(function(){return o.drawSkeleton(r,s,d)})),e.setTransform(r,1,s.IsRtl,g,f,v),d.renderPageLayout&&(n.isRenderFlagEnabled(n.RenderFlags.PrintArea,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawPrintAreasDurationMs,(function(){return w.drawPrintAreas(r,s,d)})),n.isRenderFlagEnabled(n.RenderFlags.PageBreaks,s)&&l.trackDuration(l.RenderPerformanceMetric.DrawPageBreaksDurationMs,(function(){return F.drawPageBreaks(r,s,d)}))),l.createRenderResult(!0,"finished rendering.")}catch(e){return l.createRenderResult(!1,"exception caught in renderBlockInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},e.clearCanvas=function(e,t,r,n,i){i.subPixelRenderingEnabled||g.hasWorkbookBackgroundColor(t.BackgroundColor)?l.trackDuration(l.RenderPerformanceMetric.FillRectDurationMs,(function(){e.fillStyle=g.getWorkbookBackgroundColor(i.highContrastScheme,t.BackgroundColor),e.fillRect(0,0,r,n)})):l.trackDuration(l.RenderPerformanceMetric.ClearRectDurationMs,(function(){e.clearRect(0,0,r,n)}))},e.setTransform=function(e,t,r,n,i,o){r?e.setTransform(-t,0,0,t,o+n,i):e.setTransform(t,0,0,t,n,i)},e.initializeCanvasHitTest=function(e,t,r,n){O.setHitMapOffsets(e,t,r),e.setAppZoom(n);var i=t.ClientOnlyCache.CellHitRegions;this.registerCanvasHitRegionsFromCache(i,(function(t){e.addRegionEventListener(t)}));var o=t.ClientOnlyCache.CellCursorHitRegions;this.registerCanvasHitRegionsFromCache(o,(function(t){e.addCursorRegion(t)})),e.optimizeHitMapLookup()},e.registerCanvasHitRegionsFromCache=function(e,t){if(e)for(var r in e)for(var n=e[r],i=0;i<n.length;i++)t(n[i])},e.prototype.initializeCachedObjects=function(e){g.verifyArgumentNotNull(e.Cells,"cells","GridBlockRenderer.initializeCachedObjects"),g.verifyArgumentNotNull(e.Styles,"styles","GridBlockRenderer.initializeCachedObjects"),g.verifyArgumentNotNull(e.Fonts,"fonts","GridBlockRenderer.initializeCachedObjects");var t=!f.isNullOrUndefined(e.BorderStyles);g.initModelClientCache(e);for(var r=0;r<e.Cells.length;r++){var i=e.Cells[r];if(i.CachedStyle=n.getReferencedObjectById(i.StyleID,e.Styles),t&&!f.isNullOrUndefined(i.BorderStyleID)&&(i.CachedBorderStyle=n.getReferencedObjectById(i.BorderStyleID,e.BorderStyles)),i.CachedFont=n.getReferencedObjectById(i.CachedStyle.FontID,e.Fonts),i.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},!f.isNullOrUndefined(i.TextRuns))for(var o=0;o<i.TextRuns.length;o++){var a=i.TextRuns[o];a.CachedFont=n.getReferencedObjectById(a.FontID,e.Fonts)}i.CachedDisplayText=void 0,i.CachedDisplayTextRuns=void 0}},e.prototype.updateCellsBeforeDrawing=function(e,t,r){var i=t.Cells;g.verifyArgumentNotNull(i,"cells","GridBlockRenderer.updateCellsBeforeDrawing");for(var o=n.isRenderFlagEnabled(n.RenderFlagsArray.FormulaView,t),a=o&&r.isFormulaView,l=0;l<i.length;l++){var s=i[l],u=s.CachedFont.Italic,d=s.CachedFont.FontName!==y.DefaultFontName,c=!!s.TextRuns,f=s.CachedFont.Underline!==n.FontUnderline.None||s.CachedFont.StrikeThrough;o&&(s.DisplayFormula=g.shouldRenderFormulaOnCell(s,a)),s.Text&&(s.CachedDisplayText=g.getDisplayText(s,t)),s.DisplayFormula||(s.Text&&g.cellHasShrinkToFit(s)&&v.updateCellShrinkToFit(e,t,s),(u||d||f||c)&&m.updateCellSpill(e,t,s)),s.Merge&&this.updateCellMergeInformation(t,s,r.scaleFactor)}},e.prototype.createOffsetsForDrawing=function(e,t){var r=e.RowHeights,n=e.ColumnWidths,i=e.RowOffsets,o=e.ColumnOffsets;g.verifyArgumentNotNull(r,"rowHeights","GridBlockRenderer.createOffsetsForDrawing"),g.verifyArgumentNotNull(n,"colWidths","GridBlockRenderer.createOffsetsForDrawing"),g.verifyArgumentNotNull(i,"rowOffsets","GridBlockRenderer.createOffsetsForDrawing"),g.verifyArgumentNotNull(o,"colOffsets","GridBlockRenderer.createOffsetsForDrawing");var a=g.getModelClientCache(e);a.RowOffsetsAdjustedForDrawing=[];for(var l=0;l<i.length;l++){var s=i[l];a.RowOffsetsAdjustedForDrawing.push(Math.round(s*t))}a.ColOffsetsAdjustedForDrawing=[];for(l=0;l<o.length;l++){s=o[l];a.ColOffsetsAdjustedForDrawing.push(Math.round(s*t))}a.RowOffsetsAdjustedForDrawing.push(d.getBlockDimensionsAdjustedForDrawing(e.BlockHeight,t)),a.ColOffsetsAdjustedForDrawing.push(d.getBlockDimensionsAdjustedForDrawing(e.BlockWidth,t))},e.prototype.updateCellMergeInformation=function(e,t,r){var n=t.Merge;if(n.SpansBlocks){n.HeightAdjustedForDrawing=Math.round(n.Height*r),n.WidthAdjustedForDrawing=Math.round(n.Width*r),n.OriginDeltaXAdjustedForDrawing=Math.round(n.OriginDeltaX*r),n.OriginDeltaYAdjustedForDrawing=Math.round(n.OriginDeltaY*r);var i=e.RowOffsets[t.Row]-n.OriginDeltaY;n.SpansNextBlockVertically=i+n.Height>e.BlockHeight;var o=e.ColumnOffsets[t.Col]-n.OriginDeltaX;n.SpansNextBlockHorizontally=o+n.Width>e.BlockWidth}},e.prototype.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(var r=0;r<e.length;r++){var n=e[r];n.DeltaXFromOriginPTAdjustedForDrawing=Math.round(n.DeltaXFromOriginPT*t),n.DeltaYFromOriginPTAdjustedForDrawing=Math.round(n.DeltaYFromOriginPT*t),n.OriginPTHeightAdjustedForDrawing=Math.round(n.OriginPTHeight*t),n.OriginPTWidthAdjustedForDrawing=Math.round(n.OriginPTWidth*t)}},e.prototype.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},e.prototype.validateRenderingRegion=function(e,t){g.verifyArgumentNotNull(e,"renderingRegion","validateRenderingRegion");var r=t.RowOffsets[e.startRow],n=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],o=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(r>e.startOffsetY||n<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= "+e.startOffsetY+", endOffsetY = "+e.endOffsetY+", firstRowStartOffset= "+r+", lastRowEndOffset= "+n);if(i>e.startOffsetX||o<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= "+e.startOffsetX+", endOffsetX = "+e.endOffsetX+", firstColumnStartOffset= "+i+", lastColumnEndOffset= "+o)},e}();t.GridBlockRenderer=P},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),i=r(24);t.getReferencedObjectById=function(e,t){var r;switch(e){case n.UniqueStyleID.Default:case n.UniqueStyleID.Hyperlink:r=t[t.length+e];break;default:r=t[e]}if(i.isNullOrUndefined(r))throw Error("RefObject is null or undefined");if(r.ID!==e)throw Error("RefIDs are not sorted as expected");return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36),i=r(79),o=r(23),a=n.UserContentList.Cell.concat(n.UserContentList.GridBlockModel).concat(n.UserContentList.CellStyle).concat(n.UserContentList.Font).concat(n.UserContentList.BorderStyle).concat(n.UserContentList.AutoFilter).concat(n.UserContentList.PivotFilter).concat(n.UserContentList.MenuItem).concat(n.UserContentList.FormulaInformation).concat(n.UserContentList.NumberFormatInformation);function l(e){return e.toLowerCase().replace(i.DigitReplaceValue,i.CharacterReplaceValue).replace(i.Digit,i.DigitReplaceValue).replace(i.ValueAnnonymizerRegex,i.CharacterReplaceValue)}function s(e){return function(t,r){return r&&e&&e.indexOf(t)>-1?l(r):r}}t.serializeCell=function(e,t){return e&&t?(e.CachedStyle=o.getReferencedObjectToCache(e.StyleID,t.Styles),e.CachedBorderStyle=o.getReferencedObjectToCache(e.BorderStyleID,t.BorderStyles),e.CachedFont=o.getReferencedObjectToCache(e.CachedStyle.FontID,t.Fonts),a?JSON.stringify(e,s(a)):JSON.stringify(e)):""},t.serializeModel=function(e){return e?a?JSON.stringify(e,s(a)):JSON.stringify(e):""},t.annonymize=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(6);t.updateNumFmtFromCell=function(e){var t,r,o,a;if(n.verifyArgumentNotNull(e.Text,"cell.Text","updateNumFmt"),n.verifyArgumentNotNull(e.NumFmt,"cell.NumFmt","updateNumFmt"),!i.isNullOrUndefined(e.NumFmt.End)&&!i.isNullOrUndefined(e.NumFmt.Separator)){var l=function(e,t){for(var r=0,n=0;n<e.length&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),s=function(e,t){for(var r=0,n=e.length-1;n>0&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),u=function(e,t,r){var n=e.length-t,i=e.substring(0,n),o=i.lastIndexOf(r);if(-1===o)return i;return i.substr(o+1)}(e.Text,s,e.NumFmt.Separator);e.NumFmt.End=function(e,t,r,n){return t.repeat(r)+e+t.repeat(n)}(u,e.NumFmt.Separator,l,s),(null===(t=null==e?void 0:e.Text)||void 0===t?void 0:t.endsWith((null===(r=e.NumFmt)||void 0===r?void 0:r.Separator)+e.NumFmt.End))&&(null===(o=null==e?void 0:e.Text)||void 0===o?void 0:o.startsWith((null===(a=e.NumFmt)||void 0===a?void 0:a.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(37),o=r(1),a=r(54),l=r(55),s=r(87),u=function(e){function t(){var t=e.call(this)||this;return t.isHitMapSorted=!0,t.isRegisteredToEvents=!1,t.isListeningToPointerMove=!1,t.lastPointerPosition=a.OutsideCanvasPoint,t.lastCursorType=a.DefaultCursorType,t.zoom=1,t.registeredEventsHitRegions={},t.setDefaultHitMapAxes(),t.pointerDownEventHandler=t.onPointerDown.bind(t),t.pointerUpEventHandler=t.onPointerUp.bind(t),t.pointerMoveEventHandler=t.onPointerMove.bind(t),t.clickEventHandler=t.onClick.bind(t),t.mouseEnterEventHandler=t.onMouseEnter.bind(t),t.mouseLeaveEventHandler=t.onMouseLeave.bind(t),t.touchStartEventHandler=t.onTouchStart.bind(t),t}return n.__extends(t,e),t.prototype.addRegionEventListener=function(e){this.cacheRegionAndRegisterEvents(e,e.eventType)},t.prototype.removeAllEventListeners=function(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&this.canvas.removeEventListener("click",this.clickEventHandler),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.isRegisteredToLeaveEnter()&&(this.canvas.removeEventListener("mouseleave",this.mouseLeaveEventHandler),this.canvas.removeEventListener("mouseenter",this.mouseEnterEventHandler)),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)},t.prototype.addCursorRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.CursorEventType)},t.prototype.dispose=function(){this.removeAllEventListeners(),e.prototype.dispose.call(this)},t.prototype.setHitMapOffsets=function(e,r){if(e.length>a.MaxHitMapOffsetCount||r.length>a.MaxHitMapOffsetCount)throw Error("setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: "+e.length+", y: "+r.length);var n=t.doOffsetsHaveEqualDistances(e),i=t.doOffsetsHaveEqualDistances(r);this.hitMapAxisX={areOffsetsEqual:n,equalOffsetsSize:t.getFirstOffsetSize(e,this.canvas.width),offsets:e},this.hitMapAxisY={areOffsetsEqual:i,equalOffsetsSize:t.getFirstOffsetSize(r,this.canvas.height),offsets:r}},t.prototype.optimizeHitMapLookup=function(){this.isHitMapSorted||this.sortHitMap()},t.prototype.setAppZoom=function(e){this.zoom=e},t.prototype.setDimensions=function(t,r,n){e.prototype.setDimensions.call(this,t,r,n),this.setDefaultHitMapAxes()},t.prototype.getHitMapOffsetsX=function(){return this.hitMapAxisX},t.prototype.getHitMapOffsetsY=function(){return this.hitMapAxisY},t.prototype.getAppZoom=function(){return this.zoom},t.prototype.getIsHitMapSorted=function(){return this.isHitMapSorted},t.prototype.getEventTypeRegisteredEventsHitRegions=function(e){return this.registeredEventsHitRegions[e]},t.prototype.getIntersectingHitMapAreasKeys=function(e){for(var r=t.getOffsetPosition(e.x,this.hitMapAxisX),n=t.getOffsetPosition(e.x+e.width,this.hitMapAxisX),i=t.getOffsetPosition(e.y,this.hitMapAxisY),o=t.getOffsetPosition(e.y+e.height,this.hitMapAxisY),a=[],l=r;l<=n;l++)for(var s=i;s<=o;s++)a.push(t.getHitMapAreaKeyFromOffsetPosition(l,s));return a},t.getHitMapAreaKeyFromOffsetPosition=function(e,t){return e<<a.HitMapKeyXShift+t},t.getOffsetPosition=function(e,t){if(t.areOffsetsEqual)return Math.floor(e/t.equalOffsetsSize);var r=o.binarySearch(t.offsets,0,t.offsets.length,e,o.numbersComparer);return r<0?~r-1:r},t.doOffsetsHaveEqualDistances=function(e){if(e.length<2)return!0;for(var t=e[1],r=2;r<e.length;r++)if(e[r]-e[r-1]!==t)return!1;return!0},t.getDefaultHitMapAxis=function(e){for(var t=Math.floor(e/a.DefaultHitMapSectionsCount),r=[],n=0;n<a.DefaultHitMapSectionsCount;n++)r.push(n*t);return{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:r}},t.getFirstOffsetSize=function(e,t){return e.length<2?t:e[1]},t.prototype.onPointerDown=function(e){return this.onBasicPointerEvent(e,"pointerdown",this.pointerDownEventHandler)},t.prototype.onPointerUp=function(e){return this.onBasicPointerEvent(e,"pointerup",this.pointerUpEventHandler)},t.prototype.onClick=function(e){return this.onBasicPointerEvent(e,"click",this.clickEventHandler)},t.prototype.onTouchStart=function(e){return this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)},t.prototype.onBasicPointerEvent=function(e,t,r){var n=this;return s.trackEventCallbackDuration((function(){return n.isEventHasRegisteredHandlers(t)?n.handleBasicPointerEvents(t,e):(n.canvas.removeEventListener(t,r),!0)}),t)},t.prototype.onPointerMove=function(e){var t=this;s.trackEventCallbackDuration((function(){var r=t.getEventCoordinatesInCanvas(e.clientX,e.clientY);t.handlePointerMove(e,r)}),a.PointerMoveEvent)},t.prototype.onMouseEnter=function(e){var t=this;s.trackEventCallbackDuration((function(){t.canvas.addEventListener("pointermove",t.pointerMoveEventHandler),t.isListeningToPointerMove=!0;var r=t.getEventCoordinatesInCanvas(e.clientX,e.clientY);t.handlePointerMove(e,r)}),"mouseenter")},t.prototype.onMouseLeave=function(e){var t=this;s.trackEventCallbackDuration((function(){t.canvas.removeEventListener("pointermove",t.pointerMoveEventHandler),t.isListeningToPointerMove=!1,t.handlePointerMove(e,a.OutsideCanvasPoint)}),"mouseleave")},t.prototype.handleBasicPointerEvents=function(e,t){var r=l.getPointerEventCoordinates(t),n=this.getEventCoordinatesInCanvas(r.clientX,r.clientY),i=this.getIntersectingHitRegions(e,n);return this.propagateEventToHandlers(t,i,e,(function(){return!0}))},t.prototype.handlePointerMove=function(e,t){this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(t),this.lastPointerPosition=t},t.prototype.handleMouseLeaveEventTriggering=function(e,t){if(this.lastPointerPosition!==a.OutsideCanvasPoint){var r=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,r,"mouseleave",(function(e){return t===a.OutsideCanvasPoint||!o.isPointInRect(e.region,t)}))}},t.prototype.handleMouseEnterEventTriggering=function(e,t){var r=this;if(t===a.OutsideCanvasPoint){var n=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,n,"mouseenter",(function(e){return r.lastPointerPosition===a.OutsideCanvasPoint||!o.isPointInRect(e.region,r.lastPointerPosition)}))}},t.prototype.propagateEventToHandlers=function(e,t,r,n){for(var i=Number.MAX_SAFE_INTEGER,o=0;o<t.length;o++){var a=t[o];if(a.zIndex>i)throw Error("handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex="+i+", currentZIndex="+a.zIndex+", eventType: "+r+", totalHandlersCount="+t.length);if(n(a))if(a.callback(e))return e.stopPropagation(),e.preventDefault(),!1;i=a.zIndex}return!0},t.prototype.handleCursorType=function(e){var t=a.DefaultCursorType;if(e!==a.OutsideCanvasPoint){var r=this.getIntersectingHitRegions(a.CursorEventType,e);r&&r.length>0&&(t=r[0].cursorType)}this.lastCursorType!==t&&(this.lastCursorType=t,this.canvas.style.cursor=t)},t.prototype.cacheRegionAndRegisterEvents=function(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);var r=this.getEventHitAreaMap(t);this.addHitRegion(e,r)},t.prototype.registerHandlersForEvent=function(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(e,this.clickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"cursor":case"mouseenter":case"mouseleave":this.isRegisteredToLeaveEnter()||(this.canvas.addEventListener("mouseenter",this.mouseEnterEventHandler),this.canvas.addEventListener("mouseleave",this.mouseLeaveEventHandler))}this.isRegisteredToEvents=!0},t.prototype.getEventHitAreaMap=function(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]},t.prototype.addHitRegion=function(e,t){for(var r=this.getIntersectingHitMapAreasKeys(e.region),n=0;n<r.length;n++){var i=r[n];t[i]||(t[i]=[]),t[i].push(e)}this.isHitMapSorted=!1},t.prototype.getHitMapAreaKeyFromOffset=function(e,r){var n=t.getOffsetPosition(e,this.hitMapAxisX),i=t.getOffsetPosition(r,this.hitMapAxisY);return t.getHitMapAreaKeyFromOffsetPosition(n,i)},t.prototype.setDefaultHitMapAxes=function(){this.hitMapAxisX=t.getDefaultHitMapAxis(this.canvas.width),this.hitMapAxisY=t.getDefaultHitMapAxis(this.canvas.height)},t.prototype.getEventCoordinatesInCanvas=function(e,t){var r=Math.round(e/this.zoom),n=Math.round(t/this.zoom),i=this.canvas.getBoundingClientRect();return{x:r-i.x,y:n-i.y}},t.prototype.getIntersectingHitRegions=function(e,t){var r=[];if(this.registeredEventsHitRegions[e]){var n=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();var i=this.registeredEventsHitRegions[e][n];if(i&&i.length>0)for(var a=0;a<i.length;a++){var l=i[a];o.isPointInRect(l.region,t)&&r.push(l)}}return r},t.prototype.isEventHasRegisteredHandlers=function(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]},t.prototype.sortHitMap=function(){for(var e=Object.keys(this.registeredEventsHitRegions),t=0;t<e.length;t++)for(var r=this.registeredEventsHitRegions[e[t]],n=Object.keys(r),i=0;i<n.length;i++){var o=parseInt(n[i],10);r[o]=r[o].sort(l.hitRegionComparer)}this.isHitMapSorted=!0},t.prototype.isRegisteredToLeaveEnter=function(){return this.registeredEventsHitRegions.cursor||this.registeredEventsHitRegions.mouseenter||this.registeredEventsHitRegions.mouseleave},t}(i.RenderingCanvasElement);t.InteractableCanvasElement=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultHitMapSectionsCount=30,t.MaxHitMapOffsetCount=32,t.HitMapKeyXShift=5,t.CursorEventType="cursor",t.PointerMoveEvent="pointermove",t.OutsideCanvasPoint={x:-1,y:-1},t.DefaultCursorType="default",t.PointerCursorType="pointer"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);function i(e,t,r,i){if(0===i&&r===e.length-1)return e.slice(0);var o=e.slice(t,r+1);o[0]=0;for(var a=1;a<o.length;a++)o[a]=o[a]-i,o[a]<0&&(n.setRenderingResultWarning("getHitMapAxisOffsets: Unexpected input params: startOffsetPx: "+i+", startOffset: "+t+", offsets: "+e),o.splice(a,1),a--);return o}t.setHitMapOffsets=function(e,t,r){var n=i(t.ColumnOffsets,r.startColumn,r.endColumn,r.startOffsetX),o=i(t.RowOffsets,r.startRow,r.endRow,r.startOffsetY);e.setHitMapOffsets(n,o)},t.hitRegionComparer=function(e,t){return t.zIndex-e.zIndex},t.getPointerEventCoordinates=function(e){var t,r,n,i;return e instanceof MouseEvent?(n=e.clientX,i=e.clientY):(n=null===(t=e.touches)||void 0===t?void 0:t[0].clientX,i=null===(r=e.touches)||void 0===r?void 0:r[0].clientY),{clientX:n,clientY:i}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),i=r(3),o=r(22),a=r(41),l=r(10);t.fillTextUnclipped=function(e,t,r,n,i,a,l,s){e.fillText(t,r,n,i);var u={scaleFactor:s,textPositionX:r,textPositionY:n};o.measureAndCacheTextDecorationLayout(e,l,a,u)},t.fillTextClipped=function(e,t,r,s,u,d,c,g,f,p){if(i.applyClipping(e,d),!p&&l.isVerticalTextPresent(g,c))a.fillVerticalText(e,g,c,r,s,u,t.scaleFactor,d);else if(!p||f||c.DisplayFormula){e.fillText(r,s,u);var h={scaleFactor:t.scaleFactor,textPositionX:s,textPositionY:u,clipRect:d};o.measureAndCacheTextDecorationLayout(e,g,c,h)}else n.fillRichTextFormat(e,t,g,c,p,s,u,d);i.restoreClipping(e,d)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17);t.approximateValue=function(e,t){var r=Math.round(e);if(r<n.MinAllowedFontSize&&r>0&&(r=n.MinAllowedFontSize),r>n.MaxAllowedFontSize&&(r=n.MaxAllowedFontSize),r<0)throw Error("TextLayout.approximateValue: "+r+" in Excel must be between 1pt and 409pt");var i=t[r];if(i)return i;for(var o=r;o>n.MinAllowedFontSize&&!t[o];)o--;for(var a=r;a<n.MaxAllowedFontSize&&!t[a];)a++;return i=function(e,t,r,n,i){var o=(r-n)/(i-n)*(e-t);return Math.round(t+o)}(t[a],t[o],r,o,a),t[r]=i,i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:1,3:1,4:1,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(6),a=r(5),l=r(1),s=r(60),u=r(9),d=r(1),c={},g={};function f(e){l.verifyArgumentNotNull(e,"model","validateModel"),l.verifyArgumentNotNull(e.Cells,"model.Cells","validateModel"),l.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","validateModel"),l.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),l.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","validateModel"),l.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","validateModel")}function p(e,t){return{BorderLineStyle:n.BorderLineType.Thin,Color:t,Weight:a.ThinBorderWeight,BorderPosition:e}}function h(e,t,r,n,i,o){var a=v(e,t,r.BorderPosition,n),l=b(r);l in o||(i.push(r),o[l]=[]),o[l].push(a)}function m(e,t,r,i,o){var l=[],s="",u=a.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=a.ThinBorderWeight}(e),e.beginPath();for(var d=0;d<t.length;d++){var c=t[d],g=o||x(c.Color),f=I(c.BorderLineStyle),p=u!==c.Weight*i,h=s!==g,m=!n.areArraysEqual(l,f,[]).isEqual;(p||h||m)&&(e.stroke(),e.beginPath(),p&&(u=c.Weight*i,e.lineWidth=u),h&&(s=g,e.strokeStyle=g),m&&(e.setLineDash(f),l=f));for(var v=r[b(c)],y=0;y<v.length;y++){var T=v[y];C(e,c.Weight,T,i)}}e.stroke()}function C(e,t,r,n){!function(e){return e.Y1===e.Y2}(r)?i.drawLine(e,w(r.X1,t,n),r.Y1-n,w(r.X2,t,n),r.Y2):i.drawLine(e,r.X1-n,w(r.Y1,t,n),r.X2,w(r.Y2,t,n))}function v(e,t,r,i){if(!e.IsRtl){var o=F(e,t,r)?a.GridLineWidthPx:i;return y(r,{X:u.getCellLeftAdjustedForDrawing(e,t,!1),Y:u.getCellTopAdjustedForDrawing(e,t)},{X:u.getCellRightAdjustedForDrawing(e,t)+o,Y:u.getCellBottomAdjustedForDrawing(e,t)})}var l=F(e,t,r)?i-a.GridLineWidthPx:0,s=y(r,{X:u.getCellRightAdjustedForDrawing(e,t)+i,Y:u.getCellTopAdjustedForDrawing(e,t)},{X:u.getCellLeftAdjustedForDrawing(e,t,!1)+l,Y:u.getCellBottomAdjustedForDrawing(e,t)});if(r===n.BorderPositionType.Top||r===n.BorderPositionType.Bottom){var d=s.X2;s.X2=s.X1,s.X1=d}return s}function y(e,t,r){switch(e){case n.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:r.X,Y2:t.Y};case n.BorderPositionType.Bottom:return{X1:t.X,Y1:r.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Right:return{X1:r.X,Y1:t.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:r.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function T(e){switch(e){case n.BorderLineType.Thin:case n.BorderLineType.Medium:case n.BorderLineType.Hair:case n.BorderLineType.Thick:return!0;default:return!1}}function S(e,t,r){return r.Row===t.RowNumbers.length-1||r.Col===t.ColumnNumbers.length-1||(!!F(t,r,e)||(r.HasError?O(e):e===n.BorderPositionType.Top||e===n.BorderPositionType.Left))}function F(e,t,r){return!(!t.Merge&&!l.isCellAdjacentToMergedCell(t.Row,t.Col,e))&&O(r)}function w(e,t,r){var n=l.getLinePixelTranslation(r);return t===a.MediumBorderWeight&&r%2==1?e:e-n}function x(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,r=c[t];return o.isNullOrUndefined(r)?(r="rgb("+e.Red+","+e.Green+","+e.Blue+")",c[t]=r,r):r}function b(e){return x(e.Color)+"-"+e.Weight+"-"+e.BorderLineStyle}function I(e){var t=g[e];if(!o.isNullOrUndefined(t))return t;switch(e){case n.BorderLineType.Dotted:t=a.DottedLineDash;break;case n.BorderLineType.DashDot:case n.BorderLineType.MediumDashDot:t=a.DashedDotLineDash;break;case n.BorderLineType.DashDotDot:case n.BorderLineType.MediumDashDotDot:t=a.DashedDotDotLineDash;break;case n.BorderLineType.MediumDashed:t=a.MediumDashedLineDash;break;case n.BorderLineType.SlantDashDot:case n.BorderLineType.Dashed:t=a.DashedLineDash;break;default:t=[]}return g[e]=t,t}function R(e){return e.HasError?a.FormulaErrorBorderStyle:e.CachedBorderStyle}function O(e){return e<=n.BorderPositionType.Right}t.clearGridLinesForBorder=function(e,t,r){if(t.ShowGridLines&&i.shouldRenderGridLines(l.isHighContrastMode(r),l.hasWorkbookBackgroundColor(t.BackgroundColor))){f(t),s.setContextForClearingGridLine(e,r,t.BackgroundColor);var o=t.Cells;e.beginPath();for(var u=0;u<o.length;u++){var d=o[u],c=R(d);if(i.cellIntersectsRenderingRegion(d,r.renderingRegion)&&(c&&c.Borders&&0!==c.Borders.length&&!d.CachedStyle.BackgroundColor))for(var g=c.Borders,p=0;p<g.length;p++){var h=g[p];h.BorderLineStyle!==n.BorderLineType.None&&(T(h.BorderLineStyle)||S(h.BorderPosition,t,d)&&C(e,a.ThinBorderWeight,v(t,d,h.BorderPosition,a.GridLineWidthPx),a.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,r){f(t);var o,a,s=i.getDefaultBorderLineWidth(r.scaleFactor),u=l.getWorkbookBackgroundColor(r.highContrastScheme,t.BackgroundColor),c=function(e,t,r,o){for(var a={},l=[],s=[],u={},d=e.Cells,c=0;c<d.length;c++){var g=d[c],f=R(g);if((i.cellIntersectsRenderingRegion(g,o.renderingRegion)||(F=g,w=o.renderingRegion,x=void 0,b=void 0,x=F.Col===w.endColumn+1&&F.Row>=w.startRow&&F.Row<=w.endRow,b=F.Row===w.endRow+1&&F.Col>=w.startColumn&&F.Col<=w.endColumn,x||b))&&(f&&f.Borders&&0!==f.Borders.length))for(var m=f.Borders,C=0;C<m.length;C++){var v=m[C];if(v.BorderLineStyle!==n.BorderLineType.None&&S(v.BorderPosition,e,g)){if(v.BorderLineStyle===n.BorderLineType.Double){var y=g.CachedStyle.BackgroundColor?i.hexToRgb(g.CachedStyle.BackgroundColor):r,T=p(v.BorderPosition,y);h(e,g,T,t,s,u)}h(e,g,v,t,l,a)}}}var F,w,x,b;return{distinctBorderTypes:l,borderTypeToLineMap:a,distinctClearingDoubleBorderTypes:s,clearingDoubleBordersToLineMap:u}}(t,s,i.hexToRgb(u),r);r.highContrastScheme?(a=d.rgbToColorHex(r.highContrastScheme.TextColor),o=d.rgbToColorHex(r.highContrastScheme.BackgroundColor),m(e,c.distinctBorderTypes,c.borderTypeToLineMap,s,a),m(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,s,o)):(m(e,c.distinctBorderTypes,c.borderTypeToLineMap,s,void 0),m(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,s,void 0))},t.getBorderPriorityByLineStyle=function(e){switch(e){case n.BorderLineType.Thick:return 1;case n.BorderLineType.Medium:return 2;case n.BorderLineType.MediumDashed:return 3;case n.BorderLineType.MediumDashDot:return 4;case n.BorderLineType.Thin:return 5;case n.BorderLineType.Dashed:return 6;case n.BorderLineType.Dotted:return 7;case n.BorderLineType.DashDot:return 9;case n.BorderLineType.DashDotDot:return 10;case n.BorderLineType.Hair:return 11;case n.BorderLineType.Double:default:return 12}},t.cellHasBottomDoubleBorder=function(e,t){l.verifyArgumentNotNull(e,"cell","cellHasBottomDoubleBorder");var r=l.getCell(e.Row+1,e.Col,t);if(o.isNullOrUndefined(r)||o.isNullOrUndefined(r.CachedBorderStyle)||o.isNullOrUndefined(r.CachedBorderStyle.Borders))return!1;for(var i=r.CachedBorderStyle.Borders,a=0;a<i.length;a++){var s=i[a];if(s.BorderPosition===n.BorderPositionType.Top&&s.BorderLineStyle===n.BorderLineType.Double)return!0}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=r(3),a=r(29),l=r(6),s=r(9),u=r(5),d=r(32);function c(e,t,r){var n=i.getWorkbookBackgroundColor(t.highContrastScheme,r);e.strokeStyle=n,e.lineWidth=u.GridLineWidthPx,e.setLineDash(u.DefaultDash)}function g(e,t,r,n,i){var l=e.Col,d=e.Col,c=r.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(d+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(d=c.length-1)):e.Spill&&(l-=e.Spill.SpanToStart,d+=e.Spill.SpanToEnd),l=Math.max(0,l),d=Math.min(r.ColumnNumbers.length,d);for(var g=s.getCellHeightAdjustedForDrawing(r,e),f=s.getCellTopAdjustedForDrawing(r,e),p=g-u.GridLineWidthPx,h=l;h<d;h++){var m=a.getAdjustedDrawingOffset(c[h],o.getColWidthFromOffsets(h,c),n,i);o.drawLine(t,m,f,m,f+p)}}function f(e,t,r,n,i){var l=e.Row,d=e.Row+e.Merge.Rows,c=r.ClientOnlyCache.RowOffsetsAdjustedForDrawing;l=Math.max(0,l),d=Math.min(r.RowNumbers.length,d),e.Merge.SpansNextBlockVertically&&(d=c.length-1);for(var g=s.getCellLeftAdjustedForDrawing(r,e,r.IsRtl),f=s.getCellWidthAdjustedForDrawing(r,e)-u.GridLineWidthPx,p=l;p<d;p++){var h=a.getAdjustedDrawingOffset(c[p],o.getRowHeightFromOffsets(p,c),n,i);o.drawLine(t,g,h,g+f,h)}}t.clearGridLinesForSpannedCells=function(e,t,r){if(i.verifyArgumentNotNull(t,"model","clearGridLinesForText"),i.verifyArgumentNotNull(t.Cells,"model.Cells","clearGridLinesForText"),i.verifyArgumentNotNull(e,"ctx","clearGridLinesForText"),i.verifyArgumentNotNull(r,"context","clearGridLinesForText"),t.ShowGridLines&&o.shouldRenderGridLines(i.isHighContrastMode(r),i.hasWorkbookBackgroundColor(t.BackgroundColor))){var n=t.Cells,d=i.getLinePixelTranslation(u.GridLineWidthPx),p=a.getMaxLineOffset(t.BlockWidth,r.scaleFactor,!1),h=a.getMaxLineOffset(t.BlockHeight,r.scaleFactor,!0);c(e,r,t.BackgroundColor),e.beginPath();for(var m=0;m<n.length;m++){var C=n[m],v=!l.isNullOrUndefined(C)&&!l.isNullOrUndefined(C.Spill),y=!l.isNullOrUndefined(C)&&!l.isNullOrUndefined(C.Merge)&&(l.isNullOrUndefined(C.CachedStyle.BackgroundColor)||!l.isNullOrUndefined(r.highContrastScheme));o.cellIntersectsRenderingRegion(C,r.renderingRegion)&&((v||y)&&(g(C,e,t,d,p),y&&s.isCellSpansMultipleRowsOrBlocks(C)&&f(C,e,t,d,h)))}e.stroke()}},t.setContextForClearingGridLine=c,t.clearGridLinesForPivotTables=function(e,t,r){if(i.verifyArgumentNotNull(t,"model","clearGridLinesForEmptyPivotTables"),i.verifyArgumentNotNull(e,"ctx","clearGridLinesForEmptyPivotTables"),i.verifyArgumentNotNull(r,"context","clearGridLinesForEmptyPivotTables"),t.ShowGridLines&&o.shouldRenderGridLines(i.isHighContrastMode(r),i.hasWorkbookBackgroundColor(t.BackgroundColor))&&t.PivotTables&&0!==t.PivotTables.length){for(var a=n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,t,!0),s=!1,c=0;c<t.PivotTables.length;c++){var g=t.PivotTables[c];if((a||g.IsEmptyPivot)&&(g.HideGridLines&&(g.IsEmptyPivot||!l.isNullOrUndefined(g.RowHeaderRange))&&d.isPivotIntersectsRenderingRegion(t,g,r.renderingRegion,!0))){s||(e.fillStyle=i.getWorkbookBackgroundColor(r.highContrastScheme,t.BackgroundColor),e.beginPath(),s=!0);var f=d.getPivotTableLeftAdjustedForDrawing(t,g,t.IsRtl),p=d.getPivotTableTopAdjustedForDrawing(t,g,!0),h=g.OriginPTWidthAdjustedForDrawing-u.GridLineWidthPx,m=g.OriginPTHeightAdjustedForDrawing-u.GridLineWidthPx;e.rect(f,p,h,m)}}s&&e.fill()}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(n=t.CombiningClass||(t.CombiningClass={}));var i=0|n.Control|n.CR|n.LF,o=0|n.L|n.V|n.LV|n.LVT,a=0|n.V|n.LV,l=0|n.V|n.T,s=0|n.LVT|n.T;function u(e,t){return 0!=(e&t)}t.shouldBreak=function(e,t){return(e!==n.CR||t!==n.LF)&&(!!u(i,e)||(!!u(i,t)||(e!==n.L||!u(o,t))&&((!u(a,e)||!u(l,t))&&((!u(s,e)||t!==n.T)&&((e!==n.Regional_Indicator||t!==n.Regional_Indicator)&&(t!==n.Extend&&t!==n.ZWJ&&(t!==n.SpacingMark&&e!==n.Prepend)))))))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);t.getVerticalTextPadding=function(e){return n.getIndentationPaddingPx(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(19),o=r(10),a=r(41),l=r(15),s=r(9),u=r(8),d=r(11);t.drawTextLine=function(e,t,r,n,l,s,u,d,c,g,f,p,h){g?i.fillRichTextFormat(e,t,r,n,g,u,d,f,p,h):o.isVerticalTextPresentSlice2(r,n)?a.fillVerticalText(e,r,n,s,u,d,t.scaleFactor,f,c):l?e.fillText(s,u,d):e.fillText(s,u,d,c)},t.adjustOrderingOfLinesForVerticalText=function(e,t,r){var i;(null===(i=e.CachedStyle)||void 0===i?void 0:i.ReadingOrder)!==n.ReadingOrderType.RightToLeft&&r.HasLtr&&!r.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())},t.getOffsetXForVerticalText=function(e,t,r,i,a){return function(e,t,r,i,o){switch(l.getEffectiveHorizontalAlignment(e,t)){case n.HorizontalAlignment.Right:return r-i*(o-1);case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:return r-i*(o-1)/2;default:case n.HorizontalAlignment.Left:return r}}(e,t,function(e,t,r,i){var a;if(1===i&&o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(e,t)){var l=u.getCellTextHorizontalPadding(t,e);switch(null===(a=t.CachedStyle)||void 0===a?void 0:a.HorizontalAlignment){case n.HorizontalAlignment.Distributed:return u.getCellTextCenterX(e,t);case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.JustifyDistributed:return s.getCellLeft(e,t,e.BlockWidth)+l}}return r}(e,t,r,a),i,a)},t.getSpaceWidthBetweenLines=function(e,t,r,n,i){if(!o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(e,t)||1===n)return 0;var a=d.getCellRightVisualElementsPadding(e,t),l=r,c=s.getCellRight(e,t,e.BlockWidth)-u.getCellTextHorizontalPaddingWithoutVisualElements(e,t)-a-l-i*(n-1);return c<0?0:c/(n-1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(2),o=r(15),a=r(10),l=r(1),s=r(11),u=r(8);function d(e,t,r){if(l.verifyArgumentNotNull(r,"cell","spillCell.updateCellSpill"),l.verifyArgumentNotNull(t,"model","spillCell.updateCellSpill"),!(!r.Text||r.WrapText||r.Merge||l.cellHasShrinkToFit(r)||r.ValueType===i.CellValueType.Number||a.isVerticalTextPresent(t,r))){e.font=l.getFontCssStringFromCell(r,t);var o=u.getTextWidth(e,t,r),s=c(r,t,o,n.End),d=c(r,t,o,n.Start),g=s.isSpillingOutsideOfBlock||d.isSpillingOutsideOfBlock,h=i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,t)&&(s.isBlockedByCellContent||d.isBlockedByCellContent);if(0!==s.spilledOverCellsCount||0!==d.spilledOverCellsCount){var m=f(r,t,n.Start),C=f(r,t,n.End),v=p(m,r,t,n.Start),y=p(C,r,t,n.End);r.Spill={SpanToStart:Math.min(d.spilledOverCellsCount,v),SpanToEnd:Math.min(s.spilledOverCellsCount,y),IsSpillBlocked:g||d.spilledOverCellsCount>v||s.spilledOverCellsCount>y}}else(g||h)&&(r.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0})}}function c(e,t,r,n){var a=l.getCellStyle(e,t);l.verifyArgumentNotNull(a,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");var d=a.HorizontalAlignment,c=v(t,e,d,n);return c?function(e,t,r,n,a){var d=e.Col,c=function(e,t,r,n,a){var d=l.getColumnWidth(t.Col,e),c=function(e,t){var r;if(!i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,e,!0)||!(null===(r=t.PivotTable)||void 0===r?void 0:r.HasExpandCollapseIndicator))return!1;var n=o.getEffectiveHorizontalAlignment(e,t);return!u.doesExpandCollapseButtonShiftText(e,t)||n===i.HorizontalAlignment.Center}(e,t)?s.getExpandCollapseButtonPadding(e,t):0,g=u.getCellTextHorizontalPadding(t,e)+r+c-d;if(g<=0)return 0;if(n===i.HorizontalAlignment.Center)return g/2;var f=e.IsRtl;if(!C(n,a,f))return 0;return g}(t,e,r,n,a),f=0,p=!1;if(0===c)return{spilledOverCellsCount:f,isSpillingOutsideOfBlock:p,isBlockedByCellContent:!1};var h=t.ColumnNumbers.length;d+=a;for(;g(d,h)&&c>0;)f++,c-=l.getColumnWidth(d,t),d+=a;return p=!g(d,h)&&c>0,{spilledOverCellsCount:f,isSpillingOutsideOfBlock:p,isBlockedByCellContent:!1}}(e,t,r,d,n):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!c}}function g(e,t){return e>=0&&e<t}function f(e,t,r){for(var n=e.Row,i=e.Col+r;g(i,t.ColumnNumbers.length);){var o=l.getCell(n,i,t);if(o&&h(o))return o;i+=r}return null}function p(e,t,r,i){return e?Math.abs(e.Col-t.Col)-1:i===n.End?r.ColumnNumbers.length-t.Col:t.Col}function h(e){var t;return!(!e||!e.Text&&!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula))}function m(e,t,r,i,o){var a=p(t,r,i,o);if(t&&t.Spill){var s=l.getCellStyle(t,i);l.verifyArgumentNotNull(s,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");var u=s.HorizontalAlignment,c=-o;if(v(i,t,u,c)&&C(u,c,i.IsRtl))if(r&&r.Text){var g=o===n.End?t.Spill.SpanToStart:t.Spill.SpanToEnd;t.Spill.IsSpillBlocked=a<=g,o===n.End?t.Spill.SpanToStart=Math.min(g,a):t.Spill.SpanToEnd=Math.min(g,a)}else d(e,i,r)}return a}function C(e,t,r){return e===i.HorizontalAlignment.Center||(t===n.Start?r?e===i.HorizontalAlignment.Left:e===i.HorizontalAlignment.Right:t===n.End&&(e===i.HorizontalAlignment.Automatic||(r?e===i.HorizontalAlignment.Right:e===i.HorizontalAlignment.Left)))}function v(e,t,r,o){var a,l;return!i.isRenderFlagEnabled(i.RenderFlags.RichValueIcon,e)||o!==n.Start&&r!==i.HorizontalAlignment.Center?!i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,e,!0)||o!==n.Start||!(null===(l=t.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator):!(null===(a=t.LinkedEntity)||void 0===a?void 0:a.IconWidth)}t.updateCellSpill=d,t.updateClosestNonEmptyCellsSpill=function(e,t,r){var i=f(t,r,n.Start),o=f(t,r,n.End);m(e,i,t,r,n.Start),m(e,o,t,r,n.End)},function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.drawTriangle=function(e,t,r){n.verifyArgumentNotNull(e,"ctx","drawTriangle"),n.verifyArgumentNotNull(t,"drawingContext","drawTriangle");var i=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,u=t.width,d=a+u/2,c=r?l+s:l-s;e.strokeStyle=o,e.beginPath(),e.moveTo(a,l),e.lineTo(a+u,l),e.lineTo(d,c),e.closePath(),i&&(e.fillStyle=i,e.fill()),o&&(e.strokeStyle=o,e.stroke())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(18),a=r(16),l=r(21),s=r(34),u=r(14);function d(e,t,r,n,i,a,l){var s={left:t,bottom:r,outerColor:l,height:n,width:i,innerColor:a};o.drawRectangle(e,s)}t.drawSymbols=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawSymbols"),n.verifyArgumentNotNull(t,"drawingContext","drawSymbols");var r=t.image,c=t.highContrastScheme,g=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case i.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case i.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case i.CFIconImage.CircleSymbolHigh:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = "+e)}}(r,c),f=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = "+e)}}(r,c);switch(r){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:!function(e,t,r,n){var o,a=t.size,s=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolHigh:var g=s+u.ShapeLinesAdjustment;o=function(e,t,r){var n=t-r,o=e+i.CheckMarkMiddleXRatio*r,a={x:e+i.CheckMarkTopLeftXRatio*r,y:i.CheckMarkTopLeftYRatio*r+n},l={x:e+i.CheckMarkTopMiddleXRatio*r,y:i.CheckMarkTopMiddleYRatio*r+n},s={x:o,y:i.CheckMarkBottomYRatio*r+n},u={x:e+r,y:i.CheckMarkMiddleRightYRatio*r+n},d={x:e+i.CheckMarkTopRightXRatio*r,y:i.CheckMarkTopRightYRatio*r+n},c={x:o,y:i.CheckMarkMiddleYRatio*r+n};return[a,l,s,u,d,c,a]}(g,d,a);break;case i.CFIconImage.CircleSymbolHigh:o=function(e,t,r){var n=t-r,o=e+i.CircledCheckMarkMiddleXRatio*r,a={x:e+i.CircledCheckMarkTopLeftXRatio*r,y:i.CircledCheckMarkTopLeftYRatio*r+n},l={x:e+i.CircledCheckMarkTopMiddleXRatio*r,y:i.CircledCheckMarkTopMiddleYRatio*r+n},s={x:o,y:i.CircledCheckMarkBottomYRatio*r+n},u={x:e+i.CircledCheckMarkMiddleRightXRatio*r,y:i.CircledCheckMarkMiddleRightYRatio*r+n},d={x:e+i.CircledCheckMarkTopRightXRatio*r,y:i.CircledCheckMarkTopRightYRatio*r+n},c={x:o,y:i.CircledCheckMarkMiddleYRatio*r+n};return[a,l,s,u,d,c,a]}(s,d,a);break;default:throw Error("drawCheckMark: unsupported image type = "+c)}l.drawIconFromPoints(e,r,n,o)}(e,t,g,f);break;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:!function(e,t,r,n){var a=t.image;switch(a){case i.CFIconImage.SymbolMedium:!function(e,t,r,n){var a=t.size,l=t.left,s=t.bottom,u=Math.floor(a*i.ExclamationMarkTopRectHeightSizeRatio),c=Math.floor(a*i.ExclamationMarkBottomRectHeightSizeRatio),g=Math.floor(a*i.ExclamationMarkWidthRectSizeRatio),f=u+Math.max(i.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(i.ExclamationMarkSpaceBetweenRectanglesRatio*a)),p=Math.floor(i.ExclamationMarkLeftRectanglePaddingRatio*a),h=l+p;d(e,h,s-(a-u),u,g,r,n),function(e,t,r,n,i,a,l,s,u){var d={left:t,bottom:r-(n-u-i),outerColor:s,height:i,width:a,innerColor:l};o.drawRectangle(e,d)}(e,h,s,a,c,g,r,n,f)}(e,t,r,n);break;case i.CFIconImage.CircleSymbolMedium:!function(e,t,r,n){var o=t.size,a=t.left,l=t.bottom,c=t.image,g=o-2*i.CircledExclamationMarkPaddingFromCircle,f=Math.floor(g*i.CircledExclamationMarkTopRectHeightSizeRatio),p=function(e){var t=Math.floor(e*i.CircledExclamationMarkWidthRectSizeRatio);return t%2==0?t-1:t}(f),h=a+o/2,m=Math.round(h-(p+1)/2),C=l-i.CircledExclamationMarkPaddingFromCircle,v=function(e){var t=Math.floor(e*i.CircledExclamationMarkLeftCircleSizeRatio);return t%2==0?t:t-1}(g),y=function(e,t,r){return e+u.ShapeLinesAdjustment-(t-r)/2}(m,v,p),T={image:c,bottom:C,highContrastScheme:void 0,left:y,size:v},S=Math.floor(l-i.CircledExclamationMarkPaddingFromCircle-(v+1));d(e,m,S,f,p,r,n),s.drawCircle(e,T,n,r)}(e,t,r,n);break;default:throw Error("drawExclamationMark: unsupported image type = "+a)}}(e,t,g,f);break;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:!function(e,t,r,n){var o,a=t.size,s=t.left,d=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolLow:var g=s+u.ShapeLinesAdjustment;o=function(e,t,r){var n=t-r,o=i.CrossMarkOuterSmallPaddingRatio*r,a=o+e,l=o+n,s=i.CrossMarkOuterBigPaddingRatio*r,u=s+e,d=s+n,c=i.CrossMarkInnerSmallPaddingRatio*r,g=c+e,f=c+n,p=i.CrossMarkInnerCenterRatio*r,h=p+e,m=p+n,C=i.CrossMarkInnerBigPaddingRatio*r,v={x:a,y:n};return[v,{x:e,y:l},{x:g,y:m},{x:e,y:d},{x:a,y:r+n},{x:h,y:C+n},{x:u,y:r+n},{x:e+r,y:d},{x:e+C,y:m},{x:e+r,y:l},{x:u,y:n},{x:h,y:f},v]}(g,d,a);break;case i.CFIconImage.CircleSymbolLow:o=function(e,t,r){var n=(S=r,S%2==1?S+1:S),o=t-r,a=i.CircledCrossMarkOuterSmallPaddingRatio*n,l=a+e,s=a+o,u=i.CircledCrossMarkOuterBigPaddingRatio*n,d=u+e,c=u+o,g=i.CircledCrossMarkInnerSmallPaddingRatio*n,f=g+e,p=g+o,h=i.CircledCrossMarkInnerCenterRatio*n,m=h+e,C=h+o,v=i.CircledCrossMarkInnerBigPaddingRatio*n,y=i.CircledCrossMarkPaddingFromCircleRatio*n,T={x:l,y:o+y};var S;return[T,{x:e+y,y:s},{x:f,y:C},{x:e+y,y:c},{x:l,y:n+o-y},{x:m,y:v+o},{x:d,y:n+o-y},{x:e+n-y,y:c},{x:e+v,y:C},{x:e+n-y,y:s},{x:d,y:o+y},{x:m,y:p},T]}(s,d,a);break;default:throw Error("drawCrossMark: unsupported image type = "+c)}l.drawIconFromPoints(e,r,n,o)}(e,t,g,f);break;default:throw Error("drawSymbols: unsupported image type = "+r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(9),o=r(5);t.getClipRect=function(e,t,r,a,l){if(function(e,t,r,a,l){var s,u=i.getCellBottomAdjustedForDrawing(e,t)-o.GridLineWidthPx;if(a>=u)return!0;var d=i.getCellTopAdjustedForDrawing(e,t);if(a-l<=d)return!0;var c=e.IsRtl,g=n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)&&(null===(s=t.PivotTable)||void 0===s?void 0:s.HasExpandCollapseIndicator)&&t.Spill,f=g?i.getSpillCellLeftAdjustedForDrawing(e,t):i.getCellLeftAdjustedForDrawing(e,t,c);if(r<=f)return!0;var p=g?i.getSpillCellRightAdjustedForDrawing(e,t):i.getCellRightAdjustedForDrawing(e,t)-o.GridLineWidthPx;if(r+l>=p)return!0;return!1}(e,t,r,a,l))return{x:i.getCellLeftAdjustedForDrawing(e,t,!1),y:i.getCellTopAdjustedForDrawing(e,t),width:i.getCellWidthAdjustedForDrawing(e,t)-o.GridLineWidthPx,height:i.getCellHeightAdjustedForDrawing(e,t)-o.GridLineWidthPx}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),o=r(1);function a(e){return o.isHighContrastMode(e)?n.HighContrastPageLayoutWidthPx:n.GridLineWidthPx}t.setPageLayoutLine=function(e,t){e.lineWidth=a(t),e.setLineDash(n.DefaultDash),e.strokeStyle=i.isNullOrUndefined(t.highContrastScheme)?n.PageLayoutLineColor:""+o.rgbToColorHex(t.highContrastScheme.TextColor)},t.getLineWidth=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoFilterColor="#3A3A38",t.AutoFilterPaddingBottomPx=1,t.AutoFilterHorizontalPaddingPx=1,t.AutoFilterDefaultSizePx=17,t.AutoFilterLineWidthPx=1,t.AutoFilterBorderColor="gray",t.AutoFilterBackgroundColor="white",t.AutoFilterStrokeColor="black",t.AutoFilterIconRectPx=16,t.AutoFilterRectRadius=2,t.AutoFilterDrawingThresholdPx=3;t.ChevronPoints=[{x:5,y:6},{x:8,y:9},{x:11,y:6}];t.MiniChevronPoints=[{x:3,y:9},{x:5,y:11},{x:7,y:9}];var n={x:8,y:3};t.FilterPoints=[n,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},n],t.ArrowLengthPx=8,t.ArrowTipWidthPx=3,t.LeftArrowPosition={x:4,y:3},t.RightArrowPosition={x:11,y:3}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,o=r(30),a=r(43),l=r(137),s=r(0),u=[],d=!1;function c(){for(var e=a.getCurrentTimeInMs();a.getCurrentTimeInMs()-e<n&&u.length>0&&!g();){var t=Math.floor(Math.random()*u.length),r=u[t],o=a.getCurrentTimeInMs();if(r.canExecuteTest())try{var l=r.executeTest();l.isValid&&s.ULS.sendTraceTag(574166413,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Info,"Suite: "+r.getSuiteName()+", Name: "+r.getTestName()+", Results: "+l);var d=a.getCurrentTimeInMs()-o;d>n&&(s.ULS.sendTraceTag(573961116,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Info,"Suite: "+r.getSuiteName()+", Name: "+r.getTestName()+" is disabled because it exceeded execution threshold.\n            Threshold: "+n+", TimeTaken: "+d),r.disable())}catch(e){s.ULS.sendTraceTag(574166414,s.LogCategory.msoulscat_ES_EWAJSGrid,s.TraceLevel.Info,"Suite: "+r.getSuiteName()+", Name: "+r.getTestName()+", Exception encountered in test, Test will be disabled. Exception - "+e),r.disable()}u.splice(t,1)}u.length<1&&i.stopTracking()}function g(){return!(!navigator.scheduling||!navigator.scheduling.isInputPending)&&navigator.scheduling.isInputPending()}t.initPassiveTests=function(){if(!d){n=o.getServiceSetting(3,25);var e=o.getServiceSetting(6,1e4);i=new l.IdleTracker({onReportUserIsIdle:function(){window.requestIdleCallback?window.requestIdleCallback(c):setTimeout(c,0)}},e),u.length>0&&i.startTrackingIfApplicable(),d=!0}},t.registerPassiveTest=function(e){u.push(e),d&&i.startTrackingIfApplicable()}},function(e,t,r){"use strict";var n,i=function(){function e(e){this.logger=e}return e.prototype.start=function(){this.logger.logNullJSCPUProfilerStartCalled()},e.prototype.stop=function(){this.logger.logNullJSCPUProfilerStopCalled()},e}(),o=function(){function e(){}return e.prototype.getCurrentTimestamp=function(){return window.performance.now()},e}(),a=function(){function e(e,t,r){return this.performanceTimestampRetriever=t,this.logger=r,this.startTimestamp=-1,this.stopTimestamp=-1,e.isWindowDefined()?e.isWindowPerformanceDefined()?e.isWindowPerformanceNowDefined()?void(this.unsupportedEnvironment=!1):(this.logger.logWindowPerformanceNowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logWindowPerformanceMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logWindowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0))}return e.prototype.start=function(){this.unsupportedEnvironment?this.logger.logStopWatchStartingInUnsupportedEnvironment():this.startTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.stop=function(){this.unsupportedEnvironment?this.logger.logStopWatchStoppingInUnsupportedEnvironment():this.stopTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.getElapsedTime=function(){if(-1===this.startTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStart(),-1;if(-1===this.stopTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStop(),-1;var e=this.stopTimestamp-this.startTimestamp;return this.resetTimestamps(),e},e.prototype.resetTimestamps=function(){this.startTimestamp=-1,this.stopTimestamp=-1},e}(),l=r(0),s=function(){function e(){}return e.prototype.logWindowMissingInJSEnvironment=function(){l.ULS.sendTraceTag(579110676,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find window in the JS environment")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){l.ULS.sendTraceTag(579110677,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPerformanceNowMissingInJSEnvironment=function(){l.ULS.sendTraceTag(579110678,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find window.performance.now in the JS environment")},e.prototype.logStopWatchStartingInUnsupportedEnvironment=function(){l.ULS.sendTraceTag(579110679,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Starting the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logStopWatchStoppingInUnsupportedEnvironment=function(){l.ULS.sendTraceTag(579110680,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Stopping the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logGetElapsedTimeCalledWithoutCallingStart=function(){l.ULS.sendTraceTag(579110683,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Stopwatch needs to be started before you can get elapsed time")},e.prototype.logGetElapsedTimeCalledWithoutCallingStop=function(){l.ULS.sendTraceTag(579110684,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Stopwatch needs to be stopped before you can get elapsed time")},e}(),u=function(){function e(){}return e.prototype.isWindowDefined=function(){return null!=window},e.prototype.isWindowPerformanceDefined=function(){return"performance"in window},e.prototype.isWindowPerformanceNowDefined=function(){return"now"in window.performance},e}(),d=function(){function e(){}return e.createNewStopWatch=function(){var e=new s,t=new u,r=new o;return new a(t,r,e)},e}(),c=function(){function e(){}return e.prototype.logOperation=function(e,t,r,n,i,o,a,s){var u={};a.forEach((function(e,t){u[t]=e})),l.ULS.sendTraceTag(578958171,l.LogCategory.msoulscat_Wac_Telemetry,i?l.TraceLevel.Error:l.TraceLevel.Info,JSON.stringify({operationName:e,parentOperationName:t,didOperationSucceed:r,measuredRunTime:n,logs:o,properties:u,exception:s}))},e.prototype.logFallbackResultReturned=function(){l.ULS.sendTraceTag(578090845,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Fallback result is being returned")},e}(),g=new(function(){function e(){this.elements=[]}return e.prototype.push=function(e){this.elements.unshift(e)},e.prototype.pop=function(){return this.elements.shift()},e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e}()),f=function(){function e(e,t,r,n){var i=g.peek(),o=void 0!==i?i:"";g.push(e),this.logs=[],this.propertyBag=new Map;var a=d.createNewStopWatch();a.start();var l=void 0,s=!1;try{s=(l=t(this)).didOperationFailUnexpectedly}catch(e){this.exception=e,s=!0}this.operationResult=void 0!==l?l:r,a.stop(),n.logOperation(e,o,this.operationResult.didOperationSucceed,a.getElapsedTime(),s,this.logs,this.propertyBag,this.exception),g.pop()}return e.prototype.addLog=function(e){this.logs.push(e)},e.prototype.addProperty=function(e,t){this.propertyBag.set(e,t)},e.prototype.getResult=function(){return this.operationResult.result},e.startNew=function(t,r,n){return new e(t,r,n,new c)},e}(),p=function(){function e(e,t,r){this.didOperationSucceed=e,this.didOperationFailUnexpectedly=t,this.result=r}return e.generateOperationResult=function(t){return new e(t.didOperationSucceed,null!=t.didOperationFailUnexpectedly&&t.didOperationFailUnexpectedly,t.result)},e}();!function(e){e.Chrome="chrome"}(n||(n={}));var h=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckWindowProperty",(function(){return null==window?(t.logger.logWindowMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0})):(t.logger.logWindowPropertyNameChecked(e),p.generateOperationResult({didOperationSucceed:!0,result:e in window}))}),r).getResult()},e}(),m=function(){function e(e){this.logger=e}return e.prototype.isBrowserChromiumBased=function(e){return function(e,t,r){var i=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckChromiumBrowser",(function(i){if(i.addProperty("UserAgent",e),0===e.localeCompare(""))return r.logEmptyUserAgentString(),p.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var o=e.match(/(Chrome\/|CriOS\/)/g);return null!=e.match(/(CriOS\/)/g)&&r.logChromiumOnIOS(),null===o?(r.logBrowserUserAgentNotChromiumBased(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):t.hasProperty(n.Chrome)?p.generateOperationResult({didOperationSucceed:!0,result:!0}):(r.logUserAgentSpoofedToBeChromium(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),i).getResult()}(e,new h(this.logger),this.logger)},e.prototype.parseChromeMajorVersionNumber=function(e){return function(e,t){var r=p.generateOperationResult({didOperationSucceed:!1,result:-1});return f.startNew("ParseChromiumMajorVersionNumber",(function(r){r.addProperty("UserAgent",e);var n=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==n)return t.logChromeNotPresentInUserAgent(),p.generateOperationResult({didOperationSucceed:!1,result:-1});var i=n[0].split("/");if(i.length<2)return t.logUnableToIsolateChromeInformationFromUserAgent(),p.generateOperationResult({didOperationSucceed:!1,result:-1});var o=i[1].split(".");if(o.length<4)return t.logUnableToExtractChromeVersionInformation(),p.generateOperationResult({didOperationSucceed:!1,result:-1});var a=o[0],l=parseInt(a,10);if(isNaN(l))return t.logUnableToParseChromeMajorVersionString(),p.generateOperationResult({didOperationSucceed:!1,result:-1});return r.addProperty("MajorVersionNumber",l),p.generateOperationResult({didOperationSucceed:!0,result:l})}),r).getResult()}(e,this.logger)},e}(),C=function(){function e(){}return e.prototype.logWindowMissingInJSEnvironment=function(){l.ULS.sendTraceTag(578834847,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Unable to find window in the JS environment")},e.prototype.logWindowPropertyNameChecked=function(e){l.ULS.sendTraceTag(578834848,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logEmptyUserAgentString=function(){l.ULS.sendTraceTag(578834850,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Empty user agent string")},e.prototype.logChromiumOnIOS=function(){l.ULS.sendTraceTag(578834851,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"iOS version of Chromium based browser detected")},e.prototype.logBrowserUserAgentNotChromiumBased=function(){l.ULS.sendTraceTag(578834880,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Browser not chromium based")},e.prototype.logUserAgentSpoofedToBeChromium=function(){l.ULS.sendTraceTag(578834881,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logUserAgentToParseChromiumMajorVersionNumber=function(e){l.ULS.sendTraceTag(578834882,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logChromeNotPresentInUserAgent=function(){l.ULS.sendTraceTag(578834883,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Chrome was not found in the user agent")},e.prototype.logUnableToIsolateChromeInformationFromUserAgent=function(){l.ULS.sendTraceTag(578834884,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to isolate chrome information from the user agent")},e.prototype.logUnableToExtractChromeVersionInformation=function(){l.ULS.sendTraceTag(578834885,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to extract chrome version information from the user agent")},e.prototype.logUnableToParseChromeMajorVersionString=function(){l.ULS.sendTraceTag(578834886,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to parse the chromium major version number")},e.prototype.logRequestIdleCallbackMissing=function(){l.ULS.sendTraceTag(576582740,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Unable to find window.requestIdleCallback in the JS environment")},e.prototype.logCallbackBeingInvokedImmediately=function(){l.ULS.sendTraceTag(576582743,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Callback is being invoked immediately as there is no platform support for deferring work")},e.prototype.logCancelIdleCallbackMissing=function(){l.ULS.sendTraceTag(576582744,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Unable to find window.cancelIdleCallback in the JS environment")},e.prototype.logUnknownMechanism=function(){l.ULS.sendTraceTag(576582747,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find a way to cancel the idle time job")},e.prototype.logWindowSetTimeOutMissingInJSEnvironment=function(){l.ULS.sendTraceTag(576239755,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"window.setTimeout is missing in JS environment")},e.prototype.logTimerJobDuration=function(e){l.ULS.sendTraceTag(576239756,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,""+e)},e.prototype.logTimerJobScheduled=function(){l.ULS.sendTraceTag(576239757,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Timer job was scheduled")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){l.ULS.sendTraceTag(576218121,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPerformanceNowMissingInJSEnvironment=function(){l.ULS.sendTraceTag(576218122,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to find window.performance.now in the JS environment")},e.prototype.logNavigatorMissingInJSEnvironment=function(){l.ULS.sendTraceTag(574657350,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Navigator is missing in the JS environment")},e.prototype.logSendBeaconNotSupported=function(){l.ULS.sendTraceTag(573970625,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"SendBeacon not supported in current environment")},e.prototype.logBeaconURLIsEmpty=function(){l.ULS.sendTraceTag(573919702,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"We were passed an empty URL for sendBeacon")},e.prototype.logBeaconDataIsEmpty=function(){l.ULS.sendTraceTag(573907718,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"We were passed an empty data for sendBeacon")},e.prototype.logDocumentMissingInJsEnvironment=function(){l.ULS.sendTraceTag(573572181,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Document is not present in JS Environment")},e.prototype.logDocumentVisibilityStateMissingInJsEnvironment=function(){l.ULS.sendTraceTag(573572182,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Document VisibilityState is not present in JS Environment")},e.prototype.logDocumentAddEventListenerMissingInJsEnvironment=function(){l.ULS.sendTraceTag(573572183,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Document AddEventListener is not present in JS Environment")},e}(),v=function(){function e(){}return e.getBrowserUtils=function(){var e=new C;return new m(e)},e}();var y,T=function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t}return e.prototype.scheduleJobForIdleTime=function(e){var t,r,n,i,o;t=function(){e()},r=this.windowPropertyChecker,n=this.logger,o=p.generateOperationResult({didOperationSucceed:!1,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}}),f.startNew("RequestIdleCallbackShim",(function(){if(r.hasProperty("requestIdleCallback")){var e=window.requestIdleCallback(t,i);return p.generateOperationResult({didOperationSucceed:!0,result:{id:e,underlyingMechanism:"requestIdleCallback"}})}n.logRequestIdleCallbackMissing();var o=Date.now(),a={didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-o))}};return n.logCallbackBeingInvokedImmediately(),t(a),p.generateOperationResult({didOperationSucceed:!0,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}})}),o).getResult()},e}(),S=function(){function e(){}return e.getIdleTimeJobScheduler=function(){var e=new C,t=new h(e);return new T(t,e)},e}(),F=function(){function e(){}return e.prototype.getBooleanPropertyValue=function(e){var t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckSelfProperty",(function(t){t.addProperty("PropertyChecked",e);var r=!!self.hasOwnProperty(e)&&self[e];return p.generateOperationResult({didOperationSucceed:!0,result:r})}),t).getResult()},e}(),w=function(){function e(e){this.selfPropertyChecker=e}return e.prototype.isSiteCrossOriginIsolated=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckCrossOriginSiteIsolation",(function(){var t=e.selfPropertyChecker.getBooleanPropertyValue("crossOriginIsolated");return p.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e}(),x=function(){function e(){}return e.getChecker=function(){var e=new F;return new w(e)},e}(),b=function(){function e(e){this.logger=e}return e.prototype.setTimerJob=function(e,t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("SetTimerJob",(function(){return null==window?(r.logger.logWindowMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):null==window.setTimeout?(r.logger.logWindowSetTimeOutMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):(r.logger.logTimerJobDuration(t),window.setTimeout(e,t),r.logger.logTimerJobScheduled(),p.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),n)},e}(),I=function(){function e(){}return e.getTimerJobScheduler=function(){var e=new C;return new b(e)},e}(),R=function(){function e(e){var t=this;this.logger=e,this.onVisibilityChange=function(){t.updateIsHidden()},this.isDocumentPresentInJsEnvironment()&&this.logger.logDocumentMissingInJsEnvironment(),this.isDocumentVisibilityStatePresentInJsEnvironment()&&this.logger.logDocumentVisibilityStateMissingInJsEnvironment(),this.isDocumentAddEventListenerPresentInJsEnvironment()&&this.logger.logDocumentAddEventListenerMissingInJsEnvironment(),this.lastUnHiddenDate=void 0,this.isDocumentHidden=!1,this.updateIsHidden(),document.addEventListener("visibilitychange",this.onVisibilityChange)}return e.prototype.isDocumentVisibleNow=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckDocumentVisibility",(function(){if(e.isDocumentPresentInJsEnvironment())return e.logger.logDocumentMissingInJsEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});if(e.isDocumentVisibilityStatePresentInJsEnvironment())return e.logger.logDocumentVisibilityStateMissingInJsEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var t="hidden"!==document.visibilityState;return p.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.wasDocumentHiddenDuringTimeRange=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("WasDocumentHiddenDuringTimeRange",(function(){if(t.isDocumentHidden)return p.generateOperationResult({didOperationSucceed:!0,result:!0});if(void 0===t.lastUnHiddenDate)return p.generateOperationResult({didOperationSucceed:!0,result:!1});var r=Date.now()-t.lastUnHiddenDate<e;return p.generateOperationResult({didOperationSucceed:!0,result:r})}),r).getResult()},e.prototype.isDocumentPresentInJsEnvironment=function(){return null!=document},e.prototype.isDocumentVisibilityStatePresentInJsEnvironment=function(){return"visibilityState"in document},e.prototype.isDocumentAddEventListenerPresentInJsEnvironment=function(){return"addEventListener"in document},e.prototype.updateIsHidden=function(){this.isDocumentHidden="hidden"===document.visibilityState,this.isDocumentHidden||(this.lastUnHiddenDate=Date.now())},e}(),O=function(){function e(){}return e.getDocumentVisibilityChecker=function(){var e=new C;return new R(e)},e}();!function(e){e.SendBeacon="sendBeacon"}(y||(y={}));var A,P=function(){function e(e,t,r,n){this.navigatorPropertyChecker=e,this.navigatorAPI=t,this.xmlHTTPRequestWrapperFactory=r,this.logger=n}return e.prototype.sendBeacon=function(e,t){return function(e,t,r,n,i,o){var a=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("SendBeaconCall",(function(a){if(0===i.length)return n.logBeaconURLIsEmpty(),p.generateOperationResult({didOperationSucceed:!1,result:!1});if(0===o.length)return n.logBeaconDataIsEmpty(),p.generateOperationResult({didOperationSucceed:!1,result:!1});if(!e.hasProperty(y.SendBeacon)){n.logSendBeaconNotSupported();var l=r.generateXMLHTTPRequestWrapper();return l.open("POST",i,!0),l.send(o),a.addProperty("POSTRequestSent",!0),p.generateOperationResult({didOperationSucceed:!0,result:!0})}return t.sendBeacon(i,o),a.addProperty("BeaconSent",!0),p.generateOperationResult({didOperationSucceed:!0,result:!0})}),a).getResult()}(this.navigatorPropertyChecker,this.navigatorAPI,this.xmlHTTPRequestWrapperFactory,this.logger,e,t)},e}(),L=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckNavigatorProperty",(function(r){if(null==navigator)return t.logger.logNavigatorMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});r.addProperty("NavigatorPropertyChecked",e);var n=e in navigator;return r.addProperty("IsPropertyPresentInNavigatorResult",n),p.generateOperationResult({didOperationSucceed:!0,result:n})}),r).getResult()},e}(),M=function(){function e(e){this.logger=e}return e.prototype.sendBeacon=function(e,t){return null==navigator?(this.logger.logNavigatorMissingInJSEnvironment(),!1):navigator.sendBeacon(e,t)},e}(),k=function(){function e(){this.xmlHTTPRequest=new XMLHttpRequest}return e.prototype.open=function(e,t,r){this.xmlHTTPRequest.open(e,t,r)},e.prototype.send=function(e){this.xmlHTTPRequest.send(e)},e}(),D=function(){function e(){}return e.prototype.generateXMLHTTPRequestWrapper=function(){return new k},e}(),N=(function(){function e(){}e.getSendBeaconScheduler=function(){var e=new C,t=new L(e),r=new M(e),n=new D;return new P(t,r,n,e)}}(),function(){function e(e){this.logger=e}return e.prototype.getCurrentTimestamp=function(){if(null!=window)if(null!=window.performance){if(null!=window.performance.now)return window.performance.now();this.logger.logWindowPerformanceNowMissingInJSEnvironment()}else this.logger.logWindowPerformanceMissingInJSEnvironment();else this.logger.logWindowMissingInJSEnvironment()},e}()),B=function(){function e(){}return e.getTimestampRetriever=function(){var e=new C;return new N(e)},e}(),E=function(){function e(){this.elements=[]}return e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e.prototype.queue=function(e){this.elements.push(e)},e.prototype.dequeue=function(){this.elements.shift()},e}(),W=function(){function e(){}return e.createQueue=function(){return new E},e}(),H=function(){function e(e){this.logger=e,this.logger=e}return e.prototype.retrieveUserAgent=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:""});return f.startNew("RetrieveUserAgent",(function(){var t=e.getUserAgentFromNavigatorAPI();return p.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.getUserAgentFromNavigatorAPI=function(){return"undefined"==typeof navigator?(this.logger.logNavigatorMissingInJSEnvironment(),""):navigator.userAgent},e}(),_=function(){function e(){}return e.getUserAgentRetriever=function(){return new H(new C)},e}(),z=function(){function e(){this.elements=[]}return e.prototype.peek=function(){var e=this.count();if(0!==e)return this.elements[e-1]},e.prototype.push=function(e){this.elements.push(e)},e.prototype.pop=function(){this.elements.pop()},e.prototype.count=function(){return this.elements.length},e}(),U=(function(){function e(){}e.createStack=function(){return new z}}(),r(4)),j=function(){function e(e,t,r,n,i){this.customProperties=e,this.profilerTrace=t,this.profilerTraceStartTimestamp=r,this.profilerProperties=n,this.elapsedProfilingTime=i}return e.prototype.getCustomProperties=function(){return this.customProperties},e.prototype.getResources=function(){return this.profilerTrace.resources},e.prototype.getFrames=function(){return this.profilerTrace.frames},e.prototype.getStacks=function(){return this.profilerTrace.stacks},e.prototype.getSamples=function(){return this.profilerTrace.samples},e.prototype.getProfilerTraceStartTimestamp=function(){return this.profilerTraceStartTimestamp},e.prototype.getProfilerProperties=function(){return this.profilerProperties},e.prototype.getElapsedProfilingTimeInMs=function(){return this.elapsedProfilingTime},e}();!function(e){e.Chrome="chrome"}(A||(A={}));var V={resources:[],samples:[],frames:[],stacks:[]},G={name:"InvalidFrameName",resourceId:-1,line:-1,column:-1},J=function(){function e(e,t,r,n,i,o){this.preProfilerStartChecker=e,this.jsSelfProfilingAPI=t,this.profilerInitOptions=r,this.customPropertiesRetriever=n,this.timestampRetriever=i,this.logger=o,this.profiler=void 0,this.profilerTrace=void 0,this.profilerObservers=[],this.profilerStartTimestamp=void 0,this.profilerStopTimestamp=void 0}return e.prototype.start=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StartManualProfiler",(function(){var t=e.startProfilerImplementation();return p.generateOperationResult({didOperationSucceed:t,result:void 0})}),t)},e.prototype.startProfilerImplementation=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("StartManualProfilerInternal",(function(){if(void 0!==t.profiler)return t.logger.logProfilerAlreadyStarted(),p.generateOperationResult({didOperationSucceed:!1,result:!1});if(null!=e&&t.logger.logPostProfilerStartCallbackSpecified(),!t.preProfilerStartChecker.shouldProfilingStart())return t.logger.logPreProfilerStartCheckFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!0});if(null==t.profilerInitOptions.maximumNumberOfSamplesToTake)return t.logger.logMaxBufferSizeNotFixed(),p.generateOperationResult({didOperationSucceed:!1,result:!1});t.logger.logSamplingIntervalUsedForStartingProfiler(t.profilerInitOptions.samplingIntervalInMs),t.logger.logMaxBufferSize(t.profilerInitOptions.maximumNumberOfSamplesToTake);var r=t.jsSelfProfilingAPI.profile({sampleInterval:t.profilerInitOptions.samplingIntervalInMs,maxBufferSize:t.profilerInitOptions.maximumNumberOfSamplesToTake});return t.logger.logProfilerStartPromiseCreated(),r.then((function(r){t.profilerStartTimestamp=t.timestampRetriever.getCurrentTimestamp(),t.logger.logProfilerStartPromiseResolved(),t.profiler=r,null!=e&&(t.logger.logInvokingPostProfilerStartCallback(),e())}),(function(e){t.logger.logProfilerStartPromiseRejected(e),t.profiler=void 0})),p.generateOperationResult({didOperationSucceed:!0,result:!0})}),r).getResult()},e.prototype.stop=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StopManualProfiler",(function(){var t=e.stopProfilerImplementation();return p.generateOperationResult({didOperationSucceed:t,result:void 0})}),t)},e.prototype.stopProfilerImplementation=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("StopManualProfilerInternal",(function(r){return null==t.profiler?(t.logger.logProfilerInstanceIsUndefined(),p.generateOperationResult({didOperationSucceed:!1,result:!1})):(0===t.profilerObservers.length&&t.logger.logNoProfilerObserverSubscribed(),null!=e&&t.logger.logPostProfilerStopCallbackSpecified(),t.logger.logProfilerStopGoingToBeInvoked(),t.profiler.stop().then((function(n){if(t.profilerStopTimestamp=t.timestampRetriever.getCurrentTimestamp(),t.logger.logProfilerStopPromiseResolved(),t.profilerTrace=n,t.profilerObservers.length>0){var i={};if(null!=t.customPropertiesRetriever){var o=t.customPropertiesRetriever.getCustomProperties();null!=o?o.forEach((function(e,r){null==r?t.logger.logCustomPropertyKeyIsNull():null==e?t.logger.logCustomPropertyValueIsNull():i[r]=e})):t.logger.logNullOrUndefinedCustomProperties()}else t.logger.logNullOrUndefinedCustomPropertiesRetriever();var a=-1;void 0!==t.profilerStartTimestamp&&void 0!==t.profilerStopTimestamp&&(a=t.profilerStopTimestamp-t.profilerStartTimestamp);r.addProperty("ElapsedProfilingTime",a);var l=new j(i,t.profilerTrace,void 0!==t.profilerStartTimestamp?t.profilerStartTimestamp:-1,t.profilerInitOptions,a);t.profilerObservers.forEach((function(e){e.onProfilerStop(l)}))}t.profiler=void 0,null!=e&&(t.logger.logPostProfilerStopCallbackInvoked(),e())}),(function(e){t.logger.logProfilerStopPromiseRejected(e),t.profiler=void 0,t.profilerTrace=void 0})),t.profilerStartTimestamp=void 0,t.profilerStopTimestamp=void 0,p.generateOperationResult({didOperationSucceed:!0,result:!0}))}),r).getResult()},e.prototype.subscribe=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("SubscribeProfilerObserver",(function(){return t.profilerObservers.push(e),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e}(),q=function(e){function t(t,r,n,i,o,a,l){var s=e.call(this,t,r,n,o,a,l)||this;return s.timerJobScheduler=i,s.postProfilerStartCallback=function(){s.logger.logPostTimedStartProfilerStartCallbackInvoked(),null!=s.profilerInitOptions.profilingIntervalInMs?(s.timerJobScheduler.setTimerJob(s.postTimerStopCallBack,s.profilerInitOptions.profilingIntervalInMs),s.logger.logTimerJobToStopProfilerSet()):s.logger.logProfilingIntervalIsUndefined()},s.postTimerStopCallBack=function(){s.logger.logTimedProfilerStopCallbackInvoked(),s.stop(!0)},s}return Object(U.__extends)(t,e),t.prototype.start=function(){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StartTimedProfiler",(function(){return e.prototype.startProfilerImplementation.call(t,t.postProfilerStartCallback),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},t.prototype.stop=function(t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StopTimedProfiler",(function(){return null==t||t||r.logger.logTimedProfilerIsBeingStoppedManually(),e.prototype.stopProfilerImplementation.call(r),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),n)},t}(J),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.postProfilerStopCallback=function(){null!=t.profilerInitOptions.idleIntervalInMs?t.timerJobScheduler.setTimerJob(t.postTimerStopCallback,t.profilerInitOptions.idleIntervalInMs):t.logger.logNullOrUndefinedIdleInterval()},t.postTimerStopCallback=function(){t.start()},t}return Object(U.__extends)(t,e),t.prototype.start=function(){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StartContinuousProfiler",(function(){return e.prototype.start.call(t),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},t.prototype.stop=function(){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("StopContinuousProfiler",(function(){return e.prototype.stopProfilerImplementation.call(t,t.postProfilerStopCallback),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},t}(q),Y=function(e){function t(t,r,n,i,o,a,l){var s=e.call(this,t,r,n,o,a,l)||this;return s.timerJobScheduler=i,s.postProfilerStartCallback=function(){s.timerJobScheduler.setTimerJob((function(){s.stop(!0)}),1e4)},s.postProfilerStopCallback=function(){s.start()},s}return Object(U.__extends)(t,e),t.prototype.start=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:void 0});return f.startNew("StartFullSessionProfiler",(function(){return e.startProfilerImplementation(e.postProfilerStartCallback),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),t).getResult()},t.prototype.stop=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});return f.startNew("StopFullSessionProfiler",(function(){var r=void 0;return void 0!==e&&e&&(r=t.postProfilerStopCallback),t.stopProfilerImplementation(r),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r).getResult()},t}(J),Q=function(){function e(){}return e.prototype.stop=function(){return Promise.resolve(V)},e}(),K=function(){function e(){}return e.prototype.profile=function(e){var t=p.generateOperationResult({didOperationSucceed:!1,result:Promise.resolve(new Q)});return f.startNew("JSSelfProfilingAPI-Profile",(function(){var t=window.performance.profile(e);return p.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e}(),Z=function(){function e(e,t){this.documentVisibilityChecker=e,this.shouldProfilerStartInAHiddenDocument=t}return e.prototype.shouldProfilingStart=function(){return!!this.isDocumentVisibleNow()||this.shouldProfilerStartInAHiddenDocument},e.prototype.isDocumentVisibleNow=function(){return this.documentVisibilityChecker.isDocumentVisibleNow()},e}(),$=function(){function e(){}return e.buildProfiler=function(e,t,r,n,o,a){var l=p.generateOperationResult({didOperationSucceed:!1,result:new i(a)});return f.startNew("BuildProfilerInstance",(function(){a.logProfilerTypeToBuild(e),a.logProfilerInitOptions(t);var l=O.getDocumentVisibilityChecker(),s=new Z(l,null!=o.shouldProfilingStartInAHiddenDocument&&o.shouldProfilingStartInAHiddenDocument),u=new K,d=I.getTimerJobScheduler(),c=B.getTimestampRetriever(),g=void 0,f=!1,h=!1,m=!1;switch(e){case 0:var C=new J(s,u,t,r,c,a);C.subscribe(n),m=!0,g=C,f=!0;break;case 1:var v=new q(s,u,t,d,r,c,a);v.subscribe(n),m=!0,g=v,f=!0;break;case 2:var y=new X(s,u,t,d,r,c,a);y.subscribe(n),m=!0,g=y,f=!0;break;case 3:var T=new Y(s,u,t,d,r,c,a);T.subscribe(n),m=!0,g=T,f=!0;break;default:a.logMissingProfilerImplementation(e),g=new i(a),f=!1,h=!0}void 0===g&&a.logNoProfilerInstanceBuilt(),void 0===g||m||a.logCreateProfilerDidNotSubscribeProfilerObserver();var S=void 0===g?new i(a):g;return p.generateOperationResult({didOperationSucceed:f,result:S,didOperationFailUnexpectedly:h})}),l).getResult()},e}(),ee=function(){function e(e,t,r,n,i,o){this.validator=e,this.logger=t,this.optionsValidatorFactory=r,this.profilerInitOptionsFixerFactory=n,this.profilerObserver=i,this.packageInitOptions=o}return e.prototype.createProfiler=function(e,t,r){var n=this,o=p.generateOperationResult({didOperationSucceed:!1,result:new i(this.logger)});return f.startNew("CreateProfiler",(function(){if(!n.validator.areValidationsSuccessful())return n.logger.logFailingValidationsInProfilerFactory(),p.generateOperationResult({didOperationSucceed:!1,result:new i(n.logger)});if(!n.optionsValidatorFactory.retrieveValidator(e).isValid(t))return n.logger.logProfilerInitOptionsValidationFailed(),p.generateOperationResult({didOperationSucceed:!1,result:new i(n.logger)});var o=n.profilerInitOptionsFixerFactory.getFixerForProfilerType(e);o.fixProfilerInitOptions(t);var a=o.retrieveFixedProfilerInitOptions();if(null==a)return n.logger.logUnableToFixUpProfilerInitOptions(),p.generateOperationResult({didOperationSucceed:!1,result:new i(n.logger)});var l=$.buildProfiler(e,a,r,n.profilerObserver,n.packageInitOptions,n.logger);return p.generateOperationResult({didOperationSucceed:!0,result:l})}),o).getResult()},e}(),te=function(){function e(e,t,r){this.featureChecker=e,this.supportedEnvironmentChecker=t,this.logger=r}return e.prototype.areValidationsSuccessful=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckProfilerFactoryValidations",(function(){return e.isFeatureEnabled()?e.isSupportedEnvironmentForProfiling()?p.generateOperationResult({didOperationSucceed:!0,result:!0}):(e.logger.logProfilingIsNotSupportedEnvironment(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(e.logger.logProfilingIsNotEnabled(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),t).getResult()},e.prototype.isFeatureEnabled=function(){return null==this.featureChecker?(this.logger.logFeatureCheckerIsNullOrUndefined(),!1):this.featureChecker.isProfilingEnabled()},e.prototype.isSupportedEnvironmentForProfiling=function(){return this.supportedEnvironmentChecker.isSupportedEnvironment()},e}(),re=function(){function e(e,t,r){this.userAgentRetriever=e,this.browserUtils=t,this.logger=r}return e.prototype.isProfilingSupportedInJSEnvironment=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckSupportedBrowser",(function(){var t=e.userAgentRetriever.retrieveUserAgent();if(!e.browserUtils.isBrowserChromiumBased(t))return e.logger.logBrowserUserAgentNotChromiumBased(),p.generateOperationResult({didOperationSucceed:!0,result:!1});e.logger.logBrowserChromiumBased();var r=e.browserUtils.parseChromeMajorVersionNumber(t);return e.logger.logChromiumBrowserMajorVersionNumber(r),r<80?(e.logger.logUnsupportedChromiumMajorVersionNumber(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):p.generateOperationResult({didOperationSucceed:!0,result:!0})}),t).getResult()},e}(),ne=function(){function e(e,t,r,n,i,o){this.supportedBrowserChecker=e,this.supportedOperatingSystemChecker=t,this.jsSelfProfilingAPIAvailabilityChecker=r,this.crossOriginSiteIsolationRequirementChecker=n,this.crossOriginSiteIsolationChecker=i,this.logger=o}return e.prototype.isSupportedEnvironment=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckSupportedEnvironment",(function(){return e.isSupportedBrowser()?e.isSupportedOperatingSystem()?e.isJSSelfProfilingAPIAvailable()?e.shouldCheckForCrossOriginSiteIsolation()?e.isCrossOriginSiteIsolated()?p.generateOperationResult({didOperationSucceed:!0,result:!0}):(e.logger.logSiteNotCrossOriginIsolated(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):p.generateOperationResult({didOperationSucceed:!0,result:!0}):(e.logger.logJSSelfProfilingAPIUnavailable(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(e.logger.logUnsupportedOperatingSystem(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(e.logger.logUnsupportedBrowser(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),t).getResult()},e.prototype.isSupportedBrowser=function(){return this.supportedBrowserChecker.isProfilingSupportedInJSEnvironment()},e.prototype.isSupportedOperatingSystem=function(){return this.supportedOperatingSystemChecker.isSupportedOperatingSystem()},e.prototype.isJSSelfProfilingAPIAvailable=function(){return this.jsSelfProfilingAPIAvailabilityChecker.isJSSelfProfilingAPIAvailable()},e.prototype.shouldCheckForCrossOriginSiteIsolation=function(){return this.crossOriginSiteIsolationRequirementChecker.shouldCheckForCrossOriginIsolation()},e.prototype.isCrossOriginSiteIsolated=function(){return this.crossOriginSiteIsolationChecker.isSiteCrossOriginIsolated()},e}(),ie=function(){function e(e){this.userAgentRetriever=e}return e.prototype.isSupportedOperatingSystem=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,didOperationFailUnexpectedly:!0,result:!1});return f.startNew("SupportedOperatingSystemCheck",(function(){var t=e.isOperatingSystemWindows();return p.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.isOperatingSystemWindows=function(){return this.userAgentRetriever.retrieveUserAgent().toLowerCase().includes("win")},e}(),oe=function(){function e(e){this.logger=e}return e.prototype.isJSSelfProfilingAPIAvailable=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckForJSSelfProfilingAPI",(function(){return null==window?(e.logger.logWindowMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):null==window.performance?(e.logger.logWindowPerformanceMissingInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):null==window.performance.profile?(e.logger.logWindowPerformanceProfileNotPresentInJSEnvironment(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):p.generateOperationResult({didOperationSucceed:!0,result:!0})}),t).getResult()},e}(),ae=function(){function e(e){this.logger=e}return e.prototype.isSupportedEnvironment=function(){return this.logger.logNullSupportedEnvironmentCheckerInvoked(),!1},e}(),le=function(){function e(e,t){this.userAgentRetriever=e,this.browserUtils=t}return e.prototype.shouldCheckForCrossOriginIsolation=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("ShouldCheckForCrossOriginIsolation",(function(t){var r=e.userAgentRetriever.retrieveUserAgent(),n=e.browserUtils.isBrowserChromiumBased(r);if(t.addProperty("ChromiumBasedBrowser",n),!n)return p.generateOperationResult({didOperationSucceed:!0,result:!1});var i=e.browserUtils.parseChromeMajorVersionNumber(r);t.addProperty("ChromeMajorVersionNumber",i);var o=i>=88;return t.addProperty("IsCrossOriginSiteIsolationCheckRequired",o),p.generateOperationResult({didOperationSucceed:!0,result:o})}),t).getResult()},e}(),se=function(){function e(){}return e.build=function(e){var t=p.generateOperationResult({didOperationSucceed:!1,result:new ae(e)});return f.startNew("BuildSupportedEnvironmentChecker",(function(){var t=_.getUserAgentRetriever(),r=v.getBrowserUtils(),n=new re(t,r,e),i=new ie(t),o=new oe(e),a=new le(t,r),l=x.getChecker();return p.generateOperationResult({didOperationSucceed:!0,result:new ne(n,i,o,a,l,e)})}),t).getResult()},e}(),ue=function(){function e(e){this.logger=e}return e.prototype.isValid=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckSamplingInterval",(function(){return null==e?(t.logger.logProfilerInitOptionsNullOrUndefined(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(t.logger.logSamplingInterval(e.samplingIntervalInMs),e.samplingIntervalInMs<=0?(t.logger.logSamplingIntervalIsLessThanOrEqualToZero(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(e.samplingIntervalInMs<16&&t.logger.logSamplingIntervalLessThanMinimumSupportedSamplingInterval(),p.generateOperationResult({didOperationSucceed:!0,result:!0})))}),r).getResult()},e}(),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(U.__extends)(t,e),t.prototype.isValid=function(t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckMaxBufferSizeIfSpecified",(function(){return null==t?(r.logger.logProfilerInitOptionsNullOrUndefined(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):e.prototype.isValid.call(r,t)?r.isMaxBufferSizeValidIfSpecified(t)?p.generateOperationResult({didOperationSucceed:!0,result:!0}):(r.logger.logMaxBufferValidationFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(r.logger.logSamplingIntervalValidationCheckFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),n).getResult()},t.prototype.isMaxBufferSizeValidIfSpecified=function(e){return null==e.maximumNumberOfSamplesToTake?(this.logger.logMaxBufferSizeNotSpecified(),!0):!(e.maximumNumberOfSamplesToTake<=0)||(this.logger.logMaxBufferSizeLessThanOrEqualToZero(),!1)},t}(ue),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(U.__extends)(t,e),t.prototype.isValid=function(t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckProfilingIntervalIfSpecified",(function(){return null==t?(r.logger.logProfilerInitOptionsNullOrUndefined(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):e.prototype.isValid.call(r,t)?r.isProfilingIntervalValid(t)?r.isProfilingIntervalGreaterThanSamplingInterval(t)?p.generateOperationResult({didOperationSucceed:!0,result:!0}):p.generateOperationResult({didOperationSucceed:!0,result:!1}):(r.logger.logProfilingIntervalValidationFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(r.logger.logManualProfilerValidationFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),n).getResult()},t.prototype.isProfilingIntervalValid=function(e){return null==e.profilingIntervalInMs?(this.logger.logProfilingIntervalNullOrUndefined(),!1):!(e.profilingIntervalInMs<=0)||(this.logger.logProfilingIntervalLessThanOrEqualToZero(),!1)},t.prototype.isProfilingIntervalGreaterThanSamplingInterval=function(e){return null==e.profilingIntervalInMs?(this.logger.logProfilingIntervalNullOrUndefined(),!1):!(e.profilingIntervalInMs<e.samplingIntervalInMs)||(this.logger.logProfilingIntervalLessThanSamplingInterval(),!1)},t}(de),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(U.__extends)(t,e),t.prototype.isValid=function(t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:!1});return f.startNew("CheckIdleIntervalIfSpecified",(function(){return null==t?(r.logger.logProfilerInitOptionsNullOrUndefined(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):e.prototype.isValid.call(r,t)?r.isIdleIntervalInValid(t)?p.generateOperationResult({didOperationSucceed:!0,result:!0}):(r.logger.logIdleIntervalValidationFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1})):(r.logger.logTimedProfilerValidationFailed(),p.generateOperationResult({didOperationSucceed:!0,result:!1}))}),n).getResult()},t.prototype.isIdleIntervalInValid=function(e){return null==e.idleIntervalInMs?(this.logger.logIdleIntervalIsNullOrUndefined(),!1):!(e.idleIntervalInMs<=0)||(this.logger.logIdleIntervalIsLessThanOrEqualToZero(),!1)},t}(ce),fe=function(){function e(e){this.logger=e}return e.prototype.isValid=function(e){return this.logger.logNullJSCPUProfilerInitOptionsValidatorInvoked(),!1},e}(),pe=function(){function e(e){this.logger=e}return e.prototype.retrieveValidator=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:new fe(this.logger)});return f.startNew("RetrieveValidator",(function(r){switch(r.addProperty("ProfilerType",e),e){case 0:return p.generateOperationResult({didOperationSucceed:!0,result:new de(t.logger)});case 1:return p.generateOperationResult({didOperationSucceed:!0,result:new ce(t.logger)});case 2:return p.generateOperationResult({didOperationSucceed:!0,result:new ge(t.logger)});case 3:return p.generateOperationResult({didOperationSucceed:!0,result:new ue(t.logger)});default:return r.addLog("Missing validator implementation for profiler type"),p.generateOperationResult({didOperationSucceed:!1,result:new ue(t.logger),didOperationFailUnexpectedly:!0})}}),r).getResult()},e}(),he=function(){function e(e){this.logger=e,this.didProfilerInitOptionsGetFixed=!1,this.fixedProfilerInitOptions=void 0}return e.prototype.fixProfilerInitOptions=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("FixMaxBufferSize",(function(){return null==e?(t.logger.logNullOrUndefinedProfilerInitOptions(),p.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):(t.fixedProfilerInitOptions=e,null==t.fixedProfilerInitOptions.maximumNumberOfSamplesToTake&&(t.logger.logMaxBufferSizeFixedToDefaultSize(),t.fixedProfilerInitOptions.maximumNumberOfSamplesToTake=2e5),t.didProfilerInitOptionsGetFixed=!0,p.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),r)},e.prototype.retrieveFixedProfilerInitOptions=function(){return this.didProfilerInitOptionsGetFixed?this.didProfilerInitOptionsGetFixed=!1:this.logger.logMaxBufferSizeWasNotFixedBeforeRetrieval(),this.fixedProfilerInitOptions},e}(),me=function(){function e(e){this.logger=e,this.profilerInitOptionsToLoopBack=void 0}return e.prototype.fixProfilerInitOptions=function(e){this.logger.logLoopBackFixerFixProfilerInitOptionsInvoked(),null!=e&&(this.profilerInitOptionsToLoopBack=e)},e.prototype.retrieveFixedProfilerInitOptions=function(){return this.logger.logLoopBackFixerRetrieveFixedProfilerInitOptionsInvoked(),this.profilerInitOptionsToLoopBack},e}(),Ce=function(){function e(e){this.logger=e}return e.prototype.getFixerForProfilerType=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:new me(this.logger)});return f.startNew("GetFixerForProfileType",(function(){t.logger.logFixerForProfilerType(e);var r=new me(t.logger),n=!1;switch(e){case 0:case 1:case 2:case 3:n=!0,r=new he(t.logger);break;default:t.logger.logMissingProfilerInitOptionsFixerImplementation()}return p.generateOperationResult({didOperationSucceed:n,result:r})}),r).getResult()},e}(),ve=function(){function e(e){this.logger=e}return e.prototype.createProfiler=function(e,t){return this.logger.logNullJSCPUProfilerFactoryInvoked(),new i(this.logger)},e}(),ye=function(){function e(e,t,r,n){this.profilerTraceTransformer=e,this.deObfuscationInfo=t,this.idleTimeJobScheduler=r,this.logger=n}return e.prototype.onProfilerStop=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("OnProfilerStop",(function(){return t.idleTimeJobScheduler.scheduleJobForIdleTime((function(){t.profilerTraceTransformer.transform(e),t.profilerTraceTransformer.retrieveCallTrees(),t.logger.logProfilerTrace(e,t.deObfuscationInfo)})),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e}(),Te=function(){function e(e,t,r,n,i){this.traceToCallTreesConverter=e,this.callTreesMerger=t,this.callTreesFilterer=r,this.callTreeFilteringThresholdInMs=n,this.logger=i,this.transformCalledBeforeRetrieveCallTrees=!1,this.profilerTrace=void 0,this.callTreesToReturn=[]}return e.prototype.transform=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("TransformProfilerTrace",(function(){t.profilerTrace=e,t.traceToCallTreesConverter.buildCallTrees(t.profilerTrace);var r=t.traceToCallTreesConverter.retrieveBuiltCallTrees();t.callTreesMerger.mergeCallTrees(r);var n=t.callTreesMerger.retrieveMergedCallTrees();return t.callTreesFilterer.filterCallTrees(n,t.callTreeFilteringThresholdInMs),t.callTreesToReturn=t.callTreesFilterer.retrieveFilteredCallTrees(),t.transformCalledBeforeRetrieveCallTrees=!0,p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e.prototype.retrieveCallTrees=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("RetrieveCallTrees",(function(){return e.transformCalledBeforeRetrieveCallTrees?(e.transformCalledBeforeRetrieveCallTrees=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.callTreesToReturn})):(e.logger.logRetrieveCallTreesCalledBeforeTransform(),p.generateOperationResult({didOperationSucceed:!1,result:[]}))}),t).getResult()},e}(),Se=function(){function e(e,t,r){this.stacksBuilder=e,this.stacksToCallTreesConverter=t,this.logger=r,this.didBuildCallTreesGetCalledBeforeRetrieve=!1,this.callTrees=[]}return e.prototype.buildCallTrees=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("BuildCallTrees",(function(){t.didBuildCallTreesGetCalledBeforeRetrieve=!0,t.stacksBuilder.buildStacks(e);var r=t.stacksBuilder.retrieveStacks();return t.stacksToCallTreesConverter.convertStacksToCallTrees(r),t.callTrees=t.stacksToCallTreesConverter.retrieveConvertedCallTrees(),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e.prototype.retrieveBuiltCallTrees=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("RetrieveBuiltCallTrees",(function(){return e.didBuildCallTreesGetCalledBeforeRetrieve?(e.didBuildCallTreesGetCalledBeforeRetrieve=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.callTrees})):(e.logger.logRetrieveBuiltCallTreesBeforeBuildCallTrees(),p.generateOperationResult({didOperationSucceed:!1,result:[]}))}),t).getResult()},e}(),Fe=function(){function e(){}return e.prototype.peek=function(){},e.prototype.pop=function(){},e}(),we=function(){function e(){this.profilerFrames=[],this.voidFallbackResult=p.generateOperationResult({didOperationSucceed:!1,result:void 0})}return e.prototype.peek=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:void 0});return f.startNew("PeekExecutionStack",(function(){var t=e.profilerFrames.length;return 0===t?p.generateOperationResult({didOperationSucceed:!0,result:void 0}):p.generateOperationResult({didOperationSucceed:!0,result:e.profilerFrames[t-1]})}),t).getResult()},e.prototype.pop=function(){var e=this;f.startNew("PopFromExecutionStack",(function(){return e.profilerFrames.pop(),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),this.voidFallbackResult)},e.prototype.push=function(e){var t=this;f.startNew("PushToExecutionStack",(function(){return t.profilerFrames.push(e),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),this.voidFallbackResult)},e}(),xe=function(){function e(e){this.logger=e}return e.prototype.peek=function(){this.logger.logPeekOnNullExecutionStackInvoked()},e.prototype.pop=function(){this.logger.logPopOnNullExecutionStackInvoked()},e}(),be=function(){function e(e,t){this.profilerTrace=e,this.logger=t,this.buildStackCalled=!1,this.builtStack=void 0}return e.prototype.buildStack=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("BuildStack",(function(r){if(t.buildStackCalled=!0,null==e.stackId){t.builtStack=new Fe;return r.addProperty("EmptyStackBuilt",!0),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}var n=t.profilerTrace.getStacks();if(0===n.length)return t.logger.logEmptyStacks(),p.generateOperationResult({didOperationSucceed:!1,result:void 0});var i=t.profilerTrace.getFrames();if(0===i.length)return t.logger.logEmptyFrames(),p.generateOperationResult({didOperationSucceed:!1,result:void 0});for(var o=new we,a=e.stackId,l=0,s=!1,u=[];;){if(l>n.length){t.logger.logForciblyExitingLoopWhileBuildingStack(),s=!0;break}l+=1;var d=n[a],c=i[d.frameId];if(u.unshift(c),null==d.parentId)break;a=d.parentId}return u.forEach((function(e){o.push(e)})),s?p.generateOperationResult({didOperationSucceed:!1,didOperationFailUnexpectedly:!0,result:void 0}):(t.builtStack=o,p.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),r)},e.prototype.retrieveStack=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:new xe(this.logger)});return f.startNew("RetrieveStack",(function(){return e.buildStackCalled?void 0===e.builtStack?(e.logger.logExecutionStackNeverBuilt(),p.generateOperationResult({didOperationSucceed:!1,didOperationFailUnexpectedly:!0,result:new xe(e.logger)})):(e.buildStackCalled=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.builtStack})):(e.logger.logRetrieveStackCalledBeforeBuildStack(),p.generateOperationResult({didOperationSucceed:!1,result:new xe(e.logger)}))}),t).getResult()},e}(),Ie=function(){function e(e,t){this.sampleSorter=e,this.logger=t,this.buildStacksCalled=!1,this.builtExecutionStacks=void 0}return e.prototype.buildStacks=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("BuildStacks",(function(){t.buildStacksCalled=!0;var r=e.getSamples(),n=t.sampleSorter.sortSamples(r);return t.builtExecutionStacks=t.samplesToStacks(n,e),p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e.prototype.retrieveStacks=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("RetrieveStacks",(function(){return e.buildStacksCalled?void 0===e.builtExecutionStacks?p.generateOperationResult({didOperationSucceed:!1,didOperationFailUnexpectedly:!0,result:[]}):(e.buildStacksCalled=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.builtExecutionStacks})):(e.logger.logRetrieveStacksCalledBeforeBuildStacks(),p.generateOperationResult({didOperationSucceed:!1,result:[]}))}),t).getResult()},e.prototype.samplesToStacks=function(e,t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("ConvertSamplesToStacks",(function(){var n=[],i=new be(t,r.logger);return e.forEach((function(e){i.buildStack(e),n.push(i.retrieveStack())})),p.generateOperationResult({didOperationSucceed:!0,result:n})}),n).getResult()},e}(),Re=function(){function e(){}return e.prototype.sortSamples=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("SortSamples",(function(){var r=e.sort(t.sortSampleByTimestamp);return p.generateOperationResult({didOperationSucceed:!0,result:r})}),r).getResult()},e.prototype.sortSampleByTimestamp=function(e,t){var r=p.generateOperationResult({didOperationSucceed:!1,result:0});return f.startNew("CustomSampleSort",(function(){return e.timestamp>t.timestamp?p.generateOperationResult({didOperationSucceed:!0,result:1}):t.timestamp>e.timestamp?p.generateOperationResult({didOperationSucceed:!0,result:-1}):p.generateOperationResult({didOperationSucceed:!0,result:0})}),r).getResult()},e}(),Oe=function(){function e(e){this.logger=e,this.logger.logNullFrameNodeCreated()}return e.prototype.addChildNode=function(e){},e.prototype.getFrameOnlyExecutionTimeInMs=function(){return-1},e.prototype.getSubTreeExecutionTimeInMs=function(){return-1},e.prototype.getTotalExecutionTimeInMs=function(){return-1},e.prototype.getFrame=function(){return G},e.prototype.getChildrenNodes=function(){return[]},e.prototype.getStartTimeInMs=function(){return-1},e.prototype.getLastObservedTimestamp=function(){return-1},e.prototype.setTotalExecutionTime=function(e){},e.prototype.setLastObservedTimestamp=function(e){},e}(),Ae=function(){function e(e){this.logger=e,this.logger.logNullCallTreeIteratorCreated()}return e.prototype.getNext=function(){return new Oe(this.logger)},e.prototype.hasMore=function(){return!1},e}(),Pe=function(){function e(e){this.logger=e}return e.prototype.getBreadthFirstIterator=function(){return this.logger.logNullCallTreeGetBreadthFirstIteratorInvoked(),new Ae(this.logger)},e}(),Le=function(){function e(e){this.nodesToIterate=W.createQueue(),this.nodesToIterate.queue(e)}return e.prototype.getNext=function(){var e=this,t=this.nodesToIterate.peek();if(void 0!==t)return t.getChildrenNodes().forEach((function(t){e.nodesToIterate.queue(t)})),this.nodesToIterate.dequeue(),t},e.prototype.hasMore=function(){return void 0!==this.nodesToIterate.peek()},e}(),Me=function(){function e(e,t){this.rootNode=e,this.logger=t}return e.prototype.getBreadthFirstIterator=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:new Ae(this.logger)});return f.startNew("GetBreadthFirstIterator",(function(){return p.generateOperationResult({didOperationSucceed:!0,result:new Le(e.rootNode)})}),t).getResult()},e}(),ke=function(){function e(e,t,r,n,i){this.profilerFrame=e,this.startTime=t,this.totalExecutionTime=r,this.lastObservedTimestamp=n,this.logger=i,this.childrenNodes=[],t<0&&this.logger.logInvalidFrameNodeStartTime(),r<0&&this.logger.logInvalidFrameNodeExecutionTime()}return e.prototype.addChildNode=function(e){this.childrenNodes.push(e)},e.prototype.getFrameOnlyExecutionTimeInMs=function(){var e=this.getSubTreeExecutionTimeInMs();return this.totalExecutionTime-e},e.prototype.getSubTreeExecutionTimeInMs=function(){var e=0;return this.childrenNodes.forEach((function(t){e+=t.getTotalExecutionTimeInMs()})),e<0&&this.logger.logNegativeSubTreeExecutionTime(),e},e.prototype.getTotalExecutionTimeInMs=function(){return this.totalExecutionTime},e.prototype.getFrame=function(){return this.profilerFrame},e.prototype.getChildrenNodes=function(){return this.childrenNodes},e.prototype.getStartTimeInMs=function(){return this.startTime},e.prototype.getLastObservedTimestamp=function(){return this.lastObservedTimestamp},e.prototype.setTotalExecutionTime=function(e){e<0&&this.logger.logInvalidNewFrameNodeExecutionTime(),this.totalExecutionTime=e},e.prototype.setLastObservedTimestamp=function(e){this.lastObservedTimestamp=e},e}(),De=function(){function e(){}return e.prototype.getNext=function(){},e.prototype.hasMore=function(){return!1},e}(),Ne=function(){function e(){}return e.prototype.getBreadthFirstIterator=function(){return new De},e}(),Be=function(){function e(e){this.logger=e,this.isConvertCalled=!1,this.convertedCallTree=new Pe(this.logger)}return e.prototype.convertStackToCallTree=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("ConvertStackToCallTree",(function(){return t.convertedCallTree=t.buildCallTree(e),t.isConvertCalled=!0,p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e.prototype.retrieveCallTree=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:new Pe(this.logger)});return f.startNew("RetrieveCallTree",(function(){return e.isConvertCalled?(e.isConvertCalled=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.convertedCallTree})):(e.logger.logConvertStackToCallTreeNeverCalled(),p.generateOperationResult({didOperationSucceed:!1,result:new Pe(e.logger)}))}),t).getResult()},e.prototype.buildCallTree=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:new Pe(this.logger)});return f.startNew("BuildCallTree",(function(r){for(var n=[];;){var i=e.peek();if(void 0===i)break;var o=new ke(i,10,50,60,t.logger);n.unshift(o),e.pop()}if(0===n.length)return r.addLog("No profiler frames were extracted. Returning null call tree"),p.generateOperationResult({didOperationSucceed:!0,result:new Ne});var a=0;n.forEach((function(e,t){if((a=t+1)!==n.length){var r=n[a];e.addChildNode(r)}}));var l=n[0];return p.generateOperationResult({didOperationSucceed:!0,result:new Me(l,t.logger)})}),r).getResult()},e}(),Ee=function(){function e(e){this.logger=e,this.convertStacksCalled=!1,this.callTrees=[]}return e.prototype.convertStacksToCallTrees=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:void 0});f.startNew("ConvertStacksToCallTrees",(function(){return t.callTrees=t.convertToCallTrees(e),t.convertStacksCalled=!0,p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),r)},e.prototype.retrieveConvertedCallTrees=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("RetrieveConvertedCallTrees",(function(){return e.convertStacksCalled?(e.convertStacksCalled=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.callTrees})):(e.logger.logConvertStacksToCallTreesNeverCalled(),p.generateOperationResult({didOperationSucceed:!1,result:[]}))}),t).getResult()},e.prototype.convertToCallTrees=function(e){var t=this,r=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("ConvertToCallTrees",(function(){var r=[],n=new Be(t.logger);return e.forEach((function(e){n.convertStackToCallTree(e),r.push(n.retrieveCallTree())})),p.generateOperationResult({didOperationSucceed:!0,result:r})}),r).getResult()},e}(),We=function(){function e(){this.mergedCallTrees=[]}return e.prototype.mergeCallTrees=function(e){this.mergedCallTrees=e},e.prototype.retrieveMergedCallTrees=function(){return this.mergedCallTrees},e}(),He=function(){function e(){this.callTreesToFilter=[],this.filterCallTreesCalled=!1}return e.prototype.filterCallTrees=function(e,t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:void 0});return f.startNew("FilterCallTrees",(function(){return r.filterCallTreesCalled=!0,r.callTreesToFilter=e,p.generateOperationResult({didOperationSucceed:!0,result:void 0})}),n).getResult()},e.prototype.retrieveFilteredCallTrees=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!1,result:[]});return f.startNew("RetrieveFilteredCallTrees",(function(){return e.filterCallTreesCalled?(e.filterCallTreesCalled=!1,p.generateOperationResult({didOperationSucceed:!0,result:e.callTreesToFilter})):p.generateOperationResult({didOperationSucceed:!1,result:[]})}),t).getResult()},e}(),_e=function(){function e(e,t,r){this.featureChecker=e,this.jsCPUProfilingPackageInitOptions=t,this.logger=r}return e.prototype.retrieveProfilerFactory=function(){var e=this,t=p.generateOperationResult({didOperationSucceed:!0,result:new ve(this.logger)});return f.startNew("RetrieveProfilerFactory",(function(){var t=e.getSupportedEnvironmentChecker(),r=new te(e.featureChecker,t,e.logger),n=new pe(e.logger),i=new Ce(e.logger),o={appName:null==e.jsCPUProfilingPackageInitOptions.appName?"":e.jsCPUProfilingPackageInitOptions.appName,buildVersion:null==e.jsCPUProfilingPackageInitOptions.buildVersion?"":e.jsCPUProfilingPackageInitOptions.buildVersion,deObfuscationEndpoint:null==e.jsCPUProfilingPackageInitOptions.deObfuscationEndpoint?"":e.jsCPUProfilingPackageInitOptions.deObfuscationEndpoint},a=new Re,l=new Ie(a,e.logger),s=new Ee(e.logger),u=new Se(l,s,e.logger),d=new We,c=new He,g=new Te(u,d,c,null==e.jsCPUProfilingPackageInitOptions.callTreeFilteringThresholdInMs?50:e.jsCPUProfilingPackageInitOptions.callTreeFilteringThresholdInMs,e.logger),f=S.getIdleTimeJobScheduler(),h=new ye(g,o,f,e.logger),m=new ee(r,e.logger,n,i,h,e.jsCPUProfilingPackageInitOptions);return p.generateOperationResult({didOperationSucceed:!0,result:m})}),t).getResult()},e.prototype.getSupportedEnvironmentChecker=function(){return se.build(this.logger)},e}(),ze=function(){function e(){}return e.prototype.logMissingProfilerImplementation=function(e){l.ULS.sendTraceTag(588395204,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Factory doesn't know how to create profiler of type "+e)},e.prototype.logFailingValidationsInProfilerFactory=function(){l.ULS.sendTraceTag(588395205,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Validations failed while creating the profiler")},e.prototype.logWindowMissingInJSEnvironment=function(){l.ULS.sendTraceTag(587794505,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Unable to find window in the JS environment")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){l.ULS.sendTraceTag(587794506,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPropertyNameChecked=function(e){l.ULS.sendTraceTag(587522332,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logUserAgentToParseChromiumMajorVersionNumber=function(e){l.ULS.sendTraceTag(587297552,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logChromeNotPresentInUserAgent=function(){l.ULS.sendTraceTag(587297553,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Chrome was not found in the user agent")},e.prototype.logUnableToIsolateChromeInformationFromUserAgent=function(){l.ULS.sendTraceTag(587297554,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to isolate chrome information from the user agent")},e.prototype.logUnableToExtractChromeVersionInformation=function(){l.ULS.sendTraceTag(587297555,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to extract chrome version information from the user agent")},e.prototype.logUnableToParseChromeMajorVersionString=function(){l.ULS.sendTraceTag(587297556,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to parse the chromium major version number")},e.prototype.logParsedChromiumMajorVersionNumber=function(e){l.ULS.sendTraceTag(587297557,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logUserAgentToCheckForChromiumBrowser=function(e){l.ULS.sendTraceTag(587284889,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logEmptyUserAgentString=function(){l.ULS.sendTraceTag(587284890,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Empty user agent string")},e.prototype.logBrowserUserAgentNotChromiumBased=function(){l.ULS.sendTraceTag(587284891,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Browser not chromium based")},e.prototype.logUserAgentSpoofedToBeChromium=function(){l.ULS.sendTraceTag(587284892,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logBrowserNotChromiumBasedBrowser=function(){l.ULS.sendTraceTag(587284893,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logBrowserChromiumBased=function(){l.ULS.sendTraceTag(587284894,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Chromium based browser")},e.prototype.logChromiumBrowserMajorVersionNumber=function(e){l.ULS.sendTraceTag(587284895,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logUnsupportedChromiumMajorVersionNumber=function(){l.ULS.sendTraceTag(587284896,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Unsupported chromium major version number")},e.prototype.logProfilerInitOptionsNullOrUndefined=function(){l.ULS.sendTraceTag(587273946,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"ProfilerInitOptions cannot be null or undefined")},e.prototype.logSamplingInterval=function(e){l.ULS.sendTraceTag(587273947,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logSamplingIntervalIsLessThanOrEqualToZero=function(){l.ULS.sendTraceTag(587273948,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Sampling interval must be greater than zero")},e.prototype.logSamplingIntervalLessThanMinimumSupportedSamplingInterval=function(){l.ULS.sendTraceTag(587273949,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Sampling interval is less than minimum supported sampling interval. API might perform scaling")},e.prototype.logUnsupportedBrowser=function(){l.ULS.sendTraceTag(587252693,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling is not supported in this browser")},e.prototype.logUnsupportedOperatingSystem=function(){l.ULS.sendTraceTag(587252694,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling is not supported in this operating system")},e.prototype.logJSSelfProfilingAPIUnavailable=function(){l.ULS.sendTraceTag(587252695,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"JSSelfProfiling is not available")},e.prototype.logRetrievedUserAgent=function(e){l.ULS.sendTraceTag(587251986,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e)},e.prototype.logNullJSCPUProfilerStartCalled=function(){l.ULS.sendTraceTag(587236810,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"NullJSCPUProfiler start called")},e.prototype.logNullJSCPUProfilerStopCalled=function(){l.ULS.sendTraceTag(587236811,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"NullJSCPUProfiler stop called")},e.prototype.logNullOrUndefinedProfilerInitOptions=function(){l.ULS.sendTraceTag(587235554,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"ProfilerInitOptions is null or undefined")},e.prototype.logMaxBufferSizeFixedToDefaultSize=function(){l.ULS.sendTraceTag(587235555,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Max buffer size was fixed to the default max size")},e.prototype.logMaxBufferSizeWasNotFixedBeforeRetrieval=function(){l.ULS.sendTraceTag(587235584,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Retrieve was called before fix max buffer size was called. The returned options can be undefined")},e.prototype.logWindowPerformanceProfileNotPresentInJSEnvironment=function(){l.ULS.sendTraceTag(587229282,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"window.performance.profile is not present in the JS environment indicating JSSelfProfiling API is not available")},e.prototype.logSamplingIntervalValidationCheckFailed=function(){l.ULS.sendTraceTag(587223882,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Sampling interval validation check failed")},e.prototype.logMaxBufferValidationFailed=function(){l.ULS.sendTraceTag(587223883,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Max buffer size validation failed")},e.prototype.logMaxBufferSizeNotSpecified=function(){l.ULS.sendTraceTag(587223884,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Max buffer size is not specified")},e.prototype.logMaxBufferSizeLessThanOrEqualToZero=function(){l.ULS.sendTraceTag(587223885,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Max buffer size is less than or equal to zero")},e.prototype.logManualProfilerValidationFailed=function(){l.ULS.sendTraceTag(579745164,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Timed profiler initialization options failed to pass manual profiler initialization options")},e.prototype.logProfilingIntervalValidationFailed=function(){l.ULS.sendTraceTag(579745165,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling interval validation failed")},e.prototype.logProfilingIntervalNullOrUndefined=function(){l.ULS.sendTraceTag(579745166,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling interval is null or undefined")},e.prototype.logProfilingIntervalLessThanOrEqualToZero=function(){l.ULS.sendTraceTag(579745167,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling interval is less than or equal to zero")},e.prototype.logProfilingIntervalLessThanSamplingInterval=function(){l.ULS.sendTraceTag(579745168,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling interval is less than sampling interval")},e.prototype.logTimedProfilerValidationFailed=function(){l.ULS.sendTraceTag(579655449,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Continuous profiler init options failed to pass timed profiler initialization options")},e.prototype.logIdleIntervalValidationFailed=function(){l.ULS.sendTraceTag(579655450,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Idle interval validation failed for continuous profiler")},e.prototype.logIdleIntervalIsNullOrUndefined=function(){l.ULS.sendTraceTag(579655451,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Idle interval is a required argument for continuous profiler")},e.prototype.logIdleIntervalIsLessThanOrEqualToZero=function(){l.ULS.sendTraceTag(579655452,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Idle interval must be greater than zero")},e.prototype.logPostProfilerStartCallbackSpecified=function(){l.ULS.sendTraceTag(579465421,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"A post profiler start callback is specified")},e.prototype.logPreProfilerStartCheckFailed=function(){l.ULS.sendTraceTag(579465422,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"One or more pre-profiler start checks failed")},e.prototype.logMaxBufferSizeNotFixed=function(){l.ULS.sendTraceTag(579465423,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Max buffer size must be fixed before we get to this point. Is the profiler being created outside the factory?")},e.prototype.logProfilerAlreadyStarted=function(){l.ULS.sendTraceTag(579465424,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Attempting to start the profiler even though the profiler is already started. Stop the profiler first and attempt a restart")},e.prototype.logProfilerStartPromiseResolved=function(){l.ULS.sendTraceTag(579465425,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Promise to start the profiler resolved successfully")},e.prototype.logProfilerStartPromiseRejected=function(e){l.ULS.sendTraceTag(579465426,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,JSON.stringify({promiseRejectionReason:e}))},e.prototype.logInvokingPostProfilerStartCallback=function(){l.ULS.sendTraceTag(579465427,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Invoking the post profiler start callback")},e.prototype.logPostProfilerStopCallbackSpecified=function(){l.ULS.sendTraceTag(579465428,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"A callback for post profiler stop is specified")},e.prototype.logProfilerInstanceIsUndefined=function(){l.ULS.sendTraceTag(579465429,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Profiler instance is undefined. Is the profiler is being stopped without ever starting?")},e.prototype.logProfilerStopPromiseResolved=function(){l.ULS.sendTraceTag(579465430,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiler stop promise has been resolved successfully")},e.prototype.logProfilerStopPromiseRejected=function(e){l.ULS.sendTraceTag(579465431,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,JSON.stringify({promiseRejectionReason:e}))},e.prototype.logPostProfilerStopCallbackInvoked=function(){l.ULS.sendTraceTag(579465432,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Post profiler stop callback is being invoked")},e.prototype.logPostTimedStartProfilerStartCallbackInvoked=function(){l.ULS.sendTraceTag(579133791,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Post timed profiler start callback invoked")},e.prototype.logProfilingIntervalIsUndefined=function(){l.ULS.sendTraceTag(579133792,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Profiling interval is expected to be defined for timed profiler")},e.prototype.logTimerJobToStopProfilerSet=function(){l.ULS.sendTraceTag(579133793,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"A timer job to stop the profiler is created")},e.prototype.logTimedProfilerStopCallbackInvoked=function(){l.ULS.sendTraceTag(579133794,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Timed profiler is being stopped automatically")},e.prototype.logTimedProfilerIsBeingStoppedManually=function(){l.ULS.sendTraceTag(579133795,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"Timed profiler is being stopped manually")},e.prototype.logProfilerStartPromiseCreated=function(){l.ULS.sendTraceTag(579133824,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiler start promise has been created")},e.prototype.logProfilerStopGoingToBeInvoked=function(){l.ULS.sendTraceTag(579133825,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"A call to stop profiler is going to be invoked")},e.prototype.logSamplingIntervalUsedForStartingProfiler=function(e){l.ULS.sendTraceTag(578954321,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logMaxBufferSize=function(e){l.ULS.sendTraceTag(578954322,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logProfilerTypeToBuild=function(e){var t="";switch(e){case 0:t="ManualProfiler";break;case 1:t="TimedProfiler";break;case 2:t="ContinuousProfiler";break;case 3:t="FullSessionProfiler";break;default:l.ULS.sendTraceTag(578814813,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Missing profiler name to log for profilerType "+t)}l.ULS.sendTraceTag(578814814,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,t)},e.prototype.logProfilerInitOptions=function(e){l.ULS.sendTraceTag(578814815,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,JSON.stringify({samplingIntervalInMs:e.samplingIntervalInMs,maximumNumberOfSamplesToTake:e.maximumNumberOfSamplesToTake,profilingIntervalInMs:e.profilingIntervalInMs,idleIntervalInMs:e.idleIntervalInMs}))},e.prototype.logNoProfilerInstanceBuilt=function(){l.ULS.sendTraceTag(578814816,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"No instance of a profiler was built. Missing implementation?")},e.prototype.logProfilerInitOptionsValidationFailed=function(){l.ULS.sendTraceTag(578647639,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"ProfilerInitOptions validation failed")},e.prototype.logUnableToFixUpProfilerInitOptions=function(){l.ULS.sendTraceTag(578647640,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Unable to fixup profilerInitOptions")},e.prototype.logProfilingIsNotEnabled=function(){l.ULS.sendTraceTag(578647651,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling feature is not enabled")},e.prototype.logProfilingIsNotSupportedEnvironment=function(){l.ULS.sendTraceTag(578647680,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Profiling is not supported in the environment")},e.prototype.logFeatureCheckerIsNullOrUndefined=function(){l.ULS.sendTraceTag(578647681,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Feature checker is null or undefined")},e.prototype.logNullSupportedEnvironmentCheckerInvoked=function(){l.ULS.sendTraceTag(578090846,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"NullSupportedEnvironmentChecker was invoked")},e.prototype.logNullJSCPUProfilerInitOptionsValidatorInvoked=function(){l.ULS.sendTraceTag(578090847,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"NullJSCPUProfilerInitOptionsValidator was invoked")},e.prototype.logNullJSCPUProfilerFactoryInvoked=function(){l.ULS.sendTraceTag(578078354,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"NullJSCPUProfilerFactory createProfiler was invoked")},e.prototype.logNullOrUndefinedIdleInterval=function(){l.ULS.sendTraceTag(577884931,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"idleIntervalInMs is null or undefined. So killing the timer job")},e.prototype.logSiteNotCrossOriginIsolated=function(){l.ULS.sendTraceTag(577765505,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Site trying to create a profiler is not cross origin isolated")},e.prototype.logNoProfilerObserverSubscribed=function(){l.ULS.sendTraceTag(577597458,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Warning,"No profiler observer has been subscribed. The profile will not be sent for collection")},e.prototype.logCreateProfilerDidNotSubscribeProfilerObserver=function(){l.ULS.sendTraceTag(577597459,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"A profiler observer was never subscribed to the created profiler")},e.prototype.logProfilerTrace=function(e,t){l.ULS.sendTraceTag(577597460,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,JSON.stringify({deObfuscationInfo:t,customProperties:e.getCustomProperties(),resources:e.getResources(),frames:e.getFrames(),stacks:e.getStacks(),samples:e.getSamples()}))},e.prototype.logMissingAppName=function(){l.ULS.sendTraceTag(577573318,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Missing AppName. Without AppName, profile cannot be properly deobfuscated")},e.prototype.logMissingBuildVersion=function(){l.ULS.sendTraceTag(577573319,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Missing buildVersion, Without buildVersion, profile cannot be properly deobfuscated")},e.prototype.logNullOrUndefinedCustomPropertiesRetriever=function(){l.ULS.sendTraceTag(577565409,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Custom Properties retriever is null or undefined")},e.prototype.logNullOrUndefinedCustomProperties=function(){l.ULS.sendTraceTag(577565410,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Custom Properties is null or undefined")},e.prototype.logCustomPropertyKeyIsNull=function(){l.ULS.sendTraceTag(577565411,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"A custom property key is null")},e.prototype.logCustomPropertyValueIsNull=function(){l.ULS.sendTraceTag(577565440,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"A custom property value is null")},e.prototype.logRetrieveCallTreesCalledBeforeTransform=function(){l.ULS.sendTraceTag(577523926,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Transform should be called before retrieveCallTrees")},e.prototype.logRetrieveBuiltCallTreesBeforeBuildCallTrees=function(){l.ULS.sendTraceTag(577519904,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"BuildCallTrees should be called before retrieveBuiltCallTrees")},e.prototype.logRetrieveStacksCalledBeforeBuildStacks=function(){l.ULS.sendTraceTag(577381003,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"BuildStacks should be called before retrieveStacks")},e.prototype.logExecutionStacksNeverBuilt=function(){l.ULS.sendTraceTag(577304542,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Execution stacks were not built. Instead an empty array of stacks will be returned")},e.prototype.logPeekOnNullExecutionStackInvoked=function(){l.ULS.sendTraceTag(577304543,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Peek was invoked on Null ExecutionStack")},e.prototype.logPopOnNullExecutionStackInvoked=function(){l.ULS.sendTraceTag(577304544,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Pop was invoked on Null ExecutionStack")},e.prototype.logEmptyStacks=function(){l.ULS.sendTraceTag(577304546,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Stacks array is empty. No further processing can be performed.")},e.prototype.logEmptyFrames=function(){l.ULS.sendTraceTag(577304547,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Frames array is empty. No further processing can be performed.")},e.prototype.logForciblyExitingLoopWhileBuildingStack=function(){l.ULS.sendTraceTag(577304576,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"While loop is being forcibly exited because of a runaway while loop ")},e.prototype.logRetrieveStackCalledBeforeBuildStack=function(){l.ULS.sendTraceTag(577304577,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"BuildStack should be called before RetrieveStack")},e.prototype.logExecutionStackNeverBuilt=function(){l.ULS.sendTraceTag(577304578,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Built execution stack is undefined. So null execution stack will be returned")},e.prototype.logConvertStacksToCallTreesNeverCalled=function(){l.ULS.sendTraceTag(576579603,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Convert stacks to call trees was not called before retrieve call trees. Empty call trees will be returned")},e.prototype.logConvertStackToCallTreeNeverCalled=function(){l.ULS.sendTraceTag(576227350,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Convert stack to call tree was not called before retrieve call tree. Null call tree will be returned")},e.prototype.logNullFrameNodeCreated=function(){l.ULS.sendTraceTag(576024675,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"NullFrameNode created")},e.prototype.logNullCallTreeIteratorCreated=function(){l.ULS.sendTraceTag(576024704,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"NullCallTreeIterator created")},e.prototype.logInvalidSampleIndex=function(){l.ULS.sendTraceTag(575784139,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"sampleIndex needs to be greater than zero for proper indexing")},e.prototype.logInvalidFrameNodeStartTime=function(){l.ULS.sendTraceTag(575784140,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Invalid frame node starting time")},e.prototype.logInvalidFrameNodeExecutionTime=function(){l.ULS.sendTraceTag(575784141,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Invalid frame node execution time")},e.prototype.logInvalidNewFrameNodeExecutionTime=function(){l.ULS.sendTraceTag(575784142,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Invalid new frame node execution time")},e.prototype.logNegativeSubTreeExecutionTime=function(){l.ULS.sendTraceTag(575784143,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Negative sub tree execution time")},e.prototype.logFixerForProfilerType=function(e){l.ULS.sendTraceTag(575705692,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,e.toString())},e.prototype.logMissingProfilerInitOptionsFixerImplementation=function(){l.ULS.sendTraceTag(575705693,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Info,"Missing profiler init options fixer for unknown profiler type")},e.prototype.logLoopBackFixerFixProfilerInitOptionsInvoked=function(){l.ULS.sendTraceTag(574764573,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"LoopBackFixer fixProfilerInitOptions was invoked")},e.prototype.logLoopBackFixerRetrieveFixedProfilerInitOptionsInvoked=function(){l.ULS.sendTraceTag(574764574,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"LoopBackFixer retrieveFixedProfilerInitOptions was invoked")},e.prototype.logNullCallTreeGetBreadthFirstIteratorInvoked=function(){l.ULS.sendTraceTag(574681686,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"NullCallTree getBreadthFirstIterator was invoked")},e.prototype.logMissingDeObfuscationEndpoint=function(){l.ULS.sendTraceTag(573908487,l.LogCategory.msoulscat_Wac_Telemetry,l.TraceLevel.Error,"Null or undefined deObfuscation endpoint was provided")},e}(),Ue=function(){function e(e){this.logger=e}return e.prototype.retrieveProfilerFactory=function(){return this.logger.logNullJSCPUProfilerFactoryInvoked(),new ve(this.logger)},e}();!function(){function e(){this.logger=new ze}e.prototype.retrievePackage=function(e,t){var r=this,n=p.generateOperationResult({didOperationSucceed:!1,result:new Ue(this.logger)});return f.startNew("RetrieveCPUProfilingPackage",(function(n){if(null==t)return p.generateOperationResult({didOperationSucceed:!1,result:new Ue(r.logger)});if(null==t.ulsInstance)return p.generateOperationResult({didOperationSucceed:!1,result:new Ue(r.logger)});if(Object(l.initializeLogger)(t.ulsInstance),null==t.appName)return r.logger.logMissingAppName(),p.generateOperationResult({didOperationSucceed:!1,result:new Ue(r.logger)});if(null==t.buildVersion)return r.logger.logMissingBuildVersion(),p.generateOperationResult({didOperationSucceed:!1,result:new Ue(r.logger)});if(null==t.deObfuscationEndpoint)return r.logger.logMissingDeObfuscationEndpoint(),p.generateOperationResult({didOperationSucceed:!1,result:new Ue(r.logger)});null==t.callTreeFilteringThresholdInMs&&(t.callTreeFilteringThresholdInMs=50),null==t.shouldProfilingStartInAHiddenDocument&&(t.shouldProfilingStartInAHiddenDocument=!1),null==t.shouldProcessProfileCapturedInAHiddenDocument&&(t.shouldProcessProfileCapturedInAHiddenDocument=!1);return n.addProperty("AppName",t.appName),n.addProperty("BuildVersion",t.buildVersion),n.addProperty("DeObfuscationEndpoint",t.deObfuscationEndpoint),n.addProperty("CallTreeFilteringThresholdInMs",t.callTreeFilteringThresholdInMs),n.addProperty("ShouldProfilingStartInAHiddenDocument",t.shouldProfilingStartInAHiddenDocument),n.addProperty("ShouldProcessProfileCapturedInAHiddenDocument",t.shouldProcessProfileCapturedInAHiddenDocument),p.generateOperationResult({didOperationSucceed:!0,result:new _e(e,t,r.logger)})}),n).getResult()}}()},function(e,t,r){"use strict";var n=function(){function e(e,t,r,n,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.elementsMargin=n?"margin-left: 8px;":"margin-right: 8px;",this.toastElement=this.createToastContainer(t,r,i),e.appendChild(this.toastElement)}return e.prototype.setVisibility=function(e){this.toastElement.style.visibility=e?"visible":"hidden"},e.prototype.dispose=function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)},e.prototype.createToastContainer=function(e,t,r){var n=document.createElement("div");return n.id="UnavailabilityToast",n.setAttribute("role","alert"),n.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;'),n.appendChild(this.createToastIcon(r)),n.appendChild(this.createToastTitle(e)),n.appendChild(this.createToastText(t)),n},e.prototype.createToastIcon=function(e){var t=document.createElement("span");t.id="UnavailabilityToastIcon";var r=null!=e?e:this.OpenWorkbookIcon;return t.setAttribute("style",'display: inline-block;\n      height: 20px;\n      width: 20px;\n      background-repeat: no-repeat;\n      background-image: url("data:image/svg+xml;charset=utf8,'+r+'");'+this.elementsMargin),t},e.prototype.createToastTitle=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t},e.prototype.createToastText=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t},e}(),i=function(){function e(){}return e.createInstance=function(e,t,r,i,o){return new n(e,t,r,i,o)},e}();r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},function(e,t,r){"use strict";var n=r(7);r.d(t,"timeStamp",(function(){return n.d}));r(44)},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(48);t.GridBlockRendererFactoryGlobal=new n.GridBlockRendererFactory},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumFmtAccountingStartIndex=32,t.MaxBitsPerRenderFlag=32},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(23),i=r(24),o=r(28),a=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,r={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:e.Value,ifmt:e.Ifmt,formulaType:e.FormulaInfo?e.FormulaInfo.FormulaType:o.CellFormulaType.Value};return r.valueType=e.ValueType,r},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[n.cellLookupKey(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return i.isNullOrUndefined(this.Cells)?null:this.Cells[n.cellLookupKey(e,t)]},e.prototype.reset=function(){this.index=0,i.isNullOrUndefined(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if(i.isNullOrUndefined(this.Cells)||i.isNullOrUndefined(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36),i=r(23),o=r(24),a={},l={};function s(e,t,r){var n=e[r];if(n)for(var i=0;i<n.length;i++){var a=n[i];o.isNullOrUndefined(a)||u(a,t)}}function u(e,t){for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var o=r[i];c(e,n.SerializationProperties[y(t,o)],o)&&d(e,o)}}function d(e,t){v(e,t,void 0)}function c(e,t,r){if(o.isNullOrUndefined(t))return!1;if(t.ignoreOnSerialize)return!0;switch(t.type){case"number":return 0===C(e,r);case"boolean":return!1===C(e,r);case"object":return null===C(e,r)}return!1}function g(e,t,r){var n=e[r];if(n)for(var i=0;i<n.length;i++){var a=n[i];o.isNullOrUndefined(a)||p(a,t)}}Object.getOwnPropertyNames(n.SerializationProperties).forEach((function(e){var t=n.SerializationProperties[e],r=e.substring(e.indexOf(".")+1);t.ignoreOnSerialize?a[r]=!0:"boolean"===t.type&&(l[r]=!0)})),t.cleanModelBeforeSerialization=function(e){i.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),u(e,"GridBlockModel");for(var t=Object.keys(n.SerializationClasses),r=0;r<t.length;r++)s(e,t[r],n.SerializationClasses[t[r]])},t.restoreModelAfterSerialization=function(e){i.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),p(e,"GridBlockModel");for(var t=Object.keys(n.SerializationClasses),r=0;r<t.length;r++)g(e,t[r],n.SerializationClasses[t[r]])},t.cleanModelJsonReplacer=function(e,t){if(null!=t&&!(a[e]||l[e]&&!1===t))return t};var f={};function p(e,t){for(var r=function(e){var t=f[e];t||(t=Object.keys(n.SerializationProperties).filter((function(t){return t.startsWith(e)})),f[e]=t);return t}(t),i=0;i<r.length;i++){var o=r[i],a=o.substring(o.indexOf(".")+1),l=n.SerializationProperties[y(t,a)];h(e,l,a)&&m(e,l,a)}}function h(e,t,r){return t&&!t.ignoreOnSerialize&&void 0===C(e,r)}function m(e,t,r){switch(t.type){case"number":v(e,r,0);break;case"boolean":v(e,r,!1)}}function C(e,t){return e[t]}function v(e,t,r){e[t]=r}function y(e,t){return n.SerializationPropertyKey.replace("{className}",e).replace("{propertyName}",t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencySymbols="$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\sꃂ",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HitTestEvents=["pointerdown","pointerup","click","mouseenter","mouseleave","touchstart"],function(e){e[e.Headers=1]="Headers",e[e.Hyperlink=2]="Hyperlink",e[e.AutoFilter=3]="AutoFilter",e[e.DrillIndicator=4]="DrillIndicator",e[e.RichValueIcon=5]="RichValueIcon",e[e.RichError=6]="RichError",e[e.Comments=7]="Comments"}(t.RenderFeaturesZIndex||(t.RenderFeaturesZIndex={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24),i=r(36),o=r(23),a=i.comparisonIgnoreLists.GridBlockModel.concat(["Cells"]),l=i.comparisonIgnoreLists.Cell,s=l.concat(["Text"]),u=i.comparisonIgnoreLists.ReferencedObject,d=i.comparisonIgnoreLists.CellStyle.concat(u),c=i.comparisonIgnoreLists.TextRun.concat(["Fonts"]);function g(e,t,r,n){e.CachedStyle=o.getReferencedObjectToCache(e.StyleID,r.Styles),t.CachedStyle=o.getReferencedObjectToCache(t.StyleID,n.Styles),e.CachedBorderStyle=o.getReferencedObjectToCache(e.BorderStyleID,r.BorderStyles),t.CachedBorderStyle=o.getReferencedObjectToCache(t.BorderStyleID,n.BorderStyles),e.CachedFont=o.getReferencedObjectToCache(e.CachedStyle.FontID,r.Fonts),t.CachedFont=o.getReferencedObjectToCache(t.CachedStyle.FontID,n.Fonts);var i=o.isAccAndCustomNumFmtApplicable(e)&&o.isAccAndCustomNumFmtApplicable(t);v(e.TextRuns,t.TextRuns,r.Fonts,n.Fonts);var a=p(e,t,function(e){return(e?s:l).concat(["Row","Col"])}(i));return a.isEqual||(a.message+="\nareCellsEqual: cell1.Row = "+e.Row+", cell1.Col = "+e.Col+", cell2.Row = "+t.Row+", cell2.Col = "+t.Col),a}function f(e,t,r){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: "+e.length+", length2: "+t.length};for(var n=0;n<e.length;n++){var i=p(e[n],t[n],r);if(!i.isEqual)return i.message+="\nareArraysEqual: array objects are different. index: "+n,i}return{isEqual:!0}}function p(e,t,r){if(e===t)return{isEqual:!0};if(n.isNullOrUndefined(e)&&n.isNullOrUndefined(t))return{isEqual:!0};if(null==e||null==t)return{isEqual:!1,message:"areObjectsEqual: one object is null, o1 = "+!e+", o2 = "+!t};if(e!=e)return{isEqual:t!=t,message:"areObjectsEqual: NaN comparison"};var i=function(e,t){if(!e||!t)return e||t;var r=t.filter((function(t){return-1===e.indexOf(t)}));return e.concat(r)}(h(e,r),h(t,r));if(0===i.length)return y(e)&&y(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var o=0;o<i.length;o++){var a=i[o],l=e[a],s=t[a],u=typeof l,d=typeof s;if(!n.isNullOrUndefined(l)||!n.isNullOrUndefined(s)){if(u!==d){if(m(l)&&m(s))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = "+a+" type1 = "+u+", type2 = "+d}}switch(u){case"undefined":case"boolean":case"string":case"number":if(l!==s)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+a};break;case"object":if(l instanceof Array){if(!(s instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+a};if(!(c=f(l,s,C(a))).isEqual)return c.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+a,c}else{var c;if(!(c=p(l,s,C(a))).isEqual)return c.message+="\nareObjectsEqual: objects mismatch, propertyName = "+a,c}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: "+u+", propertyName = "+a}}}}return{isEqual:!0}}function h(e,t){if("object"!=typeof e)return[];var r=Object.getOwnPropertyNames(e);return t?r.filter((function(e){return-1===t.indexOf(e)})):r}function m(e){return null==e||""===e||!1===e}function C(e){var t=i.propertyToClassMap[e];if(t){for(var r=[],n=0;n<t.length;n++)r=r.concat(i.comparisonIgnoreLists[t[n]]);return r}}function v(e,t,r,n){if(e&&t&&e.length===t.length)for(var i=0;i<e.length;i++)e[i].CachedFont=o.getReferencedObjectToCache(e[i].FontID,r),t[i].CachedFont=o.getReferencedObjectToCache(t[i].FontID,n)}function y(e){if("object"==typeof e&&e.constructor===Object){for(var t in e)return!1;return!0}return!1}t.areGridBlockModelsEqual=function(e,t){var r=p(e,t,a);return r.isEqual&&(r=function(e,t,r,n){if(e===t)return{isEqual:!0};var i,a=e.length,l=t.length,s=0,u=0,d=o.getDefaultCell(-1,-1,r.Styles,r.Fonts);for(;s<a||u<l;){i=!0;var c=null;if(s>=a)c=g(d,t[u],n,n),u++;else if(u>=l)c=g(e[s],d,r,r),s++;else{var f=e[s],p=t[u];f.Row<p.Row||f.Row===p.Row&&f.Col<p.Col?(c=g(f,d,r,r),s++):f.Row!==p.Row||f.Col!==p.Col?(c=g(d,p,n,n),u++):(c=g(f,p,r,n),i=!1,s++,u++)}if(!c.isEqual){var h=c.message+"\nOne of the models contains a cell that doesn't exist in the other model";return c.message=i?h:c.message,c}}return{isEqual:!0}}(e.Cells,t.Cells,e,t)),r},t.areCellsEqual=g,t.areStylesEqual=function(e,t){return p(e,t,d)},t.areFormattedTextsEqual=function(e,t){if(e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};v(e.TextRuns,t.TextRuns,e.Fonts,t.Fonts)}return p(e,t,c)},t.areArraysEqual=f,t.testHelper={areObjectsEqual:function(e,t,r){return p(e,t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCellContainedInRange=function(e,t){return(!e.NamedObjectName&&!t.NamedObjectName||e.NamedObjectName===t.NamedObjectName)&&((!e.SheetName&&!t.SheetName||e.SheetName===t.SheetName)&&(e.FirstColumn<=t.FirstColumn&&e.LastColumn>=t.FirstColumn&&e.FirstRow<=t.FirstRow&&e.LastRow>=t.FirstRow))},t.getRangeTopLeftCell=function(e){return{SheetName:e.SheetName,NamedObjectName:e.NamedObjectName,FirstRow:e.FirstRow,FirstColumn:e.FirstColumn}},t.getRangeLog=function(e){return"("+e.FirstRow+"-"+e.LastRow+", "+e.FirstColumn+"-"+e.LastColumn+")"},t.getCellLog=function(e){return"("+e.FirstRow+","+e.FirstColumn+")"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalAlignmentFontSizeAdjusted=function(e){return 2*e/3}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(3),o=r(1);function a(e,t,r,n,i){var o=Math.min(n/4,16),a=Math.min(i/4,8),l=t+n/2-o/2,s=r+i/2-a/2;e.fillRect(l,s,o,a)}t.drawSkeleton=function(e,t,r){o.verifyArgumentNotNull(e,"ctx","drawSkeleton"),o.verifyArgumentNotNull(t,"model","drawSkeleton"),o.verifyArgumentNotNull(r,"context","drawSkeleton");var l=t.ClientOnlyCache;if(o.verifyArgumentNotNull(l,"ClientOnlyCache","drawSkeleton"),o.verifyArgumentNotNull(l.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(l.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(t.RowHeights,"RowHeights","drawSkeleton"),o.verifyArgumentNotNull(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(r.scaleFactor<n.MinimalScaleFactorForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=n.SkeletonColor;for(var s=0;s<l.RowOffsetsAdjustedForDrawing.length-1;s++)for(var u=l.RowOffsetsAdjustedForDrawing[s],d=i.getRowHeightFromOffsets(s,l.RowOffsetsAdjustedForDrawing),c=0;c<l.ColOffsetsAdjustedForDrawing.length-1;c++){a(e,i.getColOffsetsAdjustedForDrawing(c,t),u,i.getColWidthFromOffsets(c,l.ColOffsetsAdjustedForDrawing),d)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addWatermark=function(e,t){e.beginPath(),e.strokeStyle=t.modelFromCache?"blue":"red",e.lineWidth=1,e.setLineDash([]);var r=1*t.scaleFactor,n=5*t.scaleFactor;e.rect(r,r,n,n),e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(53),i=r(37);t.isRenderingCanvasElement=function(e,t){return t?e instanceof n.InteractableCanvasElement:e instanceof i.RenderingCanvasElement}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,o=r(12),a=r(0),l=r(30);!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}(n||(n={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(i||(i={}));var s=n.Inactive,u=i.Inactive,d={};function c(){var e=l.getServiceSetting(1,4e3);s=n.Cooldown,function(){if(u===i.Inactive){u=i.Cooldown;var e=l.getServiceSetting(2,6e4);setTimeout((function(){var e;e=JSON.stringify(d),a.ULS.sendTraceTag(574648710,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Info,"HitTest::Telemetry::sendMeasurementResults: "+e),d={},u=i.Inactive}),e)}}(),setTimeout((function(){s=n.Inactive}),e)}t.trackEventCallbackDuration=function(e,t){return function(){if(s===n.Inactive){var e=l.getServiceSetting(0,1e3);s=n.Active,setTimeout(c,e)}return s===n.Active}()?function(e,t){var r=o.perf?o.perf.now():-1,n=e();if(o.perf){var i=o.perf.now()-r;d[t]||(d[t]=[]),d[t].push(i)}return n}(e,t):e()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(56),a=r(5),l=r(91),s=r(1),u=r(92),d=r(8),c=r(9),g=r(97),f=r(15),p=r(98),h=r(25),m=r(42),C=r(10),v=r(11),y=r(1);function T(e,t,r,y,T,F,w){var x,b,I=y.DisplayFormula?n.VerticalAlignment.Bottom:y.CachedStyle.VerticalAlignment,R=d.getTextHorizontalPosition(r,y),O=d.getTextVerticalPosition(y,r,d.getTextLineHeight(y,r),w,I,void 0);!function(e,t,r,o,l){var u=f.getTextAlignment(o,r);t.textAlign!==u&&(t.textAlign=u,e.textAlign=u);var d=h.DefaultTextBaseline;d!==t.textBaseline&&(e.textBaseline=d,t.textBaseline=d);var c=s.getFontCssStringFromCell(r,o);t.fontProperties===c&&e.font===c||(t.fontProperties=c,e.font=c);var g=function(e,t){if(t)return i.getHighContrastTextColor(e,t);if(e.HasError)return a.FormulaErrorFontColor;return e.CachedFont.Color}(r,l);t.fontColor!==g&&(t.fontColor=g,e.fillStyle=g);var p=function(e,t){switch(e){case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.Context:return S(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(r.CachedStyle.ReadingOrder,o.IsRtl);p!==t.direction&&(t.direction=p,e.direction=p)}(e,T,y,r,t.highContrastScheme);var A=c.getCellWidth(r,y,!1),P=d.getDistanceFromCellStartToIconEnd(r,y),L=i.getTextDrawingMaxWidth(A,d.getCellTextHorizontalPaddingWithoutVisualElements(r,y),P,n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,r,!0)?v.getExpandCollapseButtonWidth(r,y):0);if(n.doesNumFmtOverrideText(y)){var M=L;g.updateNumberFormattingInformation(e,r,y,M),v.doesCellContainsHashesCFIconsAndExpandCollapse(r,y)&&(R=d.getTextHorizontalPosition(r,y))}var k=(null===(x=y.CachedStyle)||void 0===x?void 0:x.HorizontalAlignment)===n.HorizontalAlignment.Fill;k&&p.updateCachedDisplayTextForFill(e,r,y);var D=s.getDisplayText(y,r),N=s.getFormattedText(D,y,r);if(!y.DisplayFormula&&y.WrapText&&function(e,t){var r;if(C.isVerticalTextPresentSlice2(e,t))return!0;if(f.isHorizontalAlignmentJustifiedAndDistributed(t)||m.isVerticalAlignmentJustifyOrDistributed(null===(r=t.CachedStyle)||void 0===r?void 0:r.VerticalAlignment))return!(t.CachedIsTextWidthExceedsCellWidth&&t.ValueType===n.CellValueType.Number);return!(t.ValueType===n.CellValueType.Number)}(r,y)&&!k){var B=c.getCellLeft(r,y,r.BlockWidth),E=i.getContainerClipMaskWidth(A),W=c.isCellSpansMultipleRowsOrBlocks(y);u.drawWrapText(e,t,r,y,D,R,L,B,E,F,w,W,d.getTextLineHeight(y,r),N)}else if(y.Merge)!function(e,t,r,i,a,l,s,u,g,f,p){var h,m;if(i.Merge.Rows>0||a||d.getTextWidth(e,r,i)>=f||C.isVerticalTextPresentSlice2(r,i)){var v=c.getCellLeft(r,i,r.BlockWidth),y=c.getCellTop(r,i),T=c.getCellHeight(r,i,!1),S=void 0!==(null===(h=i.CondFormat)||void 0===h?void 0:h.Icon),F=d.getCellTextClipMask(r,v,y,s,T,p,S);o.fillTextClipped(e,t,l,u,g,F,i,r,(null===(m=i.CachedStyle)||void 0===m?void 0:m.HorizontalAlignment)===n.HorizontalAlignment.Fill,a)}else o.fillTextUnclipped(e,l,u,g,f,i,r,t.scaleFactor)}(e,t,r,y,N,D,A,R,O,L,P);else if(!y.DisplayFormula&&y.Spill)l.drawSpillCellText(e,t,r,y,D,R,O,F,w,k,P,N);else if(N||k||f.isHorizontalAlignmentCenteredAcrossSelection(y)||C.isVerticalTextPresent(r,y)||y.DisplayFormula){B=c.getCellLeft(r,y,r.BlockWidth);var H=c.getCellTop(r,y),_=void 0!==(null===(b=y.CondFormat)||void 0===b?void 0:b.Icon),z=d.getCellTextClipMask(r,B,H,A,w,P,_);o.fillTextClipped(e,t,D,R,O,z,y,r,k,N)}else o.fillTextUnclipped(e,D,R,O,L,y,r,t.scaleFactor)}function S(e){return e?"rtl":"ltr"}function F(e,t,r,n){return i.restoreClipping(r,n),w(e,t)}function w(e,t){return{fontColor:e?y.rgbToColorHex(e.TextColor):a.DefaultCellFontColor,fontProperties:"",direction:S(t),textBaseline:"bottom",textAlign:"start"}}t.drawCellsText=function(e,t,r){var o,l,u,d,g;s.verifyArgumentNotNull(e,"ctx","drawCellsText"),s.verifyArgumentNotNull(t,"model","drawCellsText"),s.verifyArgumentNotNull(r,"context","drawCellsText"),s.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawCellsText"),s.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),s.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawCellsText"),s.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),s.verifyArgumentNotNull(t.Cells,"model.Cells","drawCellsText"),s.verifyArgumentNotNull(t.Styles,"model.Styles","drawCellsText");for(var f=t.Cells,p=t.BlockWidth,h=[],m=function(e,t,r){var n=w(t,r.IsRtl);return e.direction=n.direction,e.fillStyle=n.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){e.getLineDash()!==[]&&e.setLineDash([])}(e),n}(e,r.highContrastScheme,t),C=void 0,v=-1,y=0;y<f.length;y++){if((b=f[y])&&b.Text&&((!n.isRenderFlagEnabled(n.RenderFlags.RichValueIcon,t)||0!==b.ShrunkSize&&0!==(null===(o=b.CachedFont)||void 0===o?void 0:o.Size))&&i.cellIntersectsRenderingRegion(b,r.renderingRegion)&&!(b.CondFormat&&(null===(l=b.CondFormat)||void 0===l?void 0:l.Icon)&&(null===(d=null===(u=b.CondFormat)||void 0===u?void 0:u.Icon)||void 0===d?void 0:d.IconOnly))&&(!n.isRenderFlagEnabled(n.RenderFlagsArray.FormulaView,t)||!r.isFormulaView||(null===(g=b.FormulaInfo)||void 0===g?void 0:g.FormulaType)!==n.CellFormulaType.ArrayFormula||b.FormulaInfo.IsArrayRoot))){var S=t.RowHeights[b.Row]-a.GridLineWidthPx,x=t.RowOffsets[b.Row];b.Row!==v&&(-1!==v&&(m=F(r.highContrastScheme,t.IsRtl,e,C)),C={x:0,y:x,width:p,height:S},i.applyClipping(e,C),v=b.Row),c.isCellSpansMultipleRowsOrBlocks(b)?h.push(b):T(e,r,t,b,m,x,S)}}for(i.restoreClipping(e,C),m=w(r.highContrastScheme,t.IsRtl),y=0;y<h.length;y++){var b=h[y],I=c.getCellHeight(t,b,!1)-a.GridLineWidthPx;T(e,r,t,b,m,c.getCellTop(t,b),I)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(61);t.classifyChar=function(e){return 8205===e?n.CombiningClass.ZWJ:13===e?n.CombiningClass.CR:10===e?n.CombiningClass.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?n.CombiningClass.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?n.CombiningClass.Extend:function(e){return 127462<=e&&e<=127487}(e)?n.CombiningClass.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?n.CombiningClass.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?n.CombiningClass.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?n.CombiningClass.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?n.CombiningClass.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?n.CombiningClass.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?n.CombiningClass.LV:n.CombiningClass.Other}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20),i=r(3);t.reorderTextTokensUsingDom=function(e,t,r,o){for(var a=i.getReOrderDiv(r,o),l=0;l<e.textLines.length;l++){var s=e.textLines[l],u=e.tokensPerLine[l],d=n.analyzeBidiText(s.text,t);if(r.HasBidi)if(d.HasRtl&&!d.HasLtr)u.tokens.reverse();else{(p=document.createElement("div")).setAttribute("textLineId",l.toString());for(var c=0;c<u.tokens.length;c++){var g=u.tokens[c].text;(y=document.createElement("span")).innerText=g,y.setAttribute("textTokenId",c.toString()),p.appendChild(y)}a.appendChild(p)}}document.body.appendChild(a);for(var f=0;f<a.children.length;f++){var p,h=(p=a.children[f]).getAttribute("textLineId");if(!h)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");for(var m=parseInt(h,10),C=e.tokensPerLine[m].tokens,v=0;v<p.children.length;v++){var y,T=(y=p.children[v]).getAttribute("textTokenId");if(!T)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");var S=y.getBoundingClientRect().left;C[c=parseInt(T,10)].OffsetX=S}C.sort((function(e,t){return e.OffsetX-t.OffsetX}))}document.body.removeChild(a)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(56),a=r(1),l=r(8),s=r(9),u=r(11);t.drawSpillCellText=function(e,t,r,d,c,g,f,p,h,m,C,v){var y;a.verifyArgumentNotNull(d.Spill,"cell.Spill","spillCells.drawSpillCellText");var T=s.getSpillCellWidth(d,r),S=n.isRenderFlagEnabled(n.RenderFlagsArray.AdvHAFillSpillCellBugFix,r,!0)&&m;if(d.Spill.IsSpillBlocked||v||(null===(y=d.CachedStyle)||void 0===y?void 0:y.HorizontalAlignment)===n.HorizontalAlignment.CenterAcrossSelection||S){var F=n.isRenderFlagEnabled(n.RenderFlags.RichValueIcon,r)?C:0,w=n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,r,!0)?u.getExpandCollapseButtonPadding(r,d):0,x=i.getClipMaskWidth(T,F,w),b={x:s.getSpillCellStartOffset(d,r,F,w),y:p,width:x,height:h};o.fillTextClipped(e,t,c,g,f,b,d,r,m,v)}else{var I=n.isRenderFlagEnabled(n.RenderFlags.RichValueIcon,r)?l.getCellTextHorizontalPaddingWithoutVisualElements(r,d):l.getCellTextHorizontalPadding(d,r),R=n.isRenderFlagEnabled(n.RenderFlags.RichValueIcon,r)?C:l.getDistanceFromCellStartToIconEnd(r,d),O=i.getTextDrawingMaxWidth(T,I,R,n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,r,!0)?u.getExpandCollapseButtonPadding(r,d):0);o.fillTextUnclipped(e,c,g,f,O,d,r,t.scaleFactor)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(27),o=r(2),a=r(8),l=r(22),s=r(19),u=r(93),d=r(96),c=r(40),g=r(5),f=r(6),p=r(63),h=r(15),m=r(42),C=r(10),v=r(62);function y(e,t,r,n,i,o,a,l){var s=l?e+t-r-n:e-r;return a&&(s=m.getAdvancedVerticalAlignmentOffsetYForWrapText(s,i,o)),s}function T(e,t,r,n){return e&&!t.HasRtl?0===r:r===n-1}t.drawWrapText=function(e,t,r,S,F,w,x,b,I,R,O,A,P,L){var M,k,D,N,B=C.isVerticalTextPresentSlice2(r,S),E=C.isVerticalTextPresentSlice3(r,S),W=B?n.getTextDrawingMaxHeight(O,v.getVerticalTextPadding(null===(M=S.CachedStyle)||void 0===M?void 0:M.Indentation)):O;if(!(x<=0||W<=0)){var H=E?P:e.measureText(g.Whitespace).width,_=S.WrapText,z=function(e,t){var r,n;if(C.isVerticalTextPresentSlice3(e,t))return function(e){switch(e){case o.VerticalAlignment.Justify:return i.BreakType.Justify;case o.VerticalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}(null===(r=t.CachedStyle)||void 0===r?void 0:r.VerticalAlignment);return function(e){switch(e){case o.HorizontalAlignment.Justify:return i.BreakType.Justify;case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)}(r,S),U=(B?W:x)-a.getWrapTextAdditionalPadding(r,S);z===i.BreakType.Distributed&&(U-=a.getIndentationPaddingPx(S.CachedStyle.Indentation||0));var j=u.breakTextToLines(e,F,U,z,H,r,S,L,_),V=a.getBidiContext(S);B&&p.adjustOrderingOfLinesForVerticalText(S,j,V);var G=j.textLines,J=function(e,t,r,n){var i=[],o=[],l=[];o=[0],l=[0];var u=0;if(r)for(var d=0;d<t.length;d++){var c=t.length-1-d,g=t[c],f=s.substringFormattedText(r,g.startIndex,g.endIndex);i[d]=f;var p=a.getFormattedTextLineFontMetrics(e,f);l[d]=p.baseline;var h=a.getFormattedTextLineHeight(e,f);o[d+1]=o[d]+h,u+=h}else o=function(e,t){for(var r=[],n=0;n<e;n++)r.push(n*t);return r}(t.length,n),u=n*t.length;return{rowsBottomY:o,rowsAlphabeticY:l,textHeight:u,formattedLines:i}}(r,G,L,P),q=J.rowsBottomY,X=J.rowsAlphabeticY,Y=J.textHeight,Q=J.formattedLines,K=j.requireClipping||A||function(e,t,r,n){return e&&t<r*n}(B,I,P,G.length),Z={x:b,y:R,width:I,height:O},$=void 0;K&&($=Z);var ee=e.textAlign,te=e.textBaseline,re=!1;h.isHorizontalAlignmentJustifiedAndDistributed(S)&&!B&&(e.textAlign="left",e.textBaseline="alphabetic",re=!0,V.HasRtl&&c.reorderTextTokens(j,null===(k=S.CachedStyle)||void 0===k?void 0:k.ReadingOrder,V,U));var ne=E?null===(D=S.CachedStyle)||void 0===D?void 0:D.VerticalAlignment:m.getEffectiveVerticalAlignment(null===(N=S.CachedStyle)||void 0===N?void 0:N.VerticalAlignment,m.AdvVerticalAlignmentFormat.WrapText,O,Y,P,G.length,S.DisplayFormula),ie=E?C.isVerticalAlignmentJustifiedOrDistributedForVerticalText(r,S):m.isVerticalAlignmentJustifyOrDistributed(ne),oe=ie&&G.length>1&&!E?m.getAdvancedVerticalAlignmentLineGapHeightForWraptext(O,Y,G.length):0;!function(e,t){t&&n.applyClipping(e,t)}(e,$);var ae=X[0],le=a.getTextVerticalPosition(S,r,Y,O,ne,ae),se=t.scaleFactor,ue=B?p.getOffsetXForVerticalText(r,S,w,P,G.length):w,de=0;C.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(r,S)&&(de=p.getSpaceWidthBetweenLines(r,S,ue,G.length,P));for(var ce=function(e,t,r,n,i){var o;if(e)return a.getTextVerticalPosition(t,r,n,i,null===(o=t.CachedStyle)||void 0===o?void 0:o.VerticalAlignment,void 0);return 0}(B,S,r,P,O),ge=0;ge<G.length;ge++){var fe=G.length-1-ge,pe=G[fe],he=pe.text;B&&ge>0&&(ue+=P+de);var me=B?ce:y(le,ae,q[ge],X[ge],oe,ge,ie,!f.isNullOrUndefined(L));if(z===i.BreakType.Wrap)p.drawTextLine(e,t,r,S,K,he,ue,me,x,Q[ge],Z),L||B||l.cacheTextDecorationLayout(r,S,{textPositionX:ue,textPositionY:me,scaleFactor:se,textWidth:pe.underlineWidth,clipRect:Z},S.CachedFont);else{var Ce={breakType:z,singleSpaceWidth:H,maxWidth:U,isProcessingLastLine:T(E,V,fe,G.length),isCompleteTextVisible:Y<O,lineDirection:E?i.LineDirection.Vertical:i.LineDirection.Horizontal};d.drawJustifyOrDistributedTextLine(e,t,r,S,j,fe,ue,Ce,K,me,U,Q[ge],Z,he,me,!f.isNullOrUndefined(L))}}re&&(e.textAlign=ee,e.textBaseline=te),function(e,t){n.restoreClipping(e,t)}(e,$)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(1),o=r(94),a=r(95),l=r(5),s=r(2),u=r(19),d=r(27),c=r(8),g=r(10);function f(e,t){(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth)&&(A(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width);e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function p(e,t,r,n,i,l){if(t.type!==o.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),A(e));for(var s=l?u.substringFormattedText(l,t.start,t.start+t.len):void 0,d=e.isVerticalText?a.breakWideWordVerticalText(t.value,e.maxWidth,e.textLineHeight):a.breakWideWord(n,t.value,e.maxWidth,i,s),c=t.start,g=0;g<d.length-1;g++){var f=d[g],p={text:f.value,width:f.size,underlineWidth:f.size,startIndex:c,endIndex:c+f.value.length};if(c+=f.value.length,e.textLines.push(p),e.isBreakTypeJustifyOrDistributed){var h=L(f.value);e.tokensPerLine.push({tokens:[{text:f.value,width:f.size,start:c,containsThaiCharacters:h}],containsThaiCharacters:h}),M(e,h)}e.isSingleCharTooWide=b(p.width,p.text.length,e.maxWidth,e.isSingleCharTooWide)}var m,C,y,T,S,F=(C=t,y=(m=d)[m.length-1],T=C.start+C.len-y.value.length,S=y.size,{start:T,len:y.value.length,value:y.value,type:o.BreakOpTokenType.Word,width:S});e.lastFittingToken=F,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(F),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else v(e,t,r)}function h(e,t,r){void 0!==e.lastFittingToken&&A(e);var n=function(e){switch(e.type){case o.BreakOpTokenType.HardBreak:return e.len;case o.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==r&&r!==e.tokens.length-1&&n--;for(var i=0;i<n;i++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.textLines.push(m(i,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function m(e,t){var r=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:r,endIndex:r+function(e){return e.type===o.BreakOpTokenType.HardBreakCRLF?l.HardBreakCRLF.length:l.HardBreak.length}(t)}}function C(e,t,r){if(R(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,r){if(x(e.tokens,r),!S(e,r))return!1;return r===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||w(e,t,r)}(e,t,r)?e.curLineWidth+t.width>e.maxWidth||w(e,t,r)?v(e,t,r):(e.curLineWidth+=t.width,e.lastFittingToken=t):F(e,t)}function v(e,t,r){R(t);var n=t.width/t.len,i=e.maxWidth-e.curLineWidth;if(!(i<0)){var o=Math.floor(i/n);t.width=n*o,e.curLineWidth+=t.width,e.lastFittingToken=t,(T(e.tokens,r)||S(e,r))&&F(e,t)}}function y(e,t){if(x(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function T(e,t){return x(e,t),y(e,t),0===t&&e[t].type===o.BreakOpTokenType.Space}function S(e,t){var r=e.tokens;return x(r,t),t>0&&r[t].type===o.BreakOpTokenType.Space&&O(r[t-1])&&void 0===e.lastFittingToken}function F(e,t){if(t.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var r=n.__assign({},l.EmptyLine),i=t.start+t.len;r.underlineWidth=t.width,r.startIndex=t.start,r.endIndex=i,e.textLines.push(r),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.curLineStart=i,e.curLineWidth=0,e.lastFittingToken=void 0}function w(e,t,r){if(R(t),r>=e.tokens.length-1)return!1;var n=e.tokens[r+1];return e.curLineWidth+t.width+n.width>e.maxWidth}function x(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function b(e,t,r,n){if(n)return!0;if(e>r){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return n}function I(e,t){return e.width<t}function R(e){if(e.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function O(e){return e.type===o.BreakOpTokenType.HardBreak||e.type===o.BreakOpTokenType.HardBreakCRLF}function A(e,t){void 0===t&&(t=0),i.verifyArgumentNotNull(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var r=e.curLineWidth-t,n=r;if(e.lastFittingToken.type===o.BreakOpTokenType.Space&&(n-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){var a=function(e){for(var t=[],r=!1,n=0;n<e.length;n++){var i=e[n],o=L(i.value);t.push({text:i.value,width:i.width,start:i.start,containsThaiCharacters:o}),o&&!r&&(r=!0)}return{tokens:t,containsThaiCharacters:r}}(e.unprocessedTokens);e.tokensPerLine.push(a),M(e,a.containsThaiCharacters),e.unprocessedTokens=[]}var l=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e),s=l.text,u=l.start,d=l.end;e.textLines.push({text:s,underlineWidth:r,width:n,startIndex:u,endIndex:d})}function P(e){for(var t,r,n={tokens:[],containsThaiCharacters:!0},i=void 0,o=0;o<e.length;o++){var a=e[o];L(a.text)?i?(r=a,i={text:(t=i).text+r.text,width:t.width+r.width,start:t.start,containsThaiCharacters:t.containsThaiCharacters||r.containsThaiCharacters}):i=a:(i&&(n.tokens.push(i),i=void 0),n.tokens.push(a))}return i&&n.tokens.push(i),n}function L(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(r>=l.MinUnicodeThaiRange&&r<=l.MaxUnicodeThaiRange)return!0}return!1}function M(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}t.breakTextToLines=function(e,t,r,n,a,l,u,m,v){if(i.verifyArgumentNotNull(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};for(var S,F=g.isVerticalTextPresentSlice2(l,u),w=F?c.getTextLineHeight(u,l):0,x=o.tokenizeTextToWrap(e,t,a,l,F,w,m,v),R={text:t,tokens:x,maxWidth:r,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(S=n,S===d.BreakType.Justify||S===d.BreakType.Distributed),containsThaiCharacters:!1,isVerticalText:F,textLineHeight:w},L=0;L<x.length;L++){var M=x[L];if(y(x,L),O(M))h(R,M,L);else if(I(M,r)){if(M.type===o.BreakOpTokenType.Space&&!T(x,L)){C(R,M,L);continue}f(R,M)}else p(R,M,L,e,l,m)}if(void 0!==R.lastFittingToken&&function(e){A(e),e.isSingleCharTooWide=b(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(R),R.isBreakTypeJustifyOrDistributed&&R.textLines.length!==R.tokensPerLine.length)throw new Error("breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = "+R.tokensPerLine.length+", textLineLength = "+R.textLines.length+", MaxWidth = "+r+", Text = "+s.annonymize(R.text));return R.isBreakTypeJustifyOrDistributed&&(null==v?void 0:v.BreakOp)&&R.containsThaiCharacters&&(R.tokensPerLine=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];n.containsThaiCharacters?t.push(P(n.tokens)):t.push(n)}return t}(R.tokensPerLine)),{textLines:R.textLines,tokensPerLine:R.tokensPerLine,requireClipping:R.isSingleCharTooWide}},t.testCombineThaiTokensPerLine=function(e){return P(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(5),o=r(19),a=r(8);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(n=t.BreakOpTokenType||(t.BreakOpTokenType={}));var l="1".charCodeAt(0);function s(e,t,r,n,i,l,s,u){return s?n?a.measureTextRunsHeightForVerticalText(e,n.TextRuns,n.Text,t,l,i).totalSize:a.measureTextHeightForVerticalText(u,r):n?o.measureFormattedTextWidth(e,n,t):function(e,t,r,n){if(n)return r*t.length;return e.measureText(t).width}(e,r,i,l)}function u(e){switch(e){case i.Whitespace:return n.Space;case i.HardBreak:return n.HardBreak;case i.HardBreakCRLF:return n.HardBreakCRLF}return n.Word}function d(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?i.HardBreakCRLF:e[t]}function c(e,t){return t===n.HardBreakCRLF?e+2:e+1}function g(e,t,r){return!(!t||r!==n.Word||e>t.length-1)&&t.charCodeAt(e)===l}t.tokenizeTextToWrap=function(e,t,r,i,a,l,f,p){for(var h=[],m=0,C=r,v=null==p?void 0:p.BreakOp;m<t.length;){for(var y=u(d(t,m)),T=c(m,y),S=d(t,T),F=u(S);T<t.length&&y===F&&!g(T,v,y);)F=u(S=d(t,T=c(T,y)));var w=T-m,x=t.substring(m,T),b=f?o.substringFormattedText(f,m,T):void 0,I=0;switch(y){case n.Word:case n.Space:I=s(e,i,x,b,C,y===n.Space,a,l);break;case n.HardBreak:case n.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}h.push({start:m,len:w,value:x,type:y,width:I}),m=T}return h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(19),o=r(33),a=function(){function e(e,t,r,n,i){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=r,this.wordFormattedText=i,this.model=n}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=i.measureFormattedTextWidth(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=i.substringFormattedText(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!0,configurable:!0}),e}(),l=function(){function e(e,t,r,n){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=n,this.model=r}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new a(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t},e}();function s(e,t,r,o,a){if(0!==t.length){var s=new l(e,t,o,a),u={width:r,value:"IGNORED"},d=n.binarySearch(s,0,t.length,u,(function(e,t){return e.width-t.width}));d<0&&0!==(d=~d)&&(d-=1);var c=s.item(d);return{width:c.width,value:c.value,remaining:t.substring(c.value.length),formattedRemaining:a?i.substringFormattedText(a,c.value.length):void 0}}}t.breakWideWord=function(e,t,r,n,i){for(var o=[],a=s(e,t,r,n,i);a;)o.push({value:a.value,size:a.width}),a=s(e,a.remaining,r,n,a.formattedRemaining);return o},t.breakWideWordVerticalText=function(e,t,r){for(var n=[],i=o.breakToGraphemes(e),a=r,l=i[0],s=1;s<i.length;s++)a+r>t?(n.push({value:l,size:a}),a=r,l=i[s]):(a+=r,l+=i[s]);return l&&a>0&&n.push({value:l,size:a}),n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),i=r(15),o=r(63),a=r(40),l=r(22);function s(e,t,r,i,o){var a=r,l=i;return e.lineDirection===n.LineDirection.Horizontal?a=o+t.Offset:e.lineDirection===n.LineDirection.Vertical&&(l=o-t.Offset),{textPortionOffsetX:a,textPortionOffsetY:l}}t.drawJustifyOrDistributedTextLine=function(e,t,r,u,d,c,g,f,p,h,m,C,v,y,T,S){var F=d.tokensPerLine[c].tokens,w=f.lineDirection===n.LineDirection.Horizontal?i.adjustXForHorizontalAlignment(r,u,g,m):h;if(C)o.drawTextLine(e,t,r,u,p,y,g,h,m,C,v,F,f);else{var x=a.getStartOffset(f,F),b=a.getJustifyDistributedLine(f,F,a.getSpaceWidthBetweenWords(F,f),x);if(b){var I=s(f,b.Start,g,h,w),R=I.textPortionOffsetX,O=I.textPortionOffsetY;if(o.drawTextLine(e,t,r,u,p,b.Start.Text,R,O,m,C,v),b.Middle){var A=s(f,b.Middle,g,h,w),P=A.textPortionOffsetX,L=A.textPortionOffsetY;o.drawTextLine(e,t,r,u,p,b.Middle.Text,P,L,m,C,v)}if(b.End){var M=s(f,b.End,g,h,w),k=M.textPortionOffsetX,D=M.textPortionOffsetY;o.drawTextLine(e,t,r,u,p,b.End.Text,k,D,m,C,v)}if(!S&&f.lineDirection!==n.LineDirection.Vertical){var N=d.textLines[c],B=function(e,t,r,i,o){switch(e){case n.BreakType.Justify:return i?t.underlineWidth:r;case n.BreakType.Distributed:return i&&1===o?t.underlineWidth:r;case n.BreakType.Wrap:default:return t.underlineWidth}}(f.breakType,N,f.maxWidth,f.isProcessingLastLine,F.length);l.cacheTextDecorationLayout(r,u,{scaleFactor:t.scaleFactor,textPositionX:f.lineDirection===n.LineDirection.Horizontal?w+x:g,textPositionY:T,textWidth:B,clipRect:v},u.CachedFont)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=r(8),a=r(6),l=r(20),s=r(1),u=r(31),d=r(10),c=r(26),g=r(12);function f(e,t,r,n){var i=o.getNumFmtHashWidth(e,n,t);i<0&&g.setRenderingResultWarning("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+i+" MeasuredWidth: "+c.getFontNameForLogging(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);var a=h(e,n,t,r,i,!0),l="";return l+="#".repeat(a)}function p(e,t,r,o,a){var l,s,d,g,f,p=!!a&&u.isFontValid(null===(l=r.CachedFont)||void 0===l?void 0:l.FontName),h=!!p&&u.documentFontsCheck(i.getFontCssStringFromCell(r,t));return n.annonymize(null===(s=r.NumFmt)||void 0===s?void 0:s.Separator)+" CachedWidth: "+o+" MeasuredWidth: "+e.measureText(null===(d=r.NumFmt)||void 0===d?void 0:d.Separator).width+", IsSpace: "+(" "===(null===(g=r.NumFmt)||void 0===g?void 0:g.Separator))+", FontName:"+c.getFontNameForLogging(r.CachedFont.FontName)+", FontSize:"+r.CachedFont.Size+", Length: "+(null===(f=r.NumFmt)||void 0===f?void 0:f.Separator).length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return document.contains(e.canvas)}catch(e){return!1}}(e)+", isFontValid: "+p+", FontLoadCheck: "+h}function h(e,t,r,i,l,s){var u=0;if(n.isRenderFlagEnabled(n.RenderFlagsArray.FixingNumFmtHashesString,t,!0)&&r.CachedFont.Italic&&s){var d=o.getOverhangHashWidth(e,t,r);u=Math.max(Math.floor((i-d)/l),0)}else u=Math.max(Math.floor(i/l),0);return(a.isNullOrUndefined(u)||isNaN(u)||u===1/0)&&(g.setRenderingResultWarning("calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: "+u+", cellWidth: "+i+", hashWidth: "+l+" "),u=0),u}t.updateNumberFormattingInformation=function(e,t,r,c){var m,C,v,y,T,S;if(i.verifyArgumentNotNull(r,"cell","updateNumberFormattingInformation"),i.verifyArgumentNotNull(r.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),i.verifyArgumentNotNull(t,"model","updateNumberFormattingInformation"),!d.isVerticalTextPresent(t,r)){var F=n.isRenderFlagEnabled(n.RenderFlags.AdvancedTextMetrics,t),w=n.isRenderFlagEnabled(n.RenderFlags.MeasureTextWidthUseNewRegex,t);if(a.isNullOrUndefined(r.NumFmt)||a.isNullOrUndefined(r.NumFmt.Separator)||""===r.NumFmt.Separator){if((w?Math.round(o.getTextWidth(e,t,r)):o.getTextWidth(e,t,r))>c&&!s.cellHasShrinkToFit(r)){R=f(e,r,c,t);n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,t,!0)&&R===r.CachedDisplayText||(r.CachedIsTextWidthExceedsCellWidth=!0,i.setCellCachedDisplayText(r,R),o.cacheLegacyTextWidthOnCell(e,t,r))}}else{var x=void 0;!a.isNullOrUndefined(r.Text)&&a.isNullOrUndefined(null===(m=r.CachedStyle)||void 0===m?void 0:m.ReadingOrder)&&l.analyzeBidiText(r.Text,null===(C=r.CachedStyle)||void 0===C?void 0:C.ReadingOrder).HasRtl&&(x=e.direction,e.direction="rtl");var b=o.measureTextWidth(e,null===(v=r.NumFmt)||void 0===v?void 0:v.Start,F,w),I=o.measureTextWidth(e,null===(y=r.NumFmt)||void 0===y?void 0:y.End,F,w);if(b+I>c&&!s.cellHasShrinkToFit(r)){var R=f(e,r,c,t);i.setCellCachedDisplayText(r,R),o.cacheLegacyTextWidthOnCell(e,t,r)}else{var O=o.getNumFmtSeparatorWidth(e,t,r),A=n.isRenderFlagEnabled(n.RenderFlags.NumFmtNewFontAPI,t);if(!u.fontFaceSetSupported())return;var P=A?u.isValidCellFontLoaded(t,r):u.isFontLoaded(null===(T=r.CachedFont)||void 0===T?void 0:T.FontName);if(n.isRenderFlagEnabled(n.RenderFlags.MeasureTextAfterFontDownload,t)&&0===O&&!P)return;var L=n.isRenderFlagEnabled(n.RenderFlagsArray.NumFmtIgnoreWidthZeroError,t,!0);if(0===O){if(L)return void g.setRenderingResultWarning("updateNumberFormattingInformation:: Invalid SeparatorWidth."+p(e,t,r,O,A));throw Error("updateNumberFormattingInformation:: Invalid SeparatorWidth."+p(e,t,r,O,A))}var M=h(e,t,r,c-b-I,O,"#"===(null===(S=r.NumFmt)||void 0===S?void 0:S.Separator)),R=function(e,t,r,i,o,a,l){var s=i.Start||"";try{s+=i.Separator.repeat(o),s+=i.End||""}catch(o){if(n.isRenderFlagEnabled(n.RenderFlagsArray.NumFmtIgnoreWidthZeroError,t,!0))return g.setRenderingResultWarning("buildNumFmtText:: Invalid separatorCount."+p(e,t,r,a,l)),i.Start||""+i.End||"";throw Error("buildNumFmtText:: Invalid separatorCount."+p(e,t,r,a,l))}return s}(e,t,r,r.NumFmt,M,O,A);i.setCellCachedDisplayText(r,R)}x&&(e.direction=x)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(1),a=r(8),l=r(9),s=r(6),u=r(20),d=r(12),c=r(11);t.updateCachedDisplayTextForFill=function(e,t,r){var g,f,p=r.Text;if(p){var h=void 0;if(!s.isNullOrUndefined(r.Text)&&s.isNullOrUndefined(null===(g=r.CachedStyle)||void 0===g?void 0:g.ReadingOrder))u.analyzeBidiText(r.Text,null===(f=r.CachedStyle)||void 0===f?void 0:f.ReadingOrder).HasRtl&&(h=e.direction,e.direction="rtl");var m=function(e,t){var r=t.Spill?l.getSpillCellWidth(t,e):l.getCellWidth(e,t,!1);return i.getTextDrawingMaxWidth(r,a.getCellTextHorizontalPadding(t,e),a.getDistanceFromCellStartToIconEnd(e,t),n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)?c.getExpandCollapseButtonPadding(e,t):0)}(t,r),C=a.measureTextWidth(e,p,!1,n.isRenderFlagEnabled(n.RenderFlags.MeasureTextWidthUseNewRegex,t)),v=Math.floor(m/C);v<1&&(v=1),(void 0===v||isNaN(v)||v===1/0)&&(d.setRenderingResultWarning("updateCachedDisplayTextForFill: Invalid count variable. repeatCount: "+v+", maxTextWidth: "+m+", textWidth: "+C+" "),v=1);var y=p.repeat(v);o.setCellCachedDisplayText(r,y),h&&(e.direction=h)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(3),o=r(9),a=r(1),l=r(6),s=r(5),u=r(100);function d(e,t,r,i,a){var l=o.getCellDimensionsAdjustedForDrawing(t,r,!1);if(i===n.Gradient)return u.fillCellWithGradientBackground(e,r.CachedStyle.Gradient,l,a);var d=function(e,t){if(t===n.FormulaParseError)return s.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}(r,i);return a!==d&&(e.fillStyle=d),e.fillRect(l.x,l.y,l.width,l.height),d}function c(e){return e.HasError?n.FormulaParseError:l.isNullOrUndefined(e.CachedStyle.Gradient)?l.isNullOrUndefined(e.CachedStyle.BackgroundColor)?n.None:n.Solid:n.Gradient}t.drawBackgroundFill=function(e,t,r){if(a.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),a.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),a.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawBackgroundFill"),a.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),a.verifyArgumentNotNull(t.Cells,"model.Cells","drawBackgroundFill"),a.verifyArgumentNotNull(t.Styles,"model.Styles","drawBackgroundFill"),!r.highContrastScheme){for(var l,s=t.Cells,u=[],g=0;g<s.length;g++){(p=c(f=s[g]))!==n.None&&(i.cellIntersectsRenderingRegion(f,r.renderingRegion)&&(o.isCellSpansMultipleRowsOrBlocks(f)?u.push([f,p]):l=d(e,t,f,p,l)))}for(g=0;g<u.length;g++){var f,p,h=u[g];l=d(e,t,f=h[0],p=h[1],l)}}},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1);function o(e,t,r,o){i.verifyArgumentNotNull(r,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var a=function(e,t){var r=t.x,i=t.y,o=t.width,a=t.height;switch(e){case n.GradientShadingStyle.Vertical:case n.GradientShadingStyle.Center:case n.GradientShadingStyle.TopRightCorner:return{x0:r,y0:0,x1:r+o,y1:0};case n.GradientShadingStyle.ReversedVertical:case n.GradientShadingStyle.TopLeftCorner:return{x0:r+o,y0:0,x1:r,y1:0};case n.GradientShadingStyle.Horizontal:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:i,x1:0,y1:i+a};case n.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:i+a,x1:0,y1:i};case n.GradientShadingStyle.DiagonalUp:case n.GradientShadingStyle.DiagonalDown:case n.GradientShadingStyle.ReversedDiagonalUp:case n.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var r=t.width*t.width,i=t.height*t.height,o=r+i,a=t.x+t.width/2,l=t.y+t.height/2,s=t.width*i/o,u=r*t.height/o;switch(e){case n.GradientShadingStyle.DiagonalUp:break;case n.GradientShadingStyle.DiagonalDown:s=-s;break;case n.GradientShadingStyle.ReversedDiagonalUp:u=-u;break;case n.GradientShadingStyle.ReversedDiagonalDown:s=-s,u=-u;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:a-s,y0:l-u,x1:a+s,y1:l+u}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,o),l=e.createLinearGradient(a.x0,a.y0,a.x1,a.y1),s=0;s<r.length;s++)l.addColorStop(r[s].Position,r[s].Color);return l}t.fillCellWithGradientBackground=function(e,t,r,i){var a=o(e,t.ShadingStyle,t.Stops,r);return a!==i&&(e.fillStyle=a),e.fillRect(r.x,r.y,r.width,r.height),function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(a=e.fillStyle=o(e,function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:return n.GradientShadingStyle.ReversedHorizontal;case n.GradientShadingStyle.BottomLeftCorner:return n.GradientShadingStyle.ReversedVertical;case n.GradientShadingStyle.BottomRightCorner:return n.GradientShadingStyle.Vertical;case n.GradientShadingStyle.Center:return n.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,r),function(e,t,r){var i=r.x,o=r.y,a=r.width,l=r.height;switch(e.beginPath(),e.moveTo(i,o),e.lineTo(i+a,o),t){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.BottomRightCorner:e.lineTo(i+a,o+l);break;case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:e.lineTo(i,o+l);break;case n.GradientShadingStyle.Center:e.lineTo(i,o+l),e.lineTo(i+a,o+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(i,o)}(e,t.ShadingStyle,r),e.fill()),a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),i=r(9),o=r(3),a=r(2),l=r(1),s=r(12),u=r(11),d=r(17),c=r(10),g=r(6);function f(e,t,r,n,i,o){return e+i<t?r:r*function(e,t,r,n,i){var o=e+n;if(i){return Math.max(t-n,0)/(e+r)}return t/(o+r)}(e,t,n,i,o)}function p(e,t,r){return n.getFontLineHeight(e,r,t.CachedFont.FontName)*t.CachedDisplayText.length}t.updateCellShrinkToFit=function(e,t,r){c.isVerticalTextPresentSlice2(t,r)?function(e,t){var r=t.CachedFont.Size,n=p(e,t,r),o=i.getCellHeight(e,t,!1);t.ShrunkSize=function(e,t,r,n){var i=Math.floor(n),o=p(e,t,i);if(i<d.MinAllowedFontSize)return d.MinAllowedFontSize;for(;o<r&&i<d.MaxAllowedFontSize;)o=p(e,t,i+=1);for(;o>r&&i>d.MinAllowedFontSize;)o=p(e,t,i-=1);return i}(e,t,o,f(n,o,r,0,0,!1))}(t,r):function(e,t,r){var d,c=l.getFontCssStringFromFont(r.CachedFont,void 0,t);e.font=c;var p=n.getTextWidthNoCaching(e,t,r),h=i.getCellWidth(t,r,!1),m=r.CachedStyle.Indentation||0,C=r.CachedFont.Size,v=n.getHorizontalPadding(t,r,C,r.CachedFont.Italic,m,!0,0,0),y=a.isRenderFlagEnabled(a.RenderFlags.RichValueIcon,t)&&!g.isNullOrUndefined(null===(d=r.LinkedEntity)||void 0===d?void 0:d.IconWidth),T=u.getIconSizeAndPadding(t,r,C),S=o.getTextDrawingMaxWidth(h,v,0,0);r.ShrunkSize=f(p,S,C,v,T,y),r.ShrunkSize<0&&s.setRenderingResultWarning("\n    ShrinkSize was calculated to be negative: "+r.ShrunkSize+",\n    textWidth: "+p+",\n    cellWidth: "+h+",\n    cellIndentation "+m+",\n    maxTextWidth: "+S+",\n    originalFontSize: "+C+",\n    padding: "+v+"\n    ");if(a.isRenderFlagEnabled(a.RenderFlagsArray.PivotTable,t,!0)&&r.ShrunkSize&&r.ShrunkSize>0){var F=l.getFontCssStringFromFont(r.CachedFont,r.ShrunkSize,t);e.font=F,n.getTextWidth(e,t,r)}}(e,t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(3),o=r(13),a=r(34),l=r(5),s=r(104),u=r(105),d=r(11),c=r(106),g=r(107),f=r(108),p=r(109),h=r(110),m=r(111),C=r(66),v=r(112),y=r(113),T=r(67),S=r(14);function F(e,t,r,l,S){var F=function(e,t,r,i){var a=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:n.getActualFontSize(t),l=d.getIconSize(a,r),s=t.CondFormat.Icon,c=o.IconImageLookup[s.Set][s.Index],g=u.getIconLeftPosition(e,t,l,a,r),f=u.getIconVerticalPosition(e,t,r,l);return{size:l,image:c,left:g,bottom:f,highContrastScheme:i}}(t,r,l,S),w=T.getClipRect(t,r,F.left,F.bottom,F.size);switch(i.applyClipping(e,w),F.image){case o.CFIconImage.CircleLow:case o.CFIconImage.CircleMedium:case o.CFIconImage.CircleHigh:case o.CFIconImage.CircleEmpty:case o.CFIconImage.CircleFilled:case o.CFIconImage.FourCircleHigh:case o.CFIconImage.FourCircleLow:case o.CFIconImage.FourCircleMedium1:case o.CFIconImage.FourCircleMedium2:case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:a.drawCircleIcon(e,F);break;case o.CFIconImage.CircleSymbolHigh:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolLow:y.drawCircledSymbols(e,F);break;case o.CFIconImage.TrafficHigh:case o.CFIconImage.TrafficMedium:case o.CFIconImage.TrafficLow:s.drawTrafficLightRimmed(e,F);break;case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:case o.CFIconImage.SignalBarMedium1:case o.CFIconImage.SignalBarMedium2:case o.CFIconImage.SignalBarHigh:c.drawSignalBar(e,F);break;case o.CFIconImage.QuadrantEmpty:case o.CFIconImage.Quadrant25:case o.CFIconImage.QuadrantHalf:case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:g.drawQuadrantBoxes(e,F);break;case o.CFIconImage.FlagHigh:case o.CFIconImage.FlagMedium:case o.CFIconImage.FlagLow:f.drawFlag(e,F);break;case o.CFIconImage.TriangleHigh:case o.CFIconImage.TriangleMedium:case o.CFIconImage.TriangleLow:p.drawTriangleSet(e,F);break;case o.CFIconImage.StarHigh:case o.CFIconImage.StarMedium:case o.CFIconImage.StarLow:h.drawStarIcon(e,F);break;case o.CFIconImage.SignLow:case o.CFIconImage.SignMedium:m.drawSigns(e,F);break;case o.CFIconImage.SymbolHigh:case o.CFIconImage.SymbolMedium:case o.CFIconImage.SymbolLow:C.drawSymbols(e,F);break;case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowDownRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:v.drawArrows(e,F);break;default:throw Error("drawConditionalFormattingIcon: imageType: "+F.image+" not supported")}i.restoreClipping(e,w)}t.drawConditionalFormattingIcons=function(e,t,r){var o;n.verifyArgumentNotNull(e,"ctx","drawConditionalFormattingIcons"),n.verifyArgumentNotNull(t,"model","drawConditionalFormattingIcons"),n.verifyArgumentNotNull(r,"context","drawConditionalFormattingIcons");var a=t.Cells;a.length>0&&(e.lineWidth=S.ShapeOutlineWidthPx,e.setLineDash(l.DefaultDash));for(var s=null!==r.highContrastScheme?r.highContrastScheme:void 0,u=0;u<a.length;u++){var d=a[u];(null===(o=null==d?void 0:d.CondFormat)||void 0===o?void 0:o.Icon)&&(i.cellIntersectsRenderingRegion(d,r.renderingRegion)&&F(e,t,d,r.scaleFactor,s))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(13),o=r(3),a=r(14);!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(n=t.FillType||(t.FillType={})),t.getHighContrastFillingType=function(e){switch(e){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return n.FillPortion;case i.CFIconImage.CircleLow:case i.CFIconImage.CircleEmpty:case i.CFIconImage.FourCircleHigh:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolHigh:return n.Empty;case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleFilled:return n.Full;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:return n.Stripes;case i.CFIconImage.FourCircleLow:case i.CFIconImage.FourCircleMedium1:case i.CFIconImage.FourCircleMedium2:return n.InnerCircle;default:throw Error("getHighContrastFillingType: image: "+e+" not supported")}},t.getInnerCircleRadius=function(e,t){switch(e){case i.CFIconImage.FourCircleMedium2:return t*i.CircleHighContrastSmallRadiusPortion;case i.CFIconImage.FourCircleMedium1:return t*i.CircleHighContrastMediumRadiusPortion;case i.CFIconImage.FourCircleLow:return t*i.CircleHighContrastLargeRadiusPortion;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}},t.drawStripes=function(e,t,r,n,l){e.strokeStyle=l,e.beginPath();var s={p1:{x:t+n*Math.cos(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment,y:r+n*Math.sin(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+n*Math.cos(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment,y:r+n*Math.sin(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment}},u={p1:{x:t+n*Math.cos(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment,y:r+n*Math.sin(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+n*Math.cos(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment,y:r+n*Math.sin(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment}},d={p1:{x:t+n*Math.cos(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment,y:r+n*Math.sin(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+n*Math.cos(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment,y:r+n*Math.sin(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment}};o.drawLine(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),o.drawLine(e,u.p1.x,u.p1.y,u.p2.x,u.p2.y),o.drawLine(e,d.p1.x,d.p1.y,d.p2.x,d.p2.y),e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(18),a=r(34),l=r(16);t.drawTrafficLightRimmed=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawTrafficLightRimmed"),n.verifyArgumentNotNull(t,"drawingContext","drawTrafficLightRimmed");var r=t.size,s=r;r%2==0&&(s=r-1);var u={left:t.left,bottom:t.bottom,outerColor:function(e){return e?n.rgbToColorHex(e.TextColor):l.TrafficHighRimmedRectColor}(t.highContrastScheme),height:s,width:s,innerColor:void 0};o.drawRectangle(e,u),t.size=s;var d=function(e){var t=e.image,r=e.left,n=e.bottom,o=e.highContrastScheme,a=e.size-2*i.CirclePaddingFromBoundariesPx,l=r+i.CirclePaddingFromBoundariesPx+.5,s=n-i.CirclePaddingFromBoundariesPx-.5;return{size:a,left:l,bottom:s,image:t,highContrastScheme:o}}(t);a.drawCircleIcon(e,d)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(8),o=r(9),a=r(11),l=r(13),s=r(1),u=r(42),d=r(15),c=r(32);t.getIconVerticalPosition=function(e,t,r,d){var c,g=u.getEffectiveVerticalAlignment(null===(c=t.CachedStyle)||void 0===c?void 0:c.VerticalAlignment,u.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),f=function(e,t,r,n,a){var l=i.getTextVerticalPosition(t,e,i.getTextLineHeight(t,e),o.getCellHeight(e,t,!1),a,void 0),u=i.getMiddleBaseline(e,l,t.CachedFont,s.getActualFontSize(t))*r+.5*n;return Math.round(u)}(e,t,r,d,g),p=t.CondFormat.Icon.IconOnly,h=o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding,m=o.getCellTopAdjustedForDrawing(e,t)+l.MinimalIconPadding+d;switch(g){case n.VerticalAlignment.Bottom:return p?h:a.adjustNumberToRange(f,m,h);case n.VerticalAlignment.Top:return p?m:a.adjustNumberToRange(f,m,h);case n.VerticalAlignment.Center:return p||function(e,t,r,n){if(o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding<r)return!0;if(o.getCellTopAdjustedForDrawing(e,t)+l.MinimalIconPadding>r+n)return!0;return!1}(e,t,f,d)?Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)+d/2):f;default:throw Error("getIconVerticalPosition: Vertical alignment "+g+" is not supported in CF Icon!")}},t.getIconLeftPosition=function(e,t,r,i,l){var s,u;return(null===(u=null===(s=t.CondFormat)||void 0===s?void 0:s.Icon)||void 0===u?void 0:u.IconOnly)?function(e,t,r,i,l){var s=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(s){case n.HorizontalAlignment.Right:var u=a.getIconHorizontalPadding(i,l)+function(e,t,r,i){if(!n.isRenderFlagEnabled(n.RenderFlagsArray.PivotTable,e,!0)||!t.PivotTable||!t.PivotTable.HasExpandCollapseIndicator)return 0;if(!c.canCellContainExpandCollapseAndCFIcon(e,t,o.getCellWidthAdjustedForDrawing(e,t),i))return 0;if(r===n.HorizontalAlignment.Right)return a.getExpandCollapseButtonPadding(e,t)*i;return 0}(e,t,s,l)+r;return Math.floor(o.getCellRightAdjustedForDrawing(e,t)-u);case n.HorizontalAlignment.Fill:case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Distributed:case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1)+a.getIconHorizontalPadding(i,l));case n.HorizontalAlignment.Center:return Math.floor(o.getCellCenterXAdjustedForDrawing(e,t)-r/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: "+s)}}(e,t,r,i,l):(n.isRenderFlagEnabled(n.RenderFlagsArray.CFIconsWithCAS,e,!0)&&d.isHorizontalAlignmentCenteredAcrossSelection(t)&&t.Spill?o.getSpillCellLeftAdjustedForDrawing(e,t):o.getCellLeftAdjustedForDrawing(e,t,!1))+a.getIconHorizontalPadding(i,l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(18),o=r(13),a=r(16),l=r(3),s=r(14);function u(e,t,r,i){var o=i.left,l=i.bottom;return{innerColor:t,outerColor:function(e){if(e)return n.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(i.highContrastScheme),bottom:l,left:o+r*(e+1),height:r*(e+2),width:r}}t.drawSignalBar=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawSignalBar"),n.verifyArgumentNotNull(t,"drawingContext","drawSignalBar");for(var r=t.image,d=t.size,c=t.highContrastScheme,g=Math.floor(d/5),f=function(e,t){var r=function(e){if(e)return n.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t),i=function(e){if(e)return n.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t);switch(e){case o.CFIconImage.SignalBarEmpty:return[r,r,r,r];case o.CFIconImage.SignalBarLow:return[i,r,r,r];case o.CFIconImage.SignalBarMedium1:return[i,i,r,r];case o.CFIconImage.SignalBarMedium2:return[i,i,i,r];case o.CFIconImage.SignalBarHigh:return[i,i,i,i];default:throw Error("getBarsColors: image: "+e+" not supported")}}(r,c),p=0;p<f.length;p++){var h=u(p,f[p],g,t);i.drawRectangle(e,h)}c&&function(e,t,r,i){var a=r.left,u=r.bottom,d=r.highContrastScheme,c=function(e,t,r,n){for(var i=function(e){switch(e){case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:return 0;case o.CFIconImage.SignalBarMedium1:return 1;case o.CFIconImage.SignalBarMedium2:return 2;case o.CFIconImage.SignalBarHigh:return 3;default:throw Error("getSeperators: image: "+e+" not supported")}}(e),a=[],l=r-2*n+s.ShapeLinesAdjustment,u=t+2*n+s.ShapeLinesAdjustment,d=0;d<i;d++)a.push({X:u,startY:l,endY:r-1.5}),l-=n,u+=n;return a}(e,a,u,i);t.strokeStyle=n.rgbToColorHex(d.BackgroundColor),t.beginPath();for(var g=0;g<c.length;g++)l.drawLine(t,c[g].X,c[g].startY,c[g].X,c[g].endY);t.stroke()}(r,e,t,g)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(18),o=r(13),a=r(16),l=r(3),s=r(14);function u(e,t,r,i,o){var l=o.left,s=o.bottom;return{innerColor:r,outerColor:function(e){if(e)return n.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(o.highContrastScheme),bottom:s-e*i,left:l+t*i,height:i,width:i}}t.drawQuadrantBoxes=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawQuadrantBoxes"),n.verifyArgumentNotNull(t,"drawingContext","drawQuadrantBoxes");for(var r=t.image,d=t.size,c=t.highContrastScheme,g=Math.floor(d/2),f=function(e,t){var r=function(e){if(e)return n.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t),i=function(e){if(e)return n.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t);switch(e){case o.CFIconImage.QuadrantEmpty:return[[i,i],[i,i]];case o.CFIconImage.Quadrant25:return[[r,i],[i,i]];case o.CFIconImage.QuadrantHalf:return[[r,r],[i,i]];case o.CFIconImage.Quadrant75:return[[r,r],[r,i]];case o.CFIconImage.QuadrantFull:return[[r,r],[r,r]];default:throw Error("getBoxesColors: image: "+e+" not supported")}}(r,c),p=0;p<f.length;p++)for(var h=0;h<f.length;h++){var m=u(p,h,f[p][h],g,t);i.drawRectangle(e,m)}c&&function(e,t,r,i){var a=t.left,u=t.bottom,d=t.highContrastScheme,c=a+r+s.ShapeLinesAdjustment,g=u-r-s.ShapeLinesAdjustment,f=function(e,t,r,n){switch(e){case o.CFIconImage.QuadrantEmpty:return[];case o.CFIconImage.Quadrant25:return[{x:t,y:r+n-s.ShapeLinesAdjustment},{x:t-n+s.ShapeLinesAdjustment,y:r}];case o.CFIconImage.QuadrantHalf:return[{x:t+n,y:r},{x:t,y:r+n-s.ShapeLinesAdjustment},{x:t-n+s.ShapeLinesAdjustment,y:r}];case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:return[{x:t,y:r-n+s.ShapeLinesAdjustment},{x:t+n-s.ShapeLinesAdjustment,y:r},{x:t,y:r+n-s.ShapeLinesAdjustment},{x:t-n+s.ShapeLinesAdjustment,y:r}];default:throw Error("getSeparatorsCoordinates: image: "+e+" not supported")}}(i,c,g,r);e.strokeStyle=n.rgbToColorHex(d.BackgroundColor),e.beginPath();for(var p=0;p<f.length;p++)l.drawLine(e,c,g,f[p].x,f[p].y);e.stroke()}(e,t,g,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(18),a=r(16),l=r(3),s=r(5),u=r(14);function d(e,t){var r,n,o,a,s,d,c,g,f,p=t.outerColor,h=(n=(r=t).left,o=r.bottom,a=r.width,s=r.height,d=s/2,c={x:n+a+u.ShapeLinesAdjustment,y:o-d-u.ShapeLinesAdjustment},g=n+a-d/i.QuarterPiTan+u.ShapeLinesAdjustment,f=o-s-u.ShapeLinesAdjustment,{p1:c,p2:{x:g,y:f}}),m=function(e){var t=e.left,r=e.bottom,n=e.width/2,o={x:t+n+u.ShapeLinesAdjustment,y:r-u.ShapeLinesAdjustment},a=r-n*i.QuarterPiTan-u.ShapeLinesAdjustment,l={x:t+u.ShapeLinesAdjustment,y:a};return{p1:o,p2:l}}(t);e.strokeStyle=p,e.beginPath(),l.drawLine(e,h.p1.x,h.p1.y,h.p2.x,h.p2.y),l.drawLine(e,m.p1.x,m.p1.y,m.p2.x,m.p2.y),e.stroke()}t.drawFlag=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawFlags"),n.verifyArgumentNotNull(t,"drawingContext","drawFlags");var r=t.image,c=t.size,g=t.left,f=t.bottom,p=t.highContrastScheme,h=Math.floor(c/2),m=Math.floor(c/3),C=function(e,t){if(t)return function(e,t){if(e===i.CFIconImage.FlagHigh)return n.rgbToColorHex(t.TextColor);return}(e,t);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case i.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case i.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(r,p),v=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case i.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case i.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(r,p);!function(e,t,r,n,a,l){var s=l.left,u=l.bottom,c=l.image,g=l.highContrastScheme,f={left:s,bottom:u-t,outerColor:a,height:t,width:r,innerColor:n};o.drawRectangle(e,f),c===i.CFIconImage.FlagMedium&&g&&d(e,f)}(e,h,m,C,v,t),function(e,t,r,n,a,l){var s=l.left,u=l.bottom,c=l.size,g=l.image,f=l.highContrastScheme,p=Math.floor(c/8),h={left:s+r,bottom:u-t+p,outerColor:a,height:t,width:r,innerColor:n};o.drawRectangle(e,h),g===i.CFIconImage.FlagMedium&&f&&d(e,h)}(e,h,m,C,v,t),function(e,t,r,o,d){var c=o-u.ShapeLinesAdjustment,g=c-r,f=t+u.ShapeLinesAdjustment;e.lineWidth=i.FlagPoleWidth,e.setLineDash(s.DefaultDash),e.strokeStyle=function(e){return e?n.rgbToColorHex(e.TextColor):a.FlagPoleColor}(d),e.beginPath(),l.drawLine(e,f,c,f,g),e.stroke()}(e,g,2*h,f,p)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(16),a=r(65),l=r(18),s=r(14);function u(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowOuterColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumOuterColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighOuterColor;default:throw Error("getTriangleOuterColor: unsupported image type = "+e)}}function d(e,t){if(t)return n.rgbToColorHex(t.BackgroundColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowInnerColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumInnerColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighInnerColor;default:throw Error("getTriangleInnerColor: unsupported image type = "+e)}}t.drawTriangleSet=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawTriangleSet"),n.verifyArgumentNotNull(t,"drawingContext","drawTriangleSet");var r=t.image,o=t.size,c=t.left,g=t.bottom,f=t.highContrastScheme;switch(r){case i.CFIconImage.TriangleHigh:case i.CFIconImage.TriangleLow:var p=function(e){var t=e.image,r=e.left,n=e.bottom,o=e.size,a=e.highContrastScheme,l=Math.floor(o/2),c=Math.floor(o/4),g=n-c-s.ShapeLinesAdjustment,f=r+s.ShapeLinesAdjustment;switch(t){case i.CFIconImage.TriangleHigh:return{outerColor:u(t,a),innerColor:d(t,a),left:f,bottom:g,height:l,width:o};case i.CFIconImage.TriangleLow:return{outerColor:u(t,a),innerColor:d(t,a),left:r+s.ShapeLinesAdjustment,bottom:n-c-l-s.ShapeLinesAdjustment,height:l,width:o};default:throw Error("getTriangleDrawingContext: unsupported image type = "+t)}}(t);a.drawTriangle(e,p,r===i.CFIconImage.TriangleLow);break;case i.CFIconImage.TriangleMedium:var h=Math.floor(o/3),m={left:c,outerColor:u(r,f),innerColor:d(r,f),bottom:g-h,height:h,width:o};l.drawRectangle(e,m);break;default:throw Error("drawTriangleSet: unsupported image type = "+r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(16),a=r(21),l=r(14);t.drawStarIcon=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawStarIcon"),n.verifyArgumentNotNull(t,"drawingContext","drawStarIcon");var r=t.image,s=t.size,u=t.left,d=t.bottom,c=t.highContrastScheme,g=Math.floor(s/2);if(!(g<=1)){var f=function(e,t,r){var n=r*i.StarInset,o=e+r+.5,a=t-r,s=n*i.StarRotationSin,u=n*i.StarRotationCos,d=r*i.StarRotation2Sin,c=n*i.StarRotation2Sin,g=n*i.StarRotation2Cos,f=r*i.StarRotationSin,p=r*i.StarRotationCos,h=Math.floor(u)+l.ShapeLinesAdjustment,m=a+(u-h),C=m-u,v=m+g,y=m+p;return{topOuter:{x:o,y:m-r},topRightInner:{x:o+s,y:C},topRightOuter:{x:o+d,y:C},middleRightInner:{x:o+c,y:v},bottomRightOuter:{x:o+f,y:y},bottomInner:{x:o,y:m+n},bottomLeftOuter:{x:o-f,y:y},middleLeftInner:{x:o-c,y:v},topLeftOuter:{x:o-d,y:C},topLeftInner:{x:o-s,y:C}}}(u,d,g),p=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return n.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:return;default:throw Error("getStarLeftInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledInnerColor;case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = "+e)}}(r,c),h=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledOuterColor;case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = "+e)}}(r,c),m=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:return n.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:case i.CFIconImage.StarMedium:return;default:throw Error("getStarRightInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledInnerColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = "+e)}}(r,c),C=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledOuterColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = "+e)}}(r,c),v=r===i.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,f),v&&(a.fillAndStroke(e,m,C),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,f),a.fillAndStroke(e,p,h)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(13),o=r(16),a=r(65),l=r(21),s=r(14);function u(e,t){if(!t)switch(e){case i.CFIconImage.SignLow:return o.SignLowInnerColor;case i.CFIconImage.SignMedium:return o.SignMediumInnerColor;default:throw Error("getInnerColor: unsupported image type = "+e)}}function d(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SignLow:return o.SignLowOuterColor;case i.CFIconImage.SignMedium:return o.SignMediumOuterColor;default:throw Error("getOuterColor: unsupported image type = "+e)}}t.drawSigns=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawSigns"),n.verifyArgumentNotNull(t,"drawingContext","drawSigns");var r=t.image;switch(r){case i.CFIconImage.SignLow:!function(e,t){var r=t.image,n=t.highContrastScheme,i=u(r,n),o=d(r,n),a=function(e){var t=e.size,r=e.left,n=e.bottom,i=Math.floor(t/2),o=r+i+s.ShapeLinesAdjustment,a=n-i-s.ShapeLinesAdjustment;return{top:{x:o,y:a-i},right:{x:o+i,y:a},bottom:{x:o,y:a+i},left:{x:o-i,y:a}}}(t);e.beginPath(),e.moveTo(a.top.x,a.top.y),e.lineTo(a.right.x,a.right.y),e.lineTo(a.bottom.x,a.bottom.y),e.lineTo(a.left.x,a.left.y),e.lineTo(a.top.x,a.top.y),l.fillAndStroke(e,i,o)}(e,t);break;case i.CFIconImage.SignMedium:var o=function(e){var t=e.left,r=e.bottom,n=e.size,i=e.highContrastScheme,o=e.image,a=t+s.ShapeLinesAdjustment,l=r-s.ShapeLinesAdjustment,c=u(o,i);return{outerColor:d(o,i),innerColor:c,left:a,bottom:l,height:n,width:n}}(t);a.drawTriangle(e,o,!1);break;default:throw Error("drawSigns: unsupported image type = "+r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(16),o=r(13),a=r(21),l=r(14);function s(e){var t=Math.round(o.ArrowWidthRatio*e);return t=t%2!=0?t+1:t}function u(e){var t=Math.round(o.ArrowHeightRatio*e);return t=t%2!=0?t+1:t}t.drawArrows=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawArrows"),n.verifyArgumentNotNull(t,"drawingContext","drawArrows");var r=t.image,d=t.size,c=t.left,g=t.bottom,f=t.highContrastScheme,p=function(e,t){if(t)return n.rgbToColorHex(t.TextColor);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayOuterColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpOuterColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownOuterColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightOuterColor;default:throw Error("getArrowOuterColor: unsupported image type = "+e)}}(r,f),h=function(e,t){if(t)return function(e,t){switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return n.rgbToColorHex(t.TextColor);case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return n.rgbToColorHex(t.BackgroundColor);default:throw Error("getArrowHighContrastInnerColor: unsupported image type = "+e)}}(e,t);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayInnerColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpInnerColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownInnerColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightInnerColor;default:throw Error("getArrowInnerColor: unsupported image type = "+e)}}(r,f),m=[];switch(r){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.ColoredArrowDown:m=function(e,t,r){var n=o.ArrowHeightRatio*r,i=s(r),a=Math.floor(r/2+e)+l.ShapeLinesAdjustment,u=Math.round(t),d=a+n*Math.cos(-3*o.ArrowAngle),c=u+n*Math.sin(-3*o.ArrowAngle),g=d+i*Math.cos(-o.ArrowAngle),f=c+i*Math.sin(-o.ArrowAngle),p=a-i/2,h=f+n/2*Math.sin(o.ArrowAngle),m=h-n,C=p+i,v=m,y=C,T=h,S=a+(a-g),F=f,w=a+(a-d),x=c,b={x:a,y:u},I={x:d,y:c},R={x:g,y:f},O={x:p,y:h},A={x:p,y:Math.round(m)-l.ShapeLinesAdjustment},P={x:C,y:Math.round(v)-l.ShapeLinesAdjustment};return[b,I,R,O,A,P,{x:y,y:T},{x:S,y:F},{x:w,y:x},b]}(c,g,d);break;case o.CFIconImage.GrayArrowUp:case o.CFIconImage.ColoredArrowUp:m=function(e,t,r){var n=t-r,i=o.ArrowHeightRatio*r,a=s(r),u=Math.floor(r/2+e)+l.ShapeLinesAdjustment,d=Math.round(n),c=u+i*Math.cos(3*o.ArrowAngle),g=d+i*Math.sin(3*o.ArrowAngle),f=c+a*Math.cos(o.ArrowAngle),p=g+a*Math.sin(o.ArrowAngle),h=u-a/2,m=p+i/2*Math.sin(-o.ArrowAngle),C=m+i,v=h+a,y=C,T=v,S=m,F=u+(u-f),w=p,x=u+(u-c),b=g,I={x:u,y:d},R={x:c,y:g},O={x:f,y:p},A={x:h,y:m},P={x:h,y:Math.round(C)-l.ShapeLinesAdjustment},L={x:v,y:Math.round(y)-l.ShapeLinesAdjustment};return[I,R,O,A,P,L,{x:T,y:S},{x:F,y:w},{x:x,y:b},I]}(c,g,d);break;case o.CFIconImage.GrayArrowRight:case o.CFIconImage.ColoredArrowRight:m=function(e,t,r){var n=t-r,i=o.ArrowHeightRatio*r,a=s(r),u=Math.round(e+r),d=Math.floor(r/2+n)+l.ShapeLinesAdjustment,c=u+i*Math.cos(-3*o.ArrowAngle),g=d+i*Math.sin(-3*o.ArrowAngle),f=c+a*Math.cos(3*o.ArrowAngle),p=g+a*Math.sin(3*o.ArrowAngle),h=f+i/2*Math.cos(o.ArrowAngle),m=d-a/2,C=h-i,v=m,y=C,T=v+a,S=h,F=d+(d-m),w=f,x=d+(d-p),b=c,I=d+(d-g),R={x:u,y:d},O={x:c,y:g},A={x:f,y:p},P={x:h,y:m},L={x:Math.round(C)+l.ShapeLinesAdjustment,y:v},M={x:Math.round(y)+l.ShapeLinesAdjustment,y:T};return[R,O,A,P,L,M,{x:S,y:F},{x:w,y:x},{x:b,y:I},R]}(c,g,d);break;case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.ColoredArrowDownRight:m=function(e,t,r){var n=t-r,i=Math.round(o.ArrowWidthRatio*r),a=u(r),s=Math.floor(o.ArrowDownRightTipXRatio*r+e)+l.ShapeLinesAdjustment,d=Math.floor(o.ArrowDownRightTipYRatio*r+n)+l.ShapeLinesAdjustment,c=s,g=d-a,f=c-i,p=g,h=f,m=d-i-i/Math.sqrt(2),C=h+a*Math.cos(-3*o.ArrowAngle),v=m+a*Math.sin(-3*o.ArrowAngle),y=C+i*Math.cos(3*o.ArrowAngle),T=v+i*Math.sin(3*o.ArrowAngle),S=s-a,F=d,w=S,x=F-i,b=s-i-i/Math.sqrt(2),I={x:s,y:d};return[I,{x:c,y:g},{x:f,y:p},{x:h,y:m},{x:C,y:v},{x:y,y:T},{x:b,y:x},{x:w,y:x},{x:S,y:F},I]}(c,g,d);break;case o.CFIconImage.GrayArrowUpRight:case o.CFIconImage.ColoredArrowUpRight:m=function(e,t,r){var n=t-r,i=Math.round(o.ArrowWidthRatio*r),a=u(r),s=Math.floor(o.ArrowUpRightTipXRatio*r+e)+l.ShapeLinesAdjustment,d=Math.floor(o.ArrowUpRightTipYRatio*r+n)+l.ShapeLinesAdjustment,c=s-a,g=d,f=c,p=g+i,h=s-i-i/Math.sqrt(2),m=p,C=h+a*Math.cos(3*o.ArrowAngle),v=m+a*Math.sin(3*o.ArrowAngle),y=C+i*Math.cos(o.ArrowAngle),T=v+i*Math.sin(o.ArrowAngle),S=s,F=d+a,w=S-i,x=F,b=w,I=d+i+i/Math.sqrt(2),R={x:s,y:d};return[R,{x:c,y:g},{x:f,y:p},{x:h,y:m},{x:C,y:v},{x:y,y:T},{x:b,y:I},{x:w,y:x},{x:S,y:F},R]}(c,g,d);break;default:throw Error("drawArrows: unsupported image type = "+r)}a.drawIconFromPoints(e,h,p,m)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(34),o=r(66);t.drawCircledSymbols=function(e,t){n.verifyArgumentNotNull(e,"ctx","drawCircleSymbols"),n.verifyArgumentNotNull(t,"drawingContext","drawCircleSymbols"),t.size>0&&(i.drawCircleIcon(e,t),o.drawSymbols(e,function(e){var t=e.left,r=e.bottom,n=e.image,i=e.highContrastScheme,o=e.size,a=Math.round(t),l=Math.round(r);return{size:Math.round(o),left:a,bottom:l,image:n,highContrastScheme:i}}(t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(115),i=r(116),o=r(117),a=r(118),l=r(119),s=r(120),u=r(121),d=r(122),c=r(123),g=!1;t.loadPolyFills=function(){g||(n.loadStringRepeat(),i.loadStringTrimRight(),o.loadStringStartsWith(),a.loadStringEndsWith(),u.loadGetLineDash(),l.loadSetLineDash(),s.loadStringCodeAtPoint(),d.loadArrayMap(),c.loadDateNow(),g=!0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,r=0;if(n.isNullOrUndefined(e)&&(r=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(r=Math.floor(e),0===t.length||0===r)return"";if(t.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var i=t.length*r;for(r=Math.floor(Math.log(r)/Math.log(2));r;)t+=t,r--;return t+=t.substring(0,i-t.length)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=function(){var e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringStartsWith=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var r=t>0?0|t:0;return this.substring(r,r+e.length)===e}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringEndsWith=function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=t;return(void 0===r||r>this.length)&&(r=this.length),this.substring(r-e.length,r)===e})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSetLineDash=function(){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){})}catch(e){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringCodeAtPoint=function(){
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();var t=String(this),r=t.length,n=e?Number(e):0;if(!(n<0||n>=r)){var i,o=t.charCodeAt(n);return o>=55296&&o<=56319&&r>n+1&&(i=t.charCodeAt(n+1))>=56320&&i<=57343?1024*(o-55296)+i-56320+65536:o}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadGetLineDash=function(){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]})}catch(e){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadArrayMap=function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");var t,r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");arguments.length>1&&(t=arguments[1]);for(var i=new Array(n),o=0;o<n;){if(o in r){var a=r[o],l=e.call(t,a,o,r);i[o]=l}o++}return i})}catch(e){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDateNow=function(){Date.now||(Date.now=function(){return(new Date).getTime()})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(29),o=r(1),a=r(68);function l(e,t,r,i,o,a,l){var s=i.Index,g=i.Min,f=i.Max;if(u(s,g,f,r.renderingRegion,!0)){var p=t.ClientOnlyCache,h=c(p.RowOffsetsAdjustedForDrawing,s,o,l),m=-1===i.Min?0:d(p.ColOffsetsAdjustedForDrawing,g,o,a),C=-1===i.Max?t.BlockWidth*r.scaleFactor:d(p.ColOffsetsAdjustedForDrawing,f,o,a);n.drawLine(e,m,h,C,h)}}function s(e,t,r,i,o,a,l){var s=i.Index,g=i.Min,f=i.Max;if(u(s,g,f,r.renderingRegion,!1)){var p=t.ClientOnlyCache,h=d(p.ColOffsetsAdjustedForDrawing,s,o,a),m=-1===i.Min?0:c(p.RowOffsetsAdjustedForDrawing,g,o,l),C=-1===i.Max?t.BlockHeight*r.scaleFactor:c(p.RowOffsetsAdjustedForDrawing,f,o,l);n.drawLine(e,h,m,h,C)}}function u(e,t,r,n,i){var o,a,l=i?n.startRow:n.startColumn,s=i?n.endRow:n.endColumn;return a=s,l<=(o=e)&&o<=a&&(s=i?n.endColumn:n.endRow,!(-1!==t&&t>s)&&(l=i?n.startColumn:n.startRow,!(-1!==r&&r<l)))}function d(e,t,r,o){return t>=0?i.getAdjustedDrawingOffset(e[t],n.getColWidthFromOffsets(t,e),r,o):0}function c(e,t,r,o){return t>=0?i.getAdjustedDrawingOffset(e[t],n.getRowHeightFromOffsets(t,e),r,o):0}t.drawPageBreaks=function(e,t,r){if(null!=t.PageBreaks){a.setPageLayoutLine(e,r);var n=o.getLinePixelTranslation(a.getLineWidth(r)),u=i.getMaxLineOffset(t.BlockWidth,r.scaleFactor,!1),d=i.getMaxLineOffset(t.BlockHeight,r.scaleFactor,!0);e.beginPath(),function(e,t,r,n,i,o){var a,s=null===(a=t.PageBreaks)||void 0===a?void 0:a.Row;if(null==s)return;for(var u=0;u<s.length;++u)l(e,t,r,s[u],n,i,o)}(e,t,r,n,u,d),function(e,t,r,n,i,o){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Col;if(null==l)return;for(var u=0;u<l.length;++u)s(e,t,r,l[u],n,i,o)}(e,t,r,n,u,d),e.stroke()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=r(1),o=r(68),a=r(3);function l(e,t){return!(e.startRow>t.LastRow)&&(!(e.startColumn>t.LastColumn)&&(!(e.endRow+1<t.FirstRow)&&(!(e.endColumn+1<t.FirstColumn)&&!(e.startRow>t.FirstRow&&e.startColumn>t.FirstColumn&&e.endRow<t.LastRow&&e.endColumn<t.LastColumn))))}function s(e,t,r,i,o,l,s){var u=t.ClientOnlyCache,d=s.FirstColumn<=0?-1:n.getAdjustedDrawingOffset(u.ColOffsetsAdjustedForDrawing[s.FirstColumn],0,i,l),c=s.FirstRow<=0?-1:n.getAdjustedDrawingOffset(u.RowOffsetsAdjustedForDrawing[s.FirstRow],0,i,o),g=s.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*r.scaleFactor+1:n.getAdjustedDrawingOffset(u.ColOffsetsAdjustedForDrawing[s.LastColumn],a.getColWidthFromOffsets(s.LastColumn,u.ColOffsetsAdjustedForDrawing),i,l),f=s.LastRow>=t.RowNumbers.length?t.BlockHeight*r.scaleFactor+1:n.getAdjustedDrawingOffset(u.RowOffsetsAdjustedForDrawing[s.LastRow],a.getRowHeightFromOffsets(s.LastRow,u.RowOffsetsAdjustedForDrawing),i,o);e.rect(d,c,g-d,f-c)}t.drawPrintAreas=function(e,t,r){var a;if(function(e){i.verifyArgumentNotNull(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),i.verifyArgumentNotNull(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),i.verifyArgumentNotNull(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),t.PrintAreas){o.setPageLayoutLine(e,r);var u=i.getLinePixelTranslation(o.getLineWidth(r)),d=n.getMaxLineOffset(t.BlockWidth,r.scaleFactor,!1),c=n.getMaxLineOffset(t.BlockHeight,r.scaleFactor,!0);e.beginPath();for(var g=0;g<(null===(a=t.PrintAreas)||void 0===a?void 0:a.length);g++)l(r.renderingRegion,t.PrintAreas[g])&&s(e,t,r,u,c,d,t.PrintAreas[g]);e.stroke()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(5),a=r(39),l=r(32),s=r(1),u=r(35),d=r(8),c=r(25);function g(e,t,r){var n=a.EmptyPivotTableImagePlaceholderThicknessPx,i=s.getLinePixelTranslation(n);e.lineWidth=n,e.fillStyle=e.strokeStyle=r?s.rgbToColorHex(r.TextColor):a.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+i,t.y+i,t.width,t.height)}function f(e,t,r,n){var i=r?s.rgbToColorHex(r.TextColor):a.EmptyPivotTableTitleTextColor;e.font=s.getFontCssStringFromFont(t,void 0,n),e.fillStyle=i,e.textBaseline=c.DefaultTextBaseline,e.textAlign="center"}function p(e,t,r){var n=h(e,t,r),i=l.getPivotTableLeftAdjustedForDrawing(e,t,!1),o=l.getPivotTableTopAdjustedForDrawing(e,t,!1),s=t.OriginPTWidthAdjustedForDrawing,u=t.OriginPTHeightAdjustedForDrawing,d=n.y+n.height,c=o+u,g=n.width,f=c-d-2*a.EmptyPivotTableImageMinimalPaddingYPx*r,p=Math.min(g,a.EmptyPivotTableImageWidthHeightRatio*f),m=Math.min(f,g/a.EmptyPivotTableImageWidthHeightRatio),C=(d+c)/2;return{x:i+Math.round((s-p)/2),y:Math.round(C-m/2),width:p,height:m}}function h(e,t,r){var n=Math.round(t.OriginPTWidthAdjustedForDrawing*a.EmptyPivotTableTitleContainerWidthRatio);return{x:y(e,t,n),y:C(e,t,r),width:n,height:Math.round(a.EmptyPivotTableTitleContainerHeightPx*r)}}function m(e,t){var r=Math.round(t.OriginPTWidth*a.EmptyPivotTableTitleContainerWidthRatio);return{x:T(e,t,r),y:v(e,t),width:r-a.EmptyPivotTableTitleContainerBorderThicknessPx,height:a.EmptyPivotTableTitleContainerHeightPx-a.EmptyPivotTableTitleContainerBorderThicknessPx}}function C(e,t,r){return l.getPivotTableTopAdjustedForDrawing(e,t,!1)+Math.round(a.EmptyPivotTableTitleContainerTopPaddingPx*r)}function v(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+a.EmptyPivotTableTitleContainerTopPaddingPx+a.EmptyPivotTableTitleContainerBorderThicknessPx}function y(e,t,r){var n=Math.floor((t.OriginPTWidthAdjustedForDrawing-r)/2);return l.getPivotTableLeftAdjustedForDrawing(e,t,!1)+n}function T(e,t,r){var n=(t.OriginPTWidth-r)/2+a.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){var r=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-r[t.FirstColIndex]-t.OriginPTWidth:r[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+n}t.drawEmptyPivotTableTitleContainers=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleContainers"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleContainers"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableTitleContainers"),t.PivotTables&&0!==t.PivotTables.length){for(var i=Math.max(Math.round(a.EmptyPivotTableTitleContainerBorderThicknessPx*r.scaleFactor),1),u=s.getLinePixelTranslation(i),d=!1,c=0;c<t.PivotTables.length;c++){var g=t.PivotTables[c];if(g.IsEmptyPivot&&(!(g.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingTitle)&&l.isPivotIntersectsRenderingRegion(t,g,r.renderingRegion,!1))){d||(e.strokeStyle=r.highContrastScheme?s.rgbToColorHex(r.highContrastScheme.TextColor):a.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=i,e.setLineDash(o.DefaultDash),e.beginPath(),d=!0);var f=h(t,g,r.scaleFactor);e.rect(u+f.x,u+f.y,f.width,f.height)}}d&&e.stroke()}},t.drawEmptyPivotTableImages=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableImages"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableImages"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(var i=0;i<t.PivotTables.length;i++){var o=t.PivotTables[i];if(o.IsEmptyPivot&&(!(o.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingImage)&&l.isPivotIntersectsRenderingRegion(t,o,r.renderingRegion,!1))){var s=p(t,o,r.scaleFactor);if(!(s.width<a.EmptyPivotTableMinimalImageWidthPx)){var d=u.getOrLoadStaticImage(0,r.blockIdentifier);d?e.drawImage(d,s.x,s.y,s.width,s.height):g(e,s,r.highContrastScheme)}}}},t.drawEmptyPivotTableTitleText=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleText"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleText"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableTitleText"),t.PivotTables&&0!==t.PivotTables.length)for(var o=!1,s=void 0,u=0;u<t.PivotTables.length;u++){var c=t.PivotTables[u];if(c.IsEmptyPivot&&(!(c.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingTitle)&&l.isPivotIntersectsRenderingRegion(t,c,r.renderingRegion,!1)&&c.PivotTableName)){if(!o){var g=n.getReferencedObjectById(n.UniqueStyleID.Default,t.Styles);f(e,s=n.getReferencedObjectById(g.FontID,t.Fonts),r.highContrastScheme,t),o=!0}var p=m(t,c),h=p.x+p.width/2,C=d.getTextOffsetYAlphabeticBaseline(t,p.y+p.height,p.height,s.Size,s.FontName,n.VerticalAlignment.Center);i.applyClipping(e,p),e.fillText(c.PivotTableName,h,C),i.restoreClipping(e,p)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(9),o=r(3),a=r(128),l=r(5),s=r(1),u=r(6);function d(e,t,r){return function(e,t,r){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return r?t-e:e}(Math.round(t*e/100),t,r)}function c(e,t,r,n){if(function(e){return e>0&&e<100}(e))return{X:t+r-s.getLinePixelTranslation(l.GridLineWidthPx),startY:n.y+l.GridLineWidthPx,endY:n.y+n.height-l.GridLineWidthPx}}function g(e,t,r,n,i){var o=Math.round(t.width*e/100);n&&(o=-o);var l=i&&o<0?a.DataBarAxisWidth:0,s=Math.min(r,r+o),u=t.x+s,d=Math.max(Math.abs(o)-l,0);return{x:u,y:t.y,width:d,height:t.height}}function f(e,t){return t.information.GradientColor?function(e,t){var r=function(e){var t,r=e.bar,n=r.x,i=n+r.width,o=null===(t=e.axis)||void 0===t?void 0:t.X;if(u.isNullOrUndefined(o)?e.isRtl:n<o)return{startX:i,endX:n,Y:r.y};return{startX:n,endX:i,Y:r.y}}(t),n=e.createLinearGradient(r.startX,r.Y,r.endX,r.Y);return n.addColorStop(a.GradientStartingPositing,t.information.Color),n.addColorStop(a.GradientEndingPositing,t.information.GradientColor),n}(e,t):t.information.Color}function p(e,t,r,n){e.lineWidth=t,e.setLineDash(r),e.strokeStyle=n}function h(e,t,r){r!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function m(e,t){var r=C(a.DataBarHorizontalPadding,t),n=C(a.DataBarTopPadding,t),i=C(a.DataBarBottomPadding,t);return{x:e.x+r+l.GridLineWidthPx,y:e.y+r+l.GridLineWidthPx,width:Math.max(0,e.width-2*r-2*l.GridLineWidthPx),height:Math.max(0,e.height-n-i-2*l.GridLineWidthPx)}}function C(e,t){return Math.max(e,Math.round(e*t))}t.drawDataBars=function(e,t,r){n.verifyArgumentNotNull(t,"model","drawDataBars"),n.verifyArgumentNotNull(e,"ctx","drawDataBars"),n.verifyArgumentNotNull(r,"context","drawDataBars"),n.verifyArgumentNotNull(t.Cells,"model.Cells","drawDataBars");var l=function(e,t){for(var r,a=e.Cells,l=[],s=0;s<a.length;s++){var f=a[s];if(o.cellIntersectsRenderingRegion(f,t.renderingRegion)){var p=null===(r=f.CondFormat)||void 0===r?void 0:r.DataBar;if(p){var h=p.Direction===n.ReadingOrderType.RightToLeft||e.IsRtl&&p.Direction===n.ReadingOrderType.Context,C=i.getCellDimensionsAdjustedForDrawing(e,f,!1),v=m(C,t.scaleFactor),y=d(p.AxisPostion,v.width,h),T=c(p.AxisPostion,v.x,y,C),S=!u.isNullOrUndefined(T),F=g(p.Length,v,y,h,S);l.push({information:p,axis:T,bar:F,isRtl:h})}}}return l}(t,r),C=function(e){if(u.isNullOrUndefined(e))return;return""+s.rgbToColorHex(e.TextColor)}(r.highContrastScheme);!function(e,t,r){for(var n,i=!1,l=!u.isNullOrUndefined(r),s=0;s<t.length;s++){var d=t[s].axis;if(!u.isNullOrUndefined(d)){if(i||(n=l?r:t[s].information.AxisColor,p(e,a.DataBarAxisWidth,a.DataBarAxisLineDash,n),e.beginPath(),i=!0),!l){var c=t[s].information.AxisColor;h(e,c,n),n=c}o.drawLine(e,d.X,d.startY,d.X,d.endY)}}i&&e.stroke()}(e,l,C),u.isNullOrUndefined(C)&&function(e,t){for(var r,n=0;n<t.length;n++){var i=t[n],o=i.bar,a=f(e,i);r!==a&&(e.fillStyle=a,r=a),e.fillRect(o.x,o.y,o.width,o.height)}}(e,l),function(e,t,r){for(var n,i=!1,o=!u.isNullOrUndefined(r),l=0;l<t.length;l++){var d=t[l].information.BorderColor;if(!u.isNullOrUndefined(r)||!u.isNullOrUndefined(d)){var c=(g=t[l].bar,f=void 0,m=void 0,C=void 0,v=void 0,f=g.x+s.getLinePixelTranslation(a.DataBarBorderWidth),m=g.y+s.getLinePixelTranslation(a.DataBarBorderWidth),C=Math.max(g.width-a.DataBarBorderWidth,0),v=Math.max(g.height-a.DataBarBorderWidth,0),{x:f,y:m,width:C,height:v});i||(n=o?r:d,p(e,a.DataBarBorderWidth,[],n),e.beginPath(),i=!0),o||(h(e,d,n),n=d),c.width>0&&e.rect(c.x,c.y,c.width,c.height)}}var g,f,m,C,v;i&&e.stroke()}(e,l,C)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarBorderWidth=1,t.GradientStartingPositing=0,t.GradientEndingPositing=1,t.DataBarAxisLineDash=[3,1]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(35),a=r(9);function l(e,t,r,n){var i=r.Sparkline.ClusterOffsetX,o=r.Sparkline.ClusterOffsetY,l=a.getCellWidth(t,r,!1),s=a.getCellHeight(t,r,!1),u=a.getCellLeftAdjustedForDrawing(t,r,!1),d=a.getCellTopAdjustedForDrawing(t,r),c=a.getCellWidthAdjustedForDrawing(t,r),g=a.getCellHeightAdjustedForDrawing(t,r);e.drawImage(n,i,o,l,s,u,d,c,g)}t.drawSparklines=function(e,t,r){if(n.verifyArgumentNotNull(e,"ctx","drawSparklines"),n.verifyArgumentNotNull(t,"model","drawSparklines"),n.verifyArgumentNotNull(r,"context","drawSparklines"),t.Sparklines){var a=t.Cells,s=o.getOrLoadVersionedImage(o.ImageType.Sparkline,t.Sparklines.Version,t.Sparklines.ImageUrl,r.blockIdentifier,r.blockIdentifier);if(s)for(var u=0;u<a.length;u++){var d=a[u];(null==d?void 0:d.Sparkline)&&(i.cellIntersectsRenderingRegion(d,r.renderingRegion)&&l(e,t,d,s))}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(5),o=r(9),a=r(15),l=r(39),s=r(3),u=r(8),d=r(14),c=r(67),g=r(18),f=r(1),p=r(10),h=r(32),m=r(11);function C(e,t,r,i){var d=function(e){var t=Math.floor(l.ExpandCollapseButtonSizePx*e);if(t%2==0)return t;return t-1}(i),f=function(e,t,r,n){if(function(e){if(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)return!0;return!1}(r))return Math.ceil(r.CachedDrawingLayout.CellTextLayout.Width*n);return Math.ceil(u.getTextWidthNoCaching(e,t,r)*n)}(e,t,r,i),h=p.isVerticalTextPresent(t,r),m=function(e,t,r,i,s,d){var c=l.PaddingBetweenExpandCollapseButtonAndTextPx*r;if(d)return e.IsRtl?Math.floor(o.getCellRightAdjustedForDrawing(e,t)-c)-i:Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1)+c);var g=u.getDistanceFromCellStartToIconEnd(e,t),f=t.CachedStyle.Indentation||l.NoIndent,p=u.getCellHorizontalIndentationPaddingPx(e,t,f),h=a.getEffectiveHorizontalAlignment(e,t);if(function(e,t,r,n,i){if(!t.WrapText)return!1;var o=y(e,t,r,i);return t.WrapText&&o<n}(e,t,g,s,r))return function(e,t,r,i,a,s,d,c){var g=function(e,t){if(t)return e===n.HorizontalAlignment.Right;return e===n.HorizontalAlignment.Center||e===n.HorizontalAlignment.Left}(r,e.IsRtl)?u.getCellHorizontalIndentationPaddingPx(e,t,i)*c:l.NoIndent;if(e.IsRtl){var f=o.getCellRightAdjustedForDrawing(e,t);return t.WrapText&&g===l.NoIndent&&r===n.HorizontalAlignment.Left&&d<=0?Math.floor(f):Math.min(Math.floor(f-a-s-g),f)}return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1)+a+g)}(e,t,h,f,c,i,y(e,t,g,r),r);var m=u.getTextHorizontalPosition(e,t)*r;switch(h){case n.HorizontalAlignment.Left:if(e.IsRtl)return Math.floor(m+s+c);var C=(p+g+l.PaddingBetweenExpandCollapseButtonAndTextPx)*r;return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1)+C);case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:return e.IsRtl?Math.floor(m+s/2+c):Math.max(Math.floor(m-s/2-c)-i,o.getCellLeftAdjustedForDrawing(e,t,!1));case n.HorizontalAlignment.Right:return e.IsRtl?Math.floor(o.getCellRightAdjustedForDrawing(e,t)-c-p*r)-i:Math.max(Math.floor(m-s-c)-i,o.getCellLeftAdjustedForDrawing(e,t,!1));default:throw Error("getAdjustedButtonLeft: unsupported horizontalAlignment: "+h)}}(t,r,i,d,f,h),C=function(e,t,r,i,a){var s;if(a)return Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)-i/2);var u=null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment,d=l.ExpandCollapseButtonVerticalPaddingPx*r;switch(u){case n.VerticalAlignment.Top:case n.VerticalAlignment.Justify:return Math.floor(o.getCellTopAdjustedForDrawing(e,t)+d);case n.VerticalAlignment.Bottom:return Math.floor(o.getCellBottomAdjustedForDrawing(e,t)-i-d);case n.VerticalAlignment.Center:case n.VerticalAlignment.Distributed:return Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)-i/2);default:throw Error("getAdjustedButtonTop: unsupported verticalAlignment: "+u)}}(t,r,i,d,h),T={outerColor:l.ExpandCollapseButtonOuterColor,innerColor:l.ExpandCollapseButtonInnerColor,left:m,bottom:C+d,height:d,width:d},S=c.getClipRect(t,r,T.left,T.bottom,d);s.applyClipping(e,S),g.drawRectangle(e,T),r.PivotTable.IsExpanded?v(e,m,C,d):function(e,t,r,n){v(e,t,r,n),function(e,t,r,n){var i=t+Math.round(n/2)+l.PlusMinusLineAdjustment,o=r+l.MinusPlusPaddingPx,a=r+n-l.MinusPlusPaddingPx-l.MinusPlusWidthPx;e.beginPath(),s.drawLine(e,i,o,i,a),e.stroke()}(e,t,r,n)}(e,m,C,d),s.restoreClipping(e,S)}function v(e,t,r,n){var i=Math.round(r+n/2)-l.PlusMinusLineAdjustment,o=t+l.MinusPlusPaddingPx+l.MinusPlusWidthPx,a=t+n-l.MinusPlusWidthPx;e.strokeStyle=l.ExpandCollapseButtonOuterColor,e.beginPath(),s.drawLine(e,o,i,a,i),e.stroke()}function y(e,t,r,n){var i=o.getCellWidth(e,t,!1);return s.getTextDrawingMaxWidth(i,u.getCellTextHorizontalPaddingWithoutVisualElements(e,t),r,m.getExpandCollapseButtonPadding(e,t))*n}t.drawExpandCollapseButtons=function(e,t,r){var a,l;if(n.verifyArgumentNotNull(e,"ctx","drawExpandCollapseButtons"),n.verifyArgumentNotNull(t,"model","drawExpandCollapseButtons"),n.verifyArgumentNotNull(r,"context","drawExpandCollapseButtons"),t.PivotTables)for(var u=t.Cells,c=!1,g=0;g<u.length;g++){var p=u[g];(null==p?void 0:p.PivotTable)&&(null==p?void 0:p.PivotTable).HasExpandCollapseIndicator&&(s.cellIntersectsRenderingRegion(p,r.renderingRegion)&&((null===(l=null===(a=p.CondFormat)||void 0===a?void 0:a.Icon)||void 0===l?void 0:l.IconOnly)&&!h.canCellContainExpandCollapseAndCFIcon(t,p,o.getCellWidthAdjustedForDrawing(t,p),r.scaleFactor)||p.CachedIsTextWidthExceedsCellWidth||m.cellTextReplacedWithHashes(p)||(c||(e.lineWidth=d.ShapeOutlineWidthPx,e.setLineDash(i.DefaultDash),c=!0),e.font=f.getFontCssStringFromFont(p.CachedFont,void 0,t),C(e,t,p,r.scaleFactor))))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=r(54),a=r(132),l=r(9),s=r(5),u=r(3),d=r(69),c=r(133),g=r(18),f=r(30);function p(e,t){if(!e.AutoFilter)return!1;if(!u.cellIntersectsRenderingRegion(e,t.renderingRegion))return!1;n.verifyArgumentNotNull(e.AutoFilter.RenderingContext,"AutoFilter.RenderingContext","shouldDrawAutoFilter");var r=e.AutoFilter.RenderingContext,i=r.IsHidden,o=r.IsRenderingPermitted;return!(i||!o)}function h(e,t,r,i,u,p,h){var C=function(e,t,r,n,i){var o=l.getCellWidthAdjustedForDrawing(e,t)-2*s.GridLineWidthPx,a=l.getCellHeightAdjustedForDrawing(e,t)-2*s.GridLineWidthPx,u=r.devicePixelRatio,c=Math.max(Math.min(d.AutoFilterIconRectPx*u,o,a),0),g=a>c?Math.round(d.AutoFilterPaddingBottomPx*u):0,f=o>c;return{bottom:l.getCellBottomAdjustedForDrawing(e,t)-g-s.GridLineWidthPx,left:m(e,t,c,f,u),height:c,width:c,outerColor:n,innerColor:i,radius:d.AutoFilterRectRadius}}(t,r,i,u,p);g.drawRoundRectangle(e,C),C.width>d.AutoFilterDrawingThresholdPx&&function(e,t,r,i){switch(e.strokeStyle=i,t){case n.AutoFilterType.Both:case n.AutoFilterType.Filtered:c.drawFilterDownChevronIcon(e,r);break;case n.AutoFilterType.BothAsc:case n.AutoFilterType.BothTop:c.drawSortUpFilterIcon(e,r);break;case n.AutoFilterType.BothDesc:case n.AutoFilterType.BothBottom:c.drawSortDownFilterIcon(e,r);break;case n.AutoFilterType.SortedAsc:case n.AutoFilterType.SortedTop:c.drawSortUpChevronDownIcon(e,r);break;case n.AutoFilterType.SortedDesc:case n.AutoFilterType.SortedBottom:c.drawSortDownChevronDownIcon(e,r);break;default:c.drawDownChevronIcon(e,r)}}(e,r.AutoFilter.Type,C,h),function(e,t,r,i){var l,s=e.PermissionSet,u=s.IsAutoFilterDisabled,d=s.IsSortDisabled;if(u&&d||(null===(l=t.AutoFilter)||void 0===l?void 0:l.RenderingContext.IsHeaderSnapped))return;var c=i.left,g=i.bottom-i.height,p={isMirrored:!1,renderingRegion:r.renderingRegion,scaleFactor:r.devicePixelRatio,rect:{x:c,y:g,width:i.width,height:i.height}};a.registerCursorHitRegion(e,t,p,o.PointerCursorType,n.RenderFeaturesZIndex.AutoFilter),a.registerHitRegion(e,t,p,n.RenderFeaturesZIndex.AutoFilter,(function(r){var n=t.AutoFilter.CommandData;return f.handleRibbonCommand(r,e.RibbonCommands.ShowAutoFilterMenu,n),!0}),"click"),a.registerHitRegion(e,t,p,n.RenderFeaturesZIndex.AutoFilter,(function(e){return f.setLastInputMethod(e),!0}),"touchstart")}(t,r,i,C)}function m(e,t,r,n,i){var o=n?Math.round(d.AutoFilterHorizontalPaddingPx*i):0;return e.IsRtl?l.getCellLeftAdjustedForDrawing(e,t,!1)+s.GridLineWidthPx+o:l.getCellRightAdjustedForDrawing(e,t)-r-s.GridLineWidthPx}t.drawAutoFilters=function(e,t,r){n.verifyArgumentNotNull(e,"ctx","drawAutoFilters"),n.verifyArgumentNotNull(t,"model","drawAutoFilters"),n.verifyArgumentNotNull(r,"context","drawAutoFilters");for(var o,a=t.Cells,l=!1,u=(o=r.highContrastScheme)?i.rgbToColorHex(o.TextColor):d.AutoFilterBorderColor,c=function(e){return e?i.rgbToColorHex(e.BackgroundColor):d.AutoFilterBackgroundColor}(r.highContrastScheme),g=function(e){return e?i.rgbToColorHex(e.TextColor):d.AutoFilterStrokeColor}(r.highContrastScheme),f=0;f<a.length;f++){var m=a[f];p(m,r)&&(l||(e.setLineDash(s.DefaultDash),e.lineWidth=d.AutoFilterLineWidthPx,l=!0),h(e,t,m,r,u,c,g))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);function i(e,t){var r=n.cellLookupKey(t.Row,t.Col),i=e[r];return i||(e[r]=[],i=e[r]),i}function o(e){var t=e.rect,r=Math.floor(t.x/e.scaleFactor),n=Math.floor(t.y/e.scaleFactor),i=Math.ceil(t.width/e.scaleFactor),o=Math.ceil(t.height/e.scaleFactor),a=e.renderingRegion,l=r-a.startOffsetX,s=n-a.startOffsetY,u=a.endOffsetX-a.startOffsetX;return{x:e.isMirrored?u-l-i:l,y:s,width:i,height:o}}t.registerHitRegion=function(e,t,r,n,a,l){var s=i(e.ClientOnlyCache.CellHitRegions,t),u={eventType:l,callback:a,zIndex:n,region:o(r)};s.push(u)},t.registerCursorHitRegion=function(e,t,r,n,a){var l=i(e.ClientOnlyCache.CellCursorHitRegions,t),s={cursorType:n,zIndex:a,region:o(r)};l.push(s)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(69);function o(e,t,r){var n=t.left,o=t.bottom-t.height;e.beginPath(),l(e,n,o,r,!0,t),s(e,t,i.MiniChevronPoints),e.stroke()}function a(e,t,r){var n=t.left,o=t.bottom-t.height;e.beginPath(),s(e,t,i.FilterPoints),l(e,n,o,r,!1,t),e.stroke()}function l(e,t,r,o,a,l){var s=l.width,c=a?i.RightArrowPosition:i.LeftArrowPosition,g=n.getLinePixelTranslation(i.AutoFilterLineWidthPx),f=u(t,c.x,g,s),p=u(r,o?c.y+i.ArrowLengthPx:c.y,g,s),h=d(p,o?-i.ArrowLengthPx:i.ArrowLengthPx,s),m=d(f,-1,s),C=d(f,1,s),v=d(h,o?1:-1,s);e.moveTo(f,p),e.lineTo(f,h),e.moveTo(m,v),e.lineTo(C,v)}function s(e,t,r){if(r&&0!==r.length){var o=t.left,a=t.bottom-t.height,l=r[0],s=n.getLinePixelTranslation(i.AutoFilterLineWidthPx);e.moveTo(u(o,l.x,s,t.width),u(a,l.y,s,t.width));for(var d=1;d<r.length;d++){var c=r[d];e.lineTo(u(o,c.x,s,t.width),u(a,c.y,s,t.width))}}}function u(e,t,r,n){return Math.round(d(e,t,n))+r}function d(e,t,r){return e+t/i.AutoFilterIconRectPx*r}t.drawDownChevronIcon=function(e,t){e.beginPath(),s(e,t,i.ChevronPoints),e.stroke()},t.drawFilterDownChevronIcon=function(e,t){e.beginPath(),s(e,t,i.MiniChevronPoints),s(e,t,i.FilterPoints),e.stroke()},t.drawSortDownFilterIcon=function(e,t){a(e,t,!1)},t.drawSortUpFilterIcon=function(e,t){a(e,t,!0)},t.drawSortUpChevronDownIcon=function(e,t){o(e,t,!0)},t.drawSortDownChevronDownIcon=function(e,t){o(e,t,!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(2),o=r(64),a=r(6),l=r(9),s=r(52),u=r(35),d=r(3),c=r(8),g=r(11),f=function(){function e(t){this.canvasInstance=null,e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},e.prototype.getCell=function(e,t){return n.getCell(e,t,this.model)},e.prototype.getOrCreateCell=function(t,r){var n=this.getCell(t,r);return n||(e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.Styles,"Styles","getOrCreateCell"),(t<0||r<0||t>=this.model.RowNumbers.length||r>=this.model.ColumnNumbers.length)&&this.throwErrorWrapper("cell requested for a cell which is not in range of the model. rowIndex:  "+t+", RowNumbers.length: "+this.model.RowNumbers.length+",  colIndex:  "+r+", ColumnNumbers.length: "+this.model.ColumnNumbers.length,"getOrCreateCell"),i.getDefaultCell(t,r,this.model.Styles,this.model.Fonts))},e.prototype.getColumnWidth=function(e){return n.getColumnWidth(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowHeight"),e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&this.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnOffset"),e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&this.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowOffset"),e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&this.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowNumber"),e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnNumber"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getCellStyle=function(e){return n.getCellStyle(e,this.model)},e.prototype.getCellFont=function(e){return n.getCellFont(e,this.model)},e.prototype.hasRichText=function(t){return e.verifyArgumentNotNull(t,"cell","hasRichText"),!a.isNullOrUndefined(null==t?void 0:t.TextRuns)},e.prototype.cloneCellFont=function(e){var t=n.getCellFont(e,this.model);return t?this.duplicateFont(t,t.ID,t.RefCount):t},e.prototype.getBorderStyle=function(t){return e.verifyArgumentNotNull(t,"cell","getBorderStyle"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","getBorderStyle"),a.isNullOrUndefined(t.CachedBorderStyle)&&(t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)),t.CachedBorderStyle},e.prototype.removeBorder=function(t){e.verifyArgumentNotNull(t,"cell","removeBorder"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),t.BorderStyleID=i.UniqueStyleID.DefaultBorder,t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)},e.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},e.prototype.isRtl=function(){return this.model.IsRtl},e.prototype.replaceCellInModel=function(t,r){e.verifyArgumentNotNull(t,"cell","replaceCellInModel"),e.verifyArgumentNotNull(r,"immediateModel","replaceCellInModel"),e.verifyArgumentNotNull(r.Styles,"immediateModel!.Styles","replaceCellInModel");var o=r.Styles[0];e.verifyArgumentNotNull(o,"style","replaceCellInModel"),e.verifyArgumentNotNull(r.Fonts,"immediateModel!.Fonts","replaceCellInModel");var l=this.duplicateAndSetFontsInModel(r.Fonts);t.TextRuns&&(t.TextRuns=this.duplicateTextRuns(t.TextRuns,l)),o.FontID=l[o.FontID],t.CachedFont=this.model.Fonts[o.FontID];var s=this.getLastNonUniqueStyleID()+1;if(o.ID=s,this.model.Styles.splice(s,0,o),t.StyleID=s,t.CachedStyle=o,!a.isNullOrUndefined(r.BorderStyles)){var u=r.BorderStyles[0];!a.isNullOrUndefined(u)&&!a.isNullOrUndefined(u.Borders)&&u.Borders.length>0&&(u.RefCount=1,this.setBorders(t,u))}if(this.getCell(t.Row,t.Col)){var d=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells[d]=t,this.model.ClientOnlyCache.CellLookup[i.cellLookupKey(t.Row,t.Col)]=t}else this.attachCellToModel(t);o.RefCount=1},e.prototype.attachCellToModel=function(t){if(e.verifyArgumentNotNull(t,"cell","attachCellToModel"),e.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","attachCellToModel"),!this.getCell(t.Row,t.Col)){var r=n.getModelClientCache(this.model),o=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells.splice(o,0,t),r.CellLookup[i.cellLookupKey(t.Row,t.Col)]=t;var a=this.getCellStyle(t);e.verifyArgumentNotNull(a,"style","attachCellToModel"),a.RefCount++;var l=this.getBorderStyle(t);e.verifyArgumentNotNull(l,"borderStyle","attachCellToModel"),l.RefCount++,t.CachedBorderStyle=l}},e.prototype.prepareCellStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareCellStyleForEdit");var r=this.getCellStyle(t);if(!this.isStyleUnique(r.ID)&&r.RefCount<=1)return!0;var n=this.getLastNonUniqueStyleID()+1,i=this.duplicateStyle(r,n,1);return r.RefCount=Math.max(0,r.RefCount-1),this.model.Styles.splice(n,0,i),t.CachedStyle=i,t.StyleID=n,!1},e.prototype.setDefaultHyperlinkStyleOnCell=function(t){e.verifyArgumentNotNull(t,"cell","setDefaultHyperlinkStyleOnCell");var r=i.getReferencedObjectById(i.UniqueStyleID.Hyperlink,this.model.Styles);r||this.throwErrorWrapper("default hyperlink style is not present in the model.","setDefaultHyperlinkStyleOnCell"),t.StyleID=i.UniqueStyleID.Hyperlink,t.CachedStyle=r,r.RefCount+=1},e.prototype.editCellFontAttributes=function(t,r){if(e.verifyArgumentNotNull(t,"cell","editFont"),e.verifyArgumentNotNull(t,"editFontAction","editFont"),this.attachCellToModel(t),this.prepareFontForEdit(t),t.TextRuns)for(var n=0;n<t.TextRuns.length;n++){var o=t.TextRuns[n];a.isNullOrUndefined(o.CachedFont)&&(o.CachedFont=i.getReferencedObjectById(o.FontID,this.model.Fonts)),r(o.CachedFont)}r(t.CachedFont)},e.prototype.prepareFontForEdit=function(e){if(null==e?void 0:e.TextRuns)for(var t=0;t<e.TextRuns.length;t++){var r=e.TextRuns[t],n=a.isNullOrUndefined(r.CachedFont)?i.getReferencedObjectById(r.FontID,this.model.Fonts):r.CachedFont;this.prepareTextRunFontForEdit(n,r)}this.prepareCellFontForEdit(e)},e.prototype.prepareTextRunFontForEdit=function(e,t){e.RefCount<=1||this.duplicateAndSetNewFontOnTextRun(e,t)},e.prototype.prepareCellFontForEdit=function(e){var t=this.getCellFont(e);this.prepareCellStyleForEdit(e)&&t.RefCount<=1||this.duplicateAndSetNewFontOnCell(t,e)},e.prototype.prepareBorderStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareBorderStyleForEdit");var r=this.getBorderStyle(t);if(!(r.ID!==i.UniqueStyleID.DefaultBorder&&r.RefCount<=1)){var n=this.duplicateBorderStyle(r,0,1);this.setBorders(t,n)}},e.prototype.cloneBorderStyle=function(t){e.verifyArgumentNotNull(t,"cell","cloneBorderStyle");var r=this.getBorderStyle(t);return this.duplicateBorderStyle(r,r.ID,1)},e.prototype.setBorders=function(t,r){e.verifyArgumentNotNull(t,"cell","setBorders"),e.verifyArgumentNotNull(r,"BorderStyle","setBorders");var n=this.getBorderStyle(t),i=this.getLastBorderStyleID()+1;r.ID=i,n.RefCount=Math.max(0,n.RefCount-1),this.model.BorderStyles.splice(i,0,r),t.BorderStyleID=i,t.CachedBorderStyle=r},e.prototype.getCellCssFont=function(e){return this.verifyCellStyleAndFont(e,"getCellCssFont"),n.getFontCssStringFromCell(e,this.model)},e.prototype.isDirty=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.IsDirty)&&void 0!==t&&t},e.prototype.setDirty=function(){var e=n.getModelClientCache(this.model);e.IsDirty||(e.DirtyTimestamp=Date.now()),e.IsDirty=!0},e.prototype.getCalcBlockModel=function(){var e=new i.CalcBlockModel,t=this.model.RowNumbers.slice(),r=this.model.ColumnNumbers.slice();e.addHeaders(t,r);for(var n=0;n<this.model.Cells.length;n++){var o=this.model.Cells[n],a=e.createCell(o);e.addCell(a)}return e},e.prototype.getDirtyTimestamp=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyTimestamp)&&void 0!==t?t:-1},e.prototype.updateCellSpillInformation=function(e){var t,r;if(this.verifyCellStyleAndFont(e,"updateCellSpillInformation"),a.isNullOrUndefined(null===(t=null==e?void 0:e.CachedDrawingLayout)||void 0===t?void 0:t.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),!e.Merge&&(null===(r=null==e?void 0:e.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)!==i.HorizontalAlignment.CenterAcrossSelection){e.Spill=void 0;var n;n=this.getOrCreateCanvasContext(),this.setContextCellFont(n,e),o.updateCellSpill(n,this.model,e),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e)}},e.prototype.updateClosestNonEmptyCellsSpillInformation=function(t){e.verifyArgumentNotNull(t,"cell","updateClosestNonEmptyCellsSpillInformation");var r;r=this.getOrCreateCanvasContext(),this.setContextCellFont(r,t),o.updateClosestNonEmptyCellsSpill(r,t,this.model)},e.prototype.getUserInput=function(t){return e.verifyArgumentNotNull(t,"cell","getUserInput"),t.UserInput},e.prototype.setUserInput=function(t,r){e.verifyArgumentNotNull(t,"cell","setUserInput"),e.verifyArgumentNotNull(r,"userInput","setUserInput"),t.UserInput=r},e.prototype.clearCellFormat=function(e){var t=i.getReferencedObjectById(i.UniqueStyleID.Default,this.model.Styles);e.StyleID=i.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=i.getReferencedObjectById(t.FontID,this.model.Fonts),e.BorderStyleID=i.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=i.getReferencedObjectById(i.UniqueStyleID.DefaultBorder,this.model.BorderStyles)},e.prototype.getRowIndex=function(e){return n.getModelRowIndex(this.model,e)},e.prototype.getColumnIndex=function(e){return n.verifyArgumentNotNull(this.model,"model","getColumnIndex"),n.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),n.binarySearch(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,n.numbersComparer)},e.prototype.getCellWidth=function(e,t){return n.verifyArgumentNotNull(this.model,"model","getCellWidth"),n.verifyArgumentNotNull(e,"cell","getCellWidth"),l.getCellWidth(this.model,e,t)},e.prototype.getHorizontalPadding=function(e){return n.verifyArgumentNotNull(this.model,"model","getHorizontalPadding"),n.verifyArgumentNotNull(e,"cell","getHorizontalPadding"),c.getCellTextHorizontalPadding(e,this.model)},e.prototype.getCellHeight=function(e){return n.verifyArgumentNotNull(this.model,"model","getCellHeight"),n.verifyArgumentNotNull(e,"cell","getCellHeight"),l.getCellHeight(this.model,e,!0)},e.prototype.getTextMaxWidth=function(e){return n.verifyArgumentNotNull(this.model,"model","getTextDrawingMaxWidth"),n.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth"),d.getTextDrawingMaxWidth(this.getCellWidth(e,!0),c.getCellTextHorizontalPadding(e,this.model),c.getDistanceFromCellStartToIconEnd(this.model,e),i.isRenderFlagEnabled(i.RenderFlagsArray.PivotTable,this.model,!0)?g.getExpandCollapseButtonPadding(this.model,e):0)},e.prototype.getFormattedText=function(t){var r=this;if(e.verifyArgumentNotNull(t,"cell","getFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText"),!i.isRenderFlagEnabled(i.RenderFlagsArray.GetFormattedTextFix,this.model,!0))return this.getFormattedTextUsingSet(t);var n=[],o=[],a=function(e){if(!o[e])if(e<r.model.Fonts.length){var t=r.model.Fonts[e];o[e]=r.duplicateFont(t,t.ID,t.RefCount)}else r.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")};if(t.TextRuns)t.TextRuns.forEach((function(e){a(e.FontID),n.push(r.duplicateTextRun(e))}));else{var l=t.CachedStyle?t.CachedStyle:this.getCellStyle(t),s={FontID:l.FontID,StartIndex:0};a(l.FontID),n.push(s)}return{Text:t.Text||"",TextRuns:n,Fonts:o}},e.prototype.getFormattedTextUsingSet=function(e){var t=this,r=new Set,n=[];if(e.TextRuns)e.TextRuns.forEach((function(e){r.add(e.FontID),n.push(t.duplicateTextRun(e))}));else{var i=e.CachedStyle?e.CachedStyle:this.getCellStyle(e),o={FontID:i.FontID,StartIndex:0};r.add(i.FontID),n.push(o)}var a=[];return r.forEach((function(e){if(e<t.model.Fonts.length){var r=t.model.Fonts[e];a[e]=t.duplicateFont(r,r.ID,r.RefCount)}else t.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")})),{Text:e.Text||"",TextRuns:n,Fonts:a}},e.prototype.setFormattedText=function(t,r){e.verifyArgumentNotNull(t,"cell","setFormattedText"),e.verifyArgumentNotNull(r,"formattedText","setFormattedText"),e.verifyArgumentNotNull(r.TextRuns,"formattedText.TextRuns","setFormattedText"),e.verifyArgumentNotNull(r.Fonts,"formattedText.Fonts","setFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(t),t.Text=r.Text;for(var n=this.duplicateAndSetFontsInModel(r.Fonts),o=t.TextRuns=this.duplicateTextRuns(r.TextRuns,n),a=0;a<o.length;a++)o[a].CachedFont=i.getReferencedObjectToCache(o[a].FontID,this.model.Fonts)},e.prototype.discardFormattedText=function(t){e.verifyArgumentNotNull(t,"cell","discardFormattedText"),t.TextRuns=void 0},e.prototype.serializeCell=function(e){return i.serializeCell(e,this.model)},e.prototype.getOutlineState=function(e,t){var r=e?this.model.RowOutlines:this.model.ColumnOutlines;return r?r[t]:i.OutlineState.None},e.prototype.compareCells=function(e,t,r){return i.areCellsEqual(e,t,r,this.model)},e.prototype.updateNumFmt=function(t){e.verifyArgumentNotNull(t,"cell","updateNumFmt"),i.isAccAndCustomNumFmtApplicable(t)?s.updateNumFmtFromCell(t):t.NumFmt=void 0},e.prototype.updateCellText=function(t,r){e.verifyArgumentNotNull(t,"cell","updateCellText"),e.verifyArgumentNotNull(r,"text","updateCellText"),t.TextRuns=void 0,t.DisplayFormula=!1,n.updateCellText(this.model,t,r)},e.prototype.hasPageLayout=function(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas},e.prototype.hasIntersectingPrintArea=function(t){var r=this.model.PrintAreas;if(e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),r&&t)for(var i=this.model.RowNumbers.length,o=this.model.ColumnNumbers.length,a=0;a<r.length;a++){var l=r[a];if(l.FirstRow!==i&&l.FirstColumn!==o){var s=this.getRowNumber(l.FirstRow),u=l.LastRow>=i?this.getRowNumber(i-1):this.getRowNumber(l.LastRow),d={FirstRow:s,FirstColumn:this.getColumnNumber(l.FirstColumn),LastRow:u,LastColumn:l.LastColumn>=o?this.getColumnNumber(o-1):this.getColumnNumber(l.LastColumn)};if(n.doRangesIntersect(t,d))return!0}}return!1},e.prototype.getPivotTableRanges=function(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)},e.prototype.getSparklineRanges=function(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)},e.prototype.getSparklinesUrl=function(){var e,t;return null!==(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)&&void 0!==t?t:""},e.prototype.getAllRichValueFields=function(){return this.duplicateRichValueFields(this.model.AllRichValueFields)},e.prototype.disposeBlock=function(e){a.isNullOrUndefined(e)||""===e||u.clearImageFromCache(u.ImageType.Sparkline,e)},e.prototype.isStyleUnique=function(e){return e===i.UniqueStyleID.Default||e===i.UniqueStyleID.Hyperlink},e.prototype.getLastNonUniqueStyleID=function(){return this.model.Styles.length-2-1},e.prototype.getLastBorderStyleID=function(){return this.model.BorderStyles.length-1},e.prototype.duplicateStyle=function(e,t,r){var n={BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment,ID:t,NamedStyleId:e.NamedStyleId,RefCount:r,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder,FontID:e.FontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient};this.model.Fonts&&i.getReferencedObjectById(e.FontID,this.model.Fonts).RefCount++;return n},e.prototype.duplicateBorderStyle=function(e,t,r){for(var n=[],i=0;i<e.Borders.length;i++){var o=e.Borders[i],a={BorderLineStyle:o.BorderLineStyle,BorderPosition:o.BorderPosition,Weight:o.Weight,Color:{Red:o.Color.Red,Blue:o.Color.Blue,Green:o.Color.Green}};n.push(a)}return{Borders:n,ID:t,RefCount:r}},e.prototype.removeBordersWithinASpillCell=function(e){for(var t=1;t<=e.Spill.SpanToEnd;t++){var r=this.getCell(e.Row,e.Col+t);if(r){var n=i.getReferencedObjectById(r.BorderStyleID,this.model.BorderStyles);n&&n.Borders&&n.Borders.length>0&&this.removeCellLeftBorder(r,n)}}},e.prototype.removeCellLeftBorder=function(e,t){var r=this.duplicateBorderStyle(t,t.ID,1);if(r&&r.Borders)for(var n=r.Borders.length,o=0;o<n;o++){var a=r.Borders[o];a&&a.BorderPosition===i.BorderPositionType.Left&&(r.Borders.splice(o),this.setBorders(e,r))}},e.prototype.duplicateFont=function(e,t,r){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,ID:t,Italic:e.Italic,RefCount:r,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}},e.prototype.duplicateTextRun=function(e,t){return{FontID:null!=t?t:e.FontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}},e.prototype.duplicateAndSetNewFontOnTextRun=function(e,t){var r=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=r.newFontId,t.CachedFont=r.newFont},e.prototype.duplicateAndSetNewFontOnCell=function(e,t){var r=this.duplicateAndSetNewFontInModel(e,!1),n=r.newFontId,i=r.newFont;t.CachedFont=i,t.CachedStyle.FontID=n},e.prototype.duplicateAndSetFontsInModel=function(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++){var i=e[parseInt(r[n],10)],o=this.duplicateAndSetNewFontInModel(i,!0).newFontId;t[i.ID]=o}return t},e.prototype.duplicateTextRuns=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];r[n]=this.duplicateTextRun(i,t[i.FontID])}return r},e.prototype.duplicatePivotTableRangeInformations=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicatePivotTableRangeInformation(e[r]));return t}},e.prototype.duplicatePivotTableRangeInformation=function(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid}},e.prototype.duplicateRangeInformation=function(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}},e.prototype.duplicatePivotTableFieldInfos=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicatePivotTableFieldInfo(e[r]));return t}},e.prototype.duplicatePivotTableFieldInfo=function(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop}},e.prototype.duplicateAndSetNewFontInModel=function(e,t){var r=this.model.Fonts.length,n=t?e.RefCount:1,i=this.duplicateFont(e,r,n);return t||(e.RefCount=Math.max(0,e.RefCount-1)),this.model.Fonts.splice(r,0,i),{newFontId:r,newFont:i}},e.prototype.throwErrorWrapper=function(e,t){n.throwError(e,"GridBlockModelAccessor."+t)},e.verifyArgumentNotNull=function(e,t,r){n.verifyArgumentNotNull(e,t,"GridBlockModelAccessor."+r)},e.prototype.duplicateSparklineRangeInformations=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicateSparklineRangeInformation(e[r]));return t}},e.prototype.duplicateSparklineRangeInformation=function(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}},e.prototype.duplicateRichValueFields=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicateRichValueField(e[r]));return t}},e.prototype.duplicateRichValueField=function(e){return{Index:e.Index,Value:e.Value}},e.prototype.verifyCellStyleAndFont=function(e,t){n.verifyArgumentNotNull(e,"cell",t),e.CachedStyle||n.getCellStyle(e,this.model),e.CachedFont||n.getCellFont(e,this.model)},e.prototype.setContextCellFont=function(e,t){e.font=n.getFontCssStringFromCell(t,this.model)},e}();t.GridBlockModelAccessor=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),i=r(8),o=r(2),a=r(1),l=r(136),s=r(35),u=r(31),d=r(26),c=r(30),g=r(0),f=r(70),p=r(139),h=function(){function e(){}return e.lookupPerfMetricName=function(e){return n.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,r,n,o){var a=e.canvasInstance().getContext("2d");if(!a)throw Error("calculateTextWidth: ctx is undefined");return a.font=r,i.measureTextWidth(a,t,n,!!o)},e.compareFormattedTexts=function(e,t){return o.areFormattedTextsEqual(e,t)},e.compareGridBlockModels=function(e,t){return o.areGridBlockModelsEqual(e,t)},e.serializeCell=function(e,t){return o.serializeCell(e,t)},e.registerActionOnFontLoad=function(e,t,r){l.registerActionOnFontLoadIfRequired(e,t,r)},e.cleanModelBeforeSerialization=function(e){a.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),o.cleanModelBeforeSerialization(e)},e.restoreModelAfterSerialization=function(e){a.verifyArgumentNotNull(e,"model","restoreModelAfterSerialization"),o.restoreModelAfterSerialization(e)},e.cleanModelJsonReplacer=function(e,t){return o.cleanModelJsonReplacer(e,t)},e.registerExternalCallbacks=function(e){c.registerExternalCallbacks(e)},e.initializeLogger=function(e){e&&g.initializeLogger(e)},e.initializeGridRendererImageLoader=function(e,t){s.initializeGridRendererImageLoader(e,t)},e.setStaticImageUrl=function(e,t){s.setStaticImageUrl(e,t)},e.loadPreviewFont=function(e){l.loadPreviewFont(e)},e.isFontLoadApiSupported=function(){return u.fontFaceSetSupported()},e.getFontNameForLogging=function(e){return d.getFontNameForLogging(e)},e.initPassiveTestManager=function(){f.initPassiveTests()},e.registerForOffScreenCanvasPassiveTest=function(e){p.registerOffscreenCanvasPassiveTest(e)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e}();t.GridBlockRendererGlobals=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(38),i=r(31),o=r(1),a=r(26),l=document.createElement("div");l.innerText=".",l.style.visibility="hidden",document.body.appendChild(l),t.registerActionOnFontLoadIfRequired=function(e,t,r){i.fontFaceSetSupported()&&o.isDefined(t)&&function(e){if(!e.Fonts||0===e.Fonts.length)return!1;for(var t=0;t<e.Fonts.length;t++){var r=a.canonizeFontName(e.Fonts[t].FontName);if(i.isFontUsedInModel(e,t)&&(!i.doesFontExist(r)||i.getFontLoadStatus(r)===i.FontLoadStatus.Pending))return!0}return!1}(e)&&(t(0),function(e){for(var t=0;t<e.Fonts.length;t++){var r=a.canonizeFontName(e.Fonts[t].FontName);i.doesFontExist(r)||(i.setFontLoadDivWithFontFamily(l,r),i.setFontLoadStatus(r,i.FontLoadStatus.Pending))}}(e),function(e,t,r){i.getFontFaceSetReady().then((function(){o.isDefined(t)&&(function(e,t){if(!e.Fonts)return!1;for(var r=!1,l=0;l<e.Fonts.length;l++){var s=a.canonizeFontName(e.Fonts[l].FontName);i.isFontLoaded(s)?(i.getFontLoadStatus(s)!==i.FontLoadStatus.Loaded&&(n.recalculateFontMetrics(s,e),i.setFontLoadStatus(s,i.FontLoadStatus.Loaded)),r=!0):(i.setFontLoadStatus(s,i.FontLoadStatus.Failed),o.isDefined(t)&&a.isKnownFont(s)&&t(a.sanitizeFontName(s)))}return r}(e,r)&&t(1),t(2))}),(function(){o.isDefined(t)&&o.isDefined(r)&&(r("API_Failure"),t(2))}))}(e,t,r))},t.loadPreviewFont=function(e){i.setFontLoadDivWithFontFamily(l,"msofp"),document.fonts.ready.then((function(){i.isFontLoadFailed("msofp")&&e("ERROR")}),(function(){e("API_Faliure")}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(43),o=function(e){function t(t,r){var n=e.call(this,t)||this;return n.isScheduled=!1,n.maxTimeAfterIdle=r,n.lastActiveTime=i.getCurrentTimeInMs(),n}return n.__extends(t,e),t.prototype.startTrackingIfApplicable=function(){this.isScheduled||(this.isScheduled=!0,this.lastActiveTime=i.getCurrentTimeInMs(),setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec))},t.prototype.stopTracking=function(){this.isScheduled=!1},t.prototype.onTimerTick=function(){e.prototype.onTimerTick.call(this);var t=i.getCurrentTimeInMs()-this.lastActiveTime;this.isScheduled&&t<this.maxTimeAfterIdle?setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec):this.isScheduled=!1},t.prototype.reportActivity=function(){e.prototype.reportActivity.call(this),this.lastActiveTime=i.getCurrentTimeInMs()},t}(r(138).Idle);t.IdleTracker=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["keypress","keydown","click","contextmenu","dblclick","mousemove","scroll","touchmove","touchstart"],i=function(){function e(e){var t=this;this.userReportedActive=!1,this.userIsActive=!1,this.userMouseIsInFrame=!1,this.attachedFrames=[],this.activityReportMode=2,this.activityReportInSec=5,this.detectFramesInSec=-1,this.onActivity=function(){},this.onEnterFrame=function(){},this.onReportUserIsActive=function(){},this.onReportUserIsIdle=function(){},this.attachListenerToNewFrames=function(){for(var e=Array.prototype.slice.call(window.document.getElementsByTagName("frame")),r=Array.prototype.slice.call(window.document.getElementsByTagName("iframe")),n=0,i=e.concat(r);n<i.length;n++){var o=i[n];t.attachedFrames.indexOf(o)<0&&(o.addEventListener("mouseenter",t.onMouseEntersFrame.bind(t),t,!1),t.attachedFrames.push(o),t.userMouseIsInFrame=!0)}},this.onUserActivity=function(){t.onActivity(),t.userIsActive=!0,2!==t.activityReportMode||t.userReportedActive||t.reportActivity(),t.userMouseIsInFrame=!1},this.overrideDefaultsWithOptions(e),n.forEach((function(e){window.addEventListener(e,t.onUserActivity,!0)})),e.scheduleByDefault&&(setInterval(this.onTimerTick.bind(this),1e3*this.activityReportInSec),this.detectFramesInSec>0&&setInterval(this.attachListenerToNewFrames,1e3*this.detectFramesInSec)),this.reportActivity()}return e.prototype.onMouseEntersFrame=function(){this.onEnterFrame(),this.userMouseIsInFrame=!0},e.prototype.onTimerTick=function(){this.userReportedActive=!1,1===this.activityReportMode&&this.userIsActive||this.userMouseIsInFrame&&this.isPageVisible()?this.reportActivity():this.onReportUserIsIdle()},e.prototype.reportActivity=function(){this.onReportUserIsActive(),this.userReportedActive=!0,this.userIsActive=!1},e.prototype.overrideDefaultsWithOptions=function(e){this.activityReportInSec=e.activityReportInSec||this.activityReportInSec,this.activityReportMode=e.activityReportMode||this.activityReportMode,this.detectFramesInSec=e.detectFramesInSec||this.detectFramesInSec,this.onActivity=e.onActivity||this.onActivity,this.onEnterFrame=e.onEnterFrame||this.onEnterFrame,this.onReportUserIsActive=e.onReportUserIsActive||this.onReportUserIsActive,this.onReportUserIsIdle=e.onReportUserIsIdle||this.onReportUserIsIdle},e.prototype.isPageVisible=function(){return"hidden"!==document.visibilityState},e}();t.Idle=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1),o=r(140),a=r(43),l=r(70);function s(){return"undefined"!=typeof OffscreenCanvas}t.registerOffscreenCanvasPassiveTest=function(e){s()&&(n||(n=new u),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++)if(e.Cells[t].Text)return!0;return!1}(e)&&n.register(e))};var u=function(){function e(){this.isDisabled=!1,this.suiteName="OffScreenCanvasPassiveTest",this.testData=[],this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.offscreenCanvas=new OffscreenCanvas(o.CanvasWidth,o.CanvasWidth),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")}return e.prototype.canExecuteTest=function(){return!this.isDisabled&&this.testData.length>0&&s()},e.prototype.executeTest=function(){if(!this.canExecuteTest())return{isValid:!1,value:o.ResultMessageTestDisabled};var e=this.testData.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:o.ResultMessageInsufficientData};for(var r=0;r<e.Cells.length;r++)e.Cells[r].Text&&t.push(e.Cells[r]);if(t.length<1)return{isValid:!1,value:o.ResultMessageInsufficientData};var n=t[Math.floor(Math.random()*t.length)],a=i.getFontCssStringFromCell(n,e),l=this.measureTextWidth(this.canvasContext,a,n.Text),s=this.measureTextWidth(this.offscreenCanvasContext,a,n.Text);return l&&s?{isValid:!0,value:JSON.stringify({canvasMeasurement:l,offscreenCanvasMeasurement:s})}:{isValid:!1,value:o.ResultMessageUnsuccessful}},e.prototype.register=function(e){this.testData.push(e),l.registerPassiveTest(this)},e.prototype.getSuiteName=function(){return this.suiteName},e.prototype.getTestName=function(){return this.suiteName},e.prototype.disable=function(){this.isDisabled=!0},e.prototype.measureTextWidth=function(e,t,r){e.font=t;var n=e.measureText(r);return{executionsPerSecond:this.calculateExecutionsPerSecond(e,r),width:n.width,actualBoundingBoxRight:n.actualBoundingBoxRight,actualBoundingBoxLeft:n.actualBoundingBoxLeft}},e.prototype.calculateExecutionsPerSecond=function(e,t){return a.calculateExecutionsPerSecond((function(r){return e.measureText(t+r)}),o.PeriodToEvalInMs)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultMessageInsufficientData="Insufficient Data",t.ResultMessageTestDisabled="Test Disabled",t.ResultMessageUnsuccessful="Test Unsuccessful",t.CanvasWidth=1,t.CanvasHeight=1,t.PeriodToEvalInMs=10},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"setupDefaultRumShepherd",(function(){return k})),r.d(n,"RumShepherdFactoryGlobal",(function(){return D})),r.d(n,"SubComponentInitEventName",(function(){return s})),r.d(n,"SubComponentSetLoadStateEventName",(function(){return u})),r.d(n,"AppLoadMetricReportEventName",(function(){return d})),r.d(n,"dispatchRumShepherdEvent",(function(){return c})),r.d(n,"VISUALLY_READY",(function(){return i})),r.d(n,"FUNCTIONALLY_READY",(function(){return o}));var i="visually-ready",o="functionally-ready";function a(e){return e===i||e===o}function l(e,t){var r;for(var n in e)if(!(null===(r=e[n].states[t])||void 0===r?void 0:r.final))return!1;return!0}var s="Wac-SubComponentsInit",u="Wac-SubComponentSetLoadState",d="Wac-AppLoadMetricReport",c=function(e,t){var r=new CustomEvent(e,{detail:t});self.dispatchEvent(r)},g=r(4),f=r(7);function p(e){return e?Object(g.__assign)({},e):{}}function h(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.error.apply(console,Object(g.__spreadArrays)(["[RumShepherd]"+e],t))}function m(e,t){var r=e.subComponents;for(var n in r){var i=r[n];if(!(i.states[t]||i.unused))return!1}return!0}function C(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:p(e.measures),data:p(e.data)}}function v(e,t,r,n){"then"in e?e.then((function(e){n(e)})).catch((function(e){var i="Error in invokeMonitor ["+r+"}]";h(i,e),n({start:t,time:t,monitor:"",error:i+": "+e})})):n(e)}var y=r(73),T=function(){function e(e){var t=this;this.timeoutInMs=e,this._reason="",this._cancel=function(e){t._reason||(t._reason=e?"timeout":"cancelled",t._onCancelled&&t._onCancelled())},this.cancel=function(){t._cancel(!1)},e>0&&window.setTimeout((function(){return t._cancel(!0)}),e)}return Object.defineProperty(e.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this._reason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onCancelled",{set:function(e){this._onCancelled=e},enumerable:!0,configurable:!0}),e}();function S(e){return new T(null!=e?e:0)}var F=function(){function e(e){var t=this;this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){var t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",(function(r){t=Math.min(t,r.timeStamp),e(t)}),{once:!0})}((function(e){return t._firstTabHiddenTime=e}))}return Object.defineProperty(e.prototype,"tabHideTime",{get:function(){return this._firstTabHiddenTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._metrics},enumerable:!0,configurable:!0}),e.prototype.startAppStateMonitors=function(e,t){var r=this;e!==i&&e!==o||(this.monitorMetric("first-input",t),this.monitorMetric("first-interaction",t),this.monitorMetric("first-idle",t),this.monitorMetric("stable-interactivity",(function(e,n){if(n){if(!n.error){var i=r._metrics["first-input"]?r._metrics["first-input"].time:0,o=r._metrics["first-interaction"]?r._metrics["first-interaction"].time:0;i>0&&i<n.time&&(0===o||i<=o)&&(n.error="first-input"),o>0&&o<n.time&&(n.error="first-interaction")}t(e,n)}}),12e4))},e.prototype.cancelAppStateMonitors=function(){var e=this,t=function(t){var r;null===(r=e._monitoredMetrics[t])||void 0===r||r.cancel(),e._monitoredMetrics[t]=void 0,e._metrics[t]=void 0};t("stable-interactivity"),t("first-idle")},e.prototype.monitorMetric=function(e,t,r){if(!this._monitoredMetrics[e]){var n=S(r);this._monitoredMetrics[e]=n;var i=Object(y.timeStamp)();v((0,this._shepherdInit.monitors[e])(i,n),i,e,(function(r){t(e,r)}))}},e}();var w=function(){function e(e){var t=this;this._components={},this._canMetricBeReported=function(e){return a(e)?l(t._components,e):"stable-interactivity"!==e&&"first-idle"!==e||!!t._appMetrics.metrics[e]&&l(t._components,i)},this._reportMetricIfReady=function(e){if(t._canMetricBeReported(e))try{var r=t._appMetrics.metrics[e],n={metric:e,timeOrigin:t._timeOrigin,time:r.time,error:r.error||(t._appMetrics.tabHideTime<r.time?"tab-switch":void 0),monitor:r.monitor,measures:p(r.measures),data:p(r.data),auxMetrics:[]},i=n.measures;if(i.tabsSwitch=t._appMetrics.tabHideTime<r.time?t._appMetrics.tabHideTime:0,i.start=r.start,a(e))for(var o in t._components){var l=t._components[o].states[e].result;i[o]=l.time,n.error=n.error||l.error;var s={metric:e+"-"+o,time:l.time,monitor:l.monitor,error:l.error,measures:p(l.measures)};n.auxMetrics.push(s)}t._shepherdInit.appLoadMetricReportCallback&&t._shepherdInit.appLoadMetricReportCallback(n)}catch(e){h("_reportMetricIfReady:",e)}},this._processSubComponentStateReport=function(e,r,n,i){if(r.states[n]=i,function(e,t){var r=e.subComponents;for(var n in r){if(!(r[n].states[t]||r[n].optional))return!1}return!0}(e,n)){var o=function(e,r,n){r&&(t.metrics[e]=C(r,n),t._reportMetricIfReady(e))};t._appMetrics.cancelAppStateMonitors();var a=t._shepherdInit.monitors[n];!function(e,t,r,n){var i=e.states[t];if(!(null==i?void 0:i.final)){(null==i?void 0:i.monitoring)&&(null==i||i.monitoring.cancel());var o=Object(f.d)(),a=S(5e3);e.states[t]={monitoring:a,final:!1},v(r(o,a,e),o,t,n)}}(e,n,a,(function(r){!function(e,t,r){e.states[t]={result:C(r),monitoring:void 0,final:m(e,t)}}(e,n,r);var i=function(e,t){var r,n,i=0;for(var o in e){var a=null===(n=null===(r=e[o].states[t])||void 0===r?void 0:r.result)||void 0===n?void 0:n.time;if(!a)return;i=Math.max(i,a)}return i}(t._components,n);i&&(o(n,r,i),t._appMetrics.startAppStateMonitors(n,o))}))}},this._processSubComponentUnusedReport=function(e,r){for(var n in r.unused=!0,e.states){var i=n;m(e,i)&&(e.states[i].final=!0,t._reportMetricIfReady(i))}t._reportMetricIfReady("stable-interactivity"),t._reportMetricIfReady("first-idle")},this._addSubComponent=function(e,t,r,n){r?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:Object(f.d)(),optional:n,unused:!1,states:{}})},this._timeOrigin=Number(Object(f.c)().toFixed()),this._shepherdInit=Object(g.__assign)({},e),this._appMetrics=new F(this._shepherdInit);for(var r=0,n=e.components;r<n.length;r++){var o=n[r];this._components[o.id]={id:o.id,rootElementId:o.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}}return e.prototype.addSubComponents=function(e){if(e&&e.component&&e.subComponents){var t=this._components[e.component];if(t){var r=t.ignoreNewSubComponents;if(function(e){for(var t in e.states)if(e.states[t].final)return!1;return!0}(t)||r)try{for(var n=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents],i=0;i<n.length;i+=1)this._addSubComponent(t,n[i],r,!1);if(e.optionalSubComponents)for(i=0;i<e.optionalSubComponents.length;i+=1)this._addSubComponent(t,e.optionalSubComponents[i],r,!0)}catch(e){h("addSubComponents",e)}else h("Component cannot be modified",e)}else h("Invalid component",e)}else h("Invalid data",e)},e.prototype.setSubComponentState=function(e){var t,r=Object(f.d)();if(e&&e.subComponent&&e.component&&e.state){var n=this._components[e.component];if(n){if(!n.ignoredSubComponents[e.subComponent]){n.ignoreNewSubComponents=n.ignoreNewSubComponents||!!e.ignoreNewSubComponents;var i=n.subComponents[e.subComponent];if(i)if("unused"!==e.state){var o=e.state;a(o)?(null===(t=n.states[o])||void 0===t?void 0:t.final)?h("Component state final. Can't set",e):this._processSubComponentStateReport(n,i,o,r):h("Unknown state reported",e)}else this._processSubComponentUnusedReport(n,i);else h("Unexpected sub-component",e)}}else h("Invalid component",e)}else h("Invalid data",e)},Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._appMetrics.metrics},enumerable:!0,configurable:!0}),e}();function x(e,t,r,n){if(Object(f.a)("element")){var i="testimg-"+r,o=function(e){var t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t}(i);if(o){var a=null!=n?n:document.documentElement;return new Promise((function(r){var n=function(t,n){void 0===t&&(t=0),l&&l.disconnect(),r({start:e,time:t,monitor:"image-paint-api",error:n})},l=new PerformanceObserver((function(e){for(var t=0,r=e.getEntries();t<r.length;t++){var l=r[t];if(l.identifier===i){try{a.removeChild(o)}catch(e){h("measureImagePaintTime",e)}return void n(l.renderTime)}}}));t.onCancelled=function(){return n(0,t.reason)},l.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}function b(e,t){return window.requestAnimationFrame?new Promise((function(r){var n,i=function(i){void 0===i&&(i=0),cancelAnimationFrame(n),r({start:e,time:i,monitor:"rAF",error:t.reason})};t.onCancelled=i,n=requestAnimationFrame((function(){i(Object(f.d)())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function I(e,t){return new Promise((function(r){var n,i,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(n),clearTimeout(i),r({start:e,time:o,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=function(){return o()},n=requestAnimationFrame((function(){i=window.setTimeout((function(){o(Object(f.d)())}),0)}))}))}function R(e,t,r){void 0===r&&(r=500);var n=t||S(12e3);if(!Object(f.a)("longtask"))return function(e,t){var r=Object(f.d)();if(!window.requestAnimationFrame)return Promise.resolve({start:r,time:0,monitor:"",error:"rAF unsupported"});var n=Object(f.d)(),i=0,o=n,a=0,l=0,s=n;return new Promise((function(n){var u,d=function(t){void 0===t&&(t=0),cancelAnimationFrame(u);var o={start:r,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:i,longestTaskDuration:l,longTasksDuration:a}};n(o)};e.onCancelled=d;var c=function(e){var r=e-o,n=e-s;s=e,n>=50&&(r=0,a+=n,i+=1,o=e,l=Math.max(l,n)),r>=t?d(o):u=window.requestAnimationFrame(c)};u=window.requestAnimationFrame(c)}))}(n,r);var i=performance.now(),o=0,a=i,l=0,s=0;return new Promise((function(t){var i,u=function(){clearTimeout(i),d&&d.disconnect();var r={start:e,time:a,monitor:"longtask-api",error:n.reason,measures:{longTasksDuration:l,longTasksCount:o,longestTaskDuration:s}};t(r)};n.onCancelled=u;var d=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){o+=1,l+=e.duration;var t=e.startTime+e.duration;a=Math.max(t,a),s=Math.max(s,e.duration)}))}));d.observe({entryTypes:["longtask"]});var c=function(){var e=performance.now()-a;if(e>=r)u();else{var t=r-e;i=window.setTimeout(c,t)}};i=window.setTimeout(c,r)}))}function O(e,t){return Object(f.a)("first-input")?new Promise((function(r){var n,i=function(t,i,o){n&&n.disconnect(),r({start:e,time:t,monitor:"first-input-api",error:o,measures:{fid:i}})};try{t.onCancelled=function(){return i(0,0,t.reason)};(n=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){return function(e){var t=e.processingStart,r=t-e.startTime;i(t,r)}(e)}))}))).observe({type:"first-input",buffered:!0})}catch(e){i(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function A(e,t){var r=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],n={passive:!0,capture:!0},i=Object(f.b)();return new Promise((function(o){var a=function(r,n,i){s(removeEventListener);var a={start:e,time:r,monitor:"first-interaction",error:t.reason,data:{eventName:n},measures:{delay:i}};o(a)};t.onCancelled=function(){return a(0,"",0)};var l=function(e){if(e.cancelable){var t=Object(f.b)(),r=e.timeStamp>1e12,n=(r?Object(f.b)():performance.now())-e.timeStamp;(n<0||n>t-i)&&(n=0),a(r?e.timeStamp-Object(f.c)():e.timeStamp,e.type,n)}},s=function(e){r.forEach((function(t){e(t,l,n)}))};s(addEventListener)}))}function P(e,t){return window.requestIdleCallback?new Promise((function(r){var n,i=function(t,i){window.cancelIdleCallback(n),r({start:e,time:t,monitor:"first-idle",error:i})};try{n=window.requestIdleCallback((function(e){return i(Object(f.d)(),e.didTimeout?"timeout":"")}),{timeout:t.timeout}),t.onCancelled=function(){return i(0,t.reason)}}catch(e){i(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var L=function(e){!function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];console.info.apply(console,Object(g.__spreadArrays)(["[RumShepherd]"+e],t))}("report "+e.metric+":"+e.time+"ms",e);var t=new CustomEvent(d,{detail:e});self.dispatchEvent(t)},M=function(e,t,r){if(r){var n="vr-"+r.id,i=document.documentElement;return function(e,t,r,n){var i=n?x(e,t,r,n):void 0;return i||(i=b(e,t)),i}(e,t,n,null!=i?i:void 0)}return b(e,t)};function k(e){var t=new w({appLoadMetricReportCallback:L,monitors:{"visually-ready":M,"functionally-ready":I,"stable-interactivity":R,"first-input":O,"first-interaction":A,"first-idle":P},components:e});window.addEventListener(s,(function(e){var r=e.detail;t.addSubComponents(r)})),window.addEventListener(u,(function(e){var r=e.detail;t.setSubComponentState(r)}))}var D=new(function(){function e(){}return e.prototype.setupDefault=function(e){if(e)return k(e),null},e}()),N=r(46);r.d(t,"rumShepherd",(function(){return n})),r.d(t,"gridRenderer",(function(){return N}))}])}));
//# sourceMappingURL=gridRenderer.min.js.map